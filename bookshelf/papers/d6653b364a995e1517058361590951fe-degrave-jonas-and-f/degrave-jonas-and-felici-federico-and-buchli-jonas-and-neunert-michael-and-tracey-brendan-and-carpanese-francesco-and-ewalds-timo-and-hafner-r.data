<!DOCTYPE html>
<html lang="en" class="grade-c">
<head>
    <title>Magnetic control of tokamak plasmas through deep reinforcement learning | Nature</title>
    
        
    
        
        <script id="save-data-connection-testing">
            function hasConnection() {
                return navigator.connection || navigator.mozConnection || navigator.webkitConnection || navigator.msConnection;
            }

            function createLink(src) {
                var preloadLink = document.createElement("link");
                preloadLink.rel = "preload";
                preloadLink.href = src;
                preloadLink.as = "font";
                preloadLink.type = "font/woff2";
                preloadLink.crossOrigin = "";
                document.head.insertBefore(preloadLink, document.head.firstChild);
            }

            var connectionDetail = {
                saveDataEnabled: false,
                slowConnection: false
            };

            var connection = hasConnection();
            if (connection) {
                connectionDetail.saveDataEnabled = connection.saveData;
                if (/\slow-2g|2g/.test(connection.effectiveType)) {
                    connectionDetail.slowConnection = true;
                }
            }

            if (!(connectionDetail.saveDataEnabled || connectionDetail.slowConnection)) {
                createLink("/static/fonts/HardingText-Regular-Web.woff2");
            } else {
                document.documentElement.classList.add('save-data');
            }
        </script>
    


<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="applicable-device" content="pc,mobile">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=5,user-scalable=yes">

<script data-test="dataLayer">
    window.dataLayer = [{"content":{"category":{"contentType":"article","legacy":{"webtrendsPrimaryArticleType":"research","webtrendsSubjectTerms":"computer-science;magnetically-confined-plasmas;nuclear-fusion-and-fission","webtrendsContentCategory":null,"webtrendsContentCollection":null,"webtrendsContentGroup":"Nature","webtrendsContentGroupType":null,"webtrendsContentSubGroup":"Article"}},"article":{"doi":"10.1038/s41586-021-04301-9"},"attributes":{"cms":null,"deliveryPlatform":"oscar","copyright":{"open":true,"legacy":{"webtrendsLicenceType":"http://creativecommons.org/licenses/by/4.0/"}}},"contentInfo":{"authors":["Jonas Degrave","Federico Felici","Jonas Buchli","Michael Neunert","Brendan Tracey","Francesco Carpanese","Timo Ewalds","Roland Hafner","Abbas Abdolmaleki","Diego de las Casas","Craig Donner","Leslie Fritz","Cristian Galperti","Andrea Huber","James Keeling","Maria Tsimpoukelli","Jackie Kay","Antoine Merle","Jean-Marc Moret","Seb Noury","Federico Pesamosca","David Pfau","Olivier Sauter","Cristian Sommariva","Stefano Coda","Basil Duval","Ambrogio Fasoli","Pushmeet Kohli","Koray Kavukcuoglu","Demis Hassabis","Martin Riedmiller"],"publishedAt":1644969600,"publishedAtString":"2022-02-16","title":"Magnetic control of tokamak plasmas through deep reinforcement learning","legacy":null,"publishedAtTime":null,"documentType":"aplusplus"},"journal":{"pcode":"nature","title":"nature","volume":"602","issue":"7897"},"authorization":{"status":true},"features":[{"name":"furtherReadingSection","present":false}],"collection":null},"page":{"category":{"pageType":"article"},"attributes":{"template":"mosaic","featureFlags":[{"name":"ab_test_highlight_supp_info","active":false},{"name":"nature-oa-paywall","active":true},{"name":"nature-onwards-journey","active":false}],"testGroup":null},"search":null},"privacy":{},"version":"1.0.0","product":null,"session":null,"user":null,"backHalfContent":true,"country":"IT","hasBody":true,"uneditedManuscript":false,"twitterId":["o3xnx","o43y9","o3ef7"]}];
    window.dataLayer.push({
        ga4MeasurementId: 'G-ERRNTNZ807',
        ga360TrackingId: 'UA-71668177-1',
        twitterId: ['3xnx', 'o43y9', 'o3ef7'],
        ga4ServerUrl: 'https://collect.nature.com',
        imprint: 'nature'
    });
</script>


    <script>
        window.dataLayer.push({
            cmpAndNewGtmFeatureFlag: true
        });
    </script>



    <script>
        (function(w, d) {
            w.config = w.config || {};
            w.config.mustardcut = false;

            
            if (w.matchMedia && w.matchMedia('only screen and (-webkit-min-device-pixel-ratio:0) and (min-color-index:0), (-ms-high-contrast: none), only all and (min--moz-device-pixel-ratio:0) and (min-resolution: 3e1dpcm)').matches) {
                w.config.mustardcut = true;
                d.classList.add('js');
                d.classList.remove('grade-c');
            }
        })(window, document.documentElement);
    </script>


 



    
         
            
    <style>@media only screen and (-webkit-min-device-pixel-ratio: 0) and (min-color-index: 0), (-ms-high-contrast: none), only all and (min--moz-device-pixel-ratio: 0) and (min-resolution: 3 e1dpcm) { html{text-size-adjust:100%;box-sizing:border-box;font-family:sans-serif;font-size:100%;height:100%;line-height:1.15;overflow-y:scroll}body{background:#eee;color:#222;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;line-height:1.76;min-height:100%}article,aside,header,main,nav,section{display:block}h1{font-size:2em}a,sup{vertical-align:baseline}a{background-color:transparent;color:#069;overflow-wrap:break-word;text-decoration:underline;word-break:break-word}b{font-weight:bolder}sup{font-size:75%;line-height:0;position:relative;top:-.5em}img{border:0;height:auto;max-width:100%;vertical-align:middle}svg:not(:root){overflow:hidden}button,input,select{font-family:sans-serif;font-size:100%;line-height:1.15}select{margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=submit],button{-webkit-appearance:button}[hidden]{display:none}button{border-radius:0;cursor:pointer;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1{-webkit-font-smoothing:antialiased;font-family:Harding,Palatino,serif;font-size:2rem;font-weight:700;letter-spacing:-.03906rem;line-height:2.25rem}.c-card--major .c-card__title,.u-h2,h2{font-family:Harding,Palatino,serif;font-size:1.5rem;line-height:1.6rem}.c-card--major .c-card__title,.u-h2{letter-spacing:-.01172rem;margin-bottom:8px}h2,h3{letter-spacing:-.01172rem}.c-card--major .c-card__title,.c-card__title,.c-reading-companion__figure-title,.u-h2,.u-h3,.u-h4,h2,h3,h4,h5,h6{-webkit-font-smoothing:antialiased;font-weight:700}.c-card__title,.c-reading-companion__figure-title,.u-h3,.u-h4,h3,h4,h5,h6{line-height:1.4rem}.c-card__title,h3{font-family:Harding,Palatino,serif;font-size:1.25rem}.c-reading-companion__figure-title,.u-h3,.u-h4{letter-spacing:-.01172rem}.u-h3{font-family:Harding,Palatino,serif;font-size:1.25rem;margin-bottom:8px}.c-reading-companion__figure-title,.u-h4{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-size:1.125rem}.u-h4{margin-bottom:8px}body,button,div,form,h1,h2,h3,input{margin:0;padding:0}p{padding:0}nav ol,nav ul{list-style:none none}body{font-size:1.125rem}p{margin:0 0 28px}ol,ul{margin-bottom:28px;margin-top:0}p:empty{display:none}.sans-serif{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}.article-page{background:#fff}.c-article-header{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;margin-bottom:40px}.c-article-identifiers{color:#6f6f6f;display:flex;flex-wrap:wrap;font-size:1rem;line-height:1.3;list-style:none;margin:0 0 8px;padding:0}.c-article-identifiers__item{border-right:1px solid #6f6f6f;list-style:none;margin-right:8px;padding-right:8px}.c-article-identifiers__item:last-child{border-right:0;margin-right:0;padding-right:0}.c-article-identifiers__open{color:#b74616}.c-article-title{font-size:1.5rem;line-height:1.25;margin-bottom:16px}@media only screen and (min-width:768px){.c-article-title{font-size:1.875rem;line-height:1.2}}.c-article-author-list{display:inline;font-size:1rem;list-style:none;margin:0 8px 0 0;padding:0;width:100%}.c-article-author-list__item{margin-left:0}.c-article-author-list li,.c-article-author-list__item{display:inline;padding-right:0}.c-article-author-list__item svg{margin-left:4px}.c-article-info-details{font-size:1rem;margin-bottom:8px;margin-top:16px}.c-article-info-details__cite-as{border-left:1px solid #6f6f6f;margin-left:8px;padding-left:8px}.c-article-metrics-bar{display:flex;flex-wrap:wrap;font-size:1rem;line-height:1.3}.c-article-metrics-bar__wrapper{margin:0 0 16px}.c-article-metrics-bar__item{-webkit-box-align:baseline;align-items:baseline;border-right:1px solid #6f6f6f;margin-right:8px}.c-article-metrics-bar__item:last-child{border-right:0}.c-article-metrics-bar__count{font-weight:700;margin:0}.c-article-metrics-bar__label{color:#626262;font-style:normal;font-weight:400;margin:0 10px 0 5px}.c-article-metrics-bar__details{margin:0}.c-article-main-column{font-family:Harding,Palatino,serif;margin-right:8.6%;width:60.2%}@media only screen and (max-width:1023px){.c-article-main-column{margin-right:0;width:100%}}.c-article-associated-content__container .c-article-associated-content__title,.c-article-section__title{border-bottom:2px solid #d5d5d5;font-size:1.25rem;line-height:1.3;padding-bottom:8px}@media only screen and (min-width:768px){.c-article-associated-content__container .c-article-associated-content__title,.c-article-section__title{font-size:1.5rem;line-height:1.24}}.c-article-section{clear:both}.c-article-section__content{margin-bottom:40px;padding-top:8px}@media only screen and (max-width:1023px){.c-article-section__content{padding-left:0}}.c-reading-companion__figure-full-link svg{margin-left:4px}.c-article-authors-search{margin-bottom:24px;margin-top:0}.c-article-authors-search__item,.c-article-authors-search__title{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}.c-article-authors-search__title{color:#626262;font-size:1.05rem;font-weight:700;margin:0;padding:0}.c-article-authors-search__item{font-size:1rem}.c-article-authors-search__text{margin:0}.c-article-share-box__no-sharelink-info{font-size:.813rem;font-weight:700;margin-bottom:24px;padding-top:4px}.c-article-share-box__only-read-input{border:1px solid #d5d5d5;display:inline-block;font-size:.875rem;font-weight:700;margin-bottom:8px;padding:8px 10px}.c-article-share-box__button--link-like{background-color:transparent;border:0;color:#069;cursor:pointer;font-size:.875rem;margin-bottom:8px;margin-left:10px}.c-article-editorial-summary__container{border-bottom:1px solid #d5d5d5}.c-article-editorial-summary__container .c-article-editorial-summary__article-title{font-size:.875rem;line-height:1.4}.c-article-editorial-summary__container .c-article-editorial-summary__content{font-size:.875rem}.c-article-editorial-summary__container .c-article-editorial-summary__content p:last-child{margin-bottom:0}.c-article-editorial-summary__container .c-article-editorial-summary__content--less{max-height:9.5rem;overflow:hidden}.c-article-editorial-summary__container .c-article-editorial-summary__button{background-color:#fff;border:0;color:#069;font-size:.875rem;margin-bottom:16px;text-decoration:none}.c-article-editorial-summary__container .c-article-editorial-summary__button.active,.c-article-editorial-summary__container .c-article-editorial-summary__button.hover,.c-article-editorial-summary__container .c-article-editorial-summary__button:active,.c-article-editorial-summary__container .c-article-editorial-summary__button:hover{text-decoration:underline;text-decoration-skip-ink:auto}.c-article-editorial-summary__container .c-article-editorial-summary__button:focus{outline:3px solid #fece3e;will-change:transform}.c-article-associated-content__container .c-article-associated-content__collection-label{font-size:.875rem;line-height:1.4}.c-article-associated-content__container .c-article-associated-content__collection-title,.c-nature-box{line-height:1.3}@media only screen and (min-width:1024px){.c-pdf-button__container{display:none}}.c-context-bar{box-shadow:0 0 10px 0 rgba(51,51,51,.2);position:relative;width:100%}.c-context-bar__title,.c-header__menu--global .c-header__item svg{display:none}.c-article-extras{float:left;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;width:31.2%}@media only screen and (max-width:1023px){.c-article-extras{display:none}}.c-reading-companion{clear:both}.c-reading-companion__sticky{max-width:389px}.c-reading-companion__scroll-pane{margin:0;min-height:200px;overflow:hidden auto}.c-reading-companion__tabs{-webkit-box-orient:horizontal;-webkit-box-direction:normal;display:flex;flex-flow:row nowrap;font-size:1rem;list-style:none;margin:0 0 8px;padding:0}.c-reading-companion__tabs>li{-webkit-box-flex:1;flex-grow:1}.c-reading-companion__tab{background-color:#eee;border:1px solid #d5d5d5;border-image:initial;border-left-width:0;color:#069;font-size:1rem;padding:8px 8px 8px 15px;text-align:left;width:100%}.c-reading-companion__tabs li:first-child .c-reading-companion__tab{border-left-width:1px}.c-reading-companion__tab--active{background-color:#fff;border-bottom:1px solid #fff;color:#222;font-weight:700}.c-reading-companion__figures-list,.c-reading-companion__references-list,.c-reading-companion__sections-list{list-style:none;padding:0}.c-reading-companion__references-list--numeric{list-style:decimal inside}.c-reading-companion__sections-list{margin:0 0 8px;min-height:50px}.c-reading-companion__section-item{font-size:1rem;padding:0}.c-reading-companion__section-item a{display:block;line-height:1em;overflow:hidden;padding:8px 0 8px 16px;text-overflow:ellipsis;white-space:nowrap}.c-reading-companion__figure-item{border-top:1px solid #d5d5d5;font-size:1rem;padding:16px 8px 16px 0}.c-reading-companion__figure-item:first-child{border-top:none;padding-top:8px}.c-reading-companion__reference-item{border-top:1px solid #d5d5d5;font-size:1rem;padding:8px 8px 8px 16px}.c-reading-companion__reference-item:first-child{border-top:none}.c-reading-companion__reference-item a{word-break:break-word}.c-reading-companion__reference-citation{display:inline}.c-reading-companion__reference-links{font-size:.813rem;font-weight:700;list-style:none;margin:8px 0 0;padding:0;text-align:right}.c-reading-companion__reference-links>a{display:inline-block;padding-left:8px}.c-reading-companion__reference-links>a:first-child{display:inline-block;padding-left:0}.c-reading-companion__figure-title{display:block;margin:0 0 8px}.c-reading-companion__figure-links{-webkit-box-pack:justify;display:flex;justify-content:space-between;margin:8px 0 0}.c-reading-companion__figure-links>a{display:inline-block}.c-reading-companion__panel{border-top:none;display:none;margin-top:0;padding-top:0}.c-reading-companion__panel--active{display:block}.c-pdf-download{display:flex;margin-bottom:24px;max-height:48px}@media only screen and (min-width:540px){.c-pdf-download{max-height:none}}@media only screen and (min-width:1024px){.c-pdf-download{max-height:48px}}.c-pdf-download__link{-webkit-box-pack:justify;-webkit-box-flex:1;background:#069;border:1px solid #069;border-radius:2px;color:#fff;display:flex;flex:1 1 0%;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-size:1rem;justify-content:space-between;line-height:1.3;padding:13px 24px;text-decoration:none}.c-article-metrics__heading a,.c-article-metrics__posts .c-card__title a{color:inherit}.c-article-metrics__posts .c-card__title{font-size:1.05rem}.c-article-metrics__posts .c-card__title+span{color:#6f6f6f;font-size:1rem}p{overflow-wrap:break-word;word-break:break-word}.c-ad{text-align:center}@media only screen and (min-width:320px){.c-ad{padding:8px}}.c-ad--728x90{background-color:#ccc;display:none}.c-ad--728x90 .c-ad__inner{min-height:calc(1.5em + 94px)}@media only screen and (min-width:768px){.js .c-ad--728x90{display:none}}.c-ad__label{color:#333;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-size:.875rem;font-weight:400;line-height:1.5;margin-bottom:4px}.c-author-list{color:#6f6f6f;font-family:inherit;font-size:1rem;line-height:inherit;list-style:none;margin:0;padding:0}.c-author-list>li,.c-breadcrumbs>li,.c-footer__list--inline>li,.js .c-author-list,.u-list-comma-separated>li,.u-list-inline>li{display:inline}.c-author-list>li:not(:first-child):not(:last-child):before{content:", "}.c-author-list>li:not(:only-child):last-child:before{content:" & "}.c-author-list--compact{font-size:.875rem;line-height:1.4}.c-author-list--truncated>li:not(:only-child):last-child:before{content:" ... "}.js .c-author-list__hide{display:none;visibility:hidden}.c-skip-link{background:#069;bottom:auto;color:#fff;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-size:.875rem;padding:8px;position:absolute;text-align:center;transform:translateY(-100%);z-index:9999}@media (prefers-reduced-motion:reduce){.c-skip-link{transition:top .3s ease-in-out 0s}}@media print{.c-skip-link{display:none}}.c-skip-link:link{color:#fff}.c-status-message{-webkit-box-align:center;align-items:center;box-sizing:border-box;display:flex;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-size:1rem;position:relative;width:100%}.c-card__summary>p:last-child,.c-status-message :last-child{margin-bottom:0}.c-status-message--boxed{background-color:#fff;border:1px solid #eee;border-radius:2px;line-height:1.4;padding:16px}.c-status-message__heading{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-size:1rem;font-weight:700}.c-status-message__icon{fill:currentcolor;-webkit-box-flex:0;display:inline-block;flex:0 0 auto;height:1.5em;margin-right:8px;transform:translate(0);vertical-align:text-top;width:1.5em}.c-status-message__icon--top{align-self:flex-start}.c-status-message--info .c-status-message__icon{color:#003f8d}.c-status-message--boxed.c-status-message--info{border-bottom:4px solid #003f8d}.c-status-message--error .c-status-message__icon{color:#c40606}.c-status-message--boxed.c-status-message--error{border-bottom:4px solid #c40606}.c-status-message--success .c-status-message__icon{color:#00b8b0}.c-status-message--boxed.c-status-message--success{border-bottom:4px solid #00b8b0}.c-status-message--warning .c-status-message__icon{color:#edbc53}.c-status-message--boxed.c-status-message--warning{border-bottom:4px solid #edbc53}.c-breadcrumbs{color:#000;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-size:1rem;list-style:none;margin:0;padding:0}.c-breadcrumbs__link{color:#666}.c-breadcrumbs__chevron{fill:#888;margin:4px 4px 0}.c-card__body{-webkit-box-flex:1;flex:1 1 auto;padding:16px}.c-card__title{letter-spacing:-.01875rem;margin-bottom:8px;margin-top:0}.c-card--flush .c-card__body{padding:0}.c-card--dark .c-card__title{color:#fff}.c-header{background-color:#fff;border-bottom:5px solid #000;font-size:1rem;line-height:1.4;margin-bottom:16px}.c-header__row{padding:8px 0;position:relative}.c-header__row:not(:last-child){border-bottom:1px solid #eee}.c-header__row--flush{padding:0}.c-header__split{-webkit-box-align:center;-webkit-box-pack:justify;align-items:center;display:flex;justify-content:space-between}.c-header__logo-container{-webkit-box-flex:1;flex:1 1 0px;line-height:0;margin-right:24px}.c-header__logo{transform:translateZ(0)}.c-header__logo img{max-height:32px}.c-header__container{margin:0 auto;max-width:1280px;padding:0 16px}.c-header__menu{-webkit-box-align:center;-webkit-box-flex:0;align-items:center;display:flex;flex:0 1 auto;flex-wrap:wrap;font-weight:700;line-height:1.4;list-style:none;margin:0 -8px;padding:0}.c-header__menu--global{-webkit-box-pack:end;font-weight:400;justify-content:flex-end}@media only screen and (min-width:540px){.c-header__menu--global .c-header__item svg{display:block}}.c-header__menu--journal{font-size:.875rem}@media only screen and (min-width:540px){.c-header__menu--journal{flex-wrap:nowrap;font-size:1rem}}@media only screen and (max-width:1023px){.c-header__menu--tools{display:none}}.c-header__item{display:flex}@media only screen and (min-width:540px){.c-header__item:not(:first-child){margin-left:8px}}.c-header__item--pipe{border-left:2px solid #eee;padding-left:8px}@media only screen and (max-width:767px){.c-header__item--nature-research{display:none}}.c-header__row--flush .c-header__item{padding-bottom:8px;padding-top:8px}.c-header__link{-webkit-box-align:center;align-items:center;color:inherit;display:flex;padding:8px;white-space:nowrap}.c-header-expander a{color:inherit}.c-header__link>svg{margin-left:2px;transition-duration:.2s}@media only screen and (min-width:540px){.c-header__link>svg{margin-left:4px}}.c-header__show-text{display:none}@media only screen and (min-width:540px){.c-header__show-text{display:inline}.c-header__item--dropdown-menu{position:relative}.c-header__menu--journal .c-header__item--dropdown-menu:last-child .c-header-expander.has-tethered{left:auto;right:0}}@media only screen and (min-width:768px){.c-header__menu--journal .c-header__item--dropdown-menu:last-child .c-header-expander.has-tethered{left:0;right:auto}}.c-header-expander{background-color:#000;border-bottom:1px solid #2f2f2f;color:#eee;font-size:.875rem;line-height:1.2;padding:16px 0}.c-header-expander button{background-color:transparent;border:1px solid #fff;color:#fff}.c-header-expander__container{margin:0 auto;max-width:1280px;padding:0 16px}.c-header-expander__keyline{border-bottom:1px solid #555;margin-bottom:0;padding-bottom:16px}.c-header-expander__heading{display:inline-block;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-size:1.25rem;font-weight:400;line-height:1.4}.c-header-expander__list{display:flex;flex-wrap:wrap;margin:0;padding:0}.c-header-expander__item{margin:0 16px 8px 0}.c-header-expander__link{-webkit-box-align:center;align-items:center;color:inherit;display:flex;white-space:nowrap}.c-header-expander__link>svg{margin-left:8px}.c-header-expander.has-tethered{border-bottom:0;border-radius:0 0 2px 2px;left:0;position:absolute;top:100%;transform:translateY(5px);width:100%;z-index:1}@media only screen and (min-width:540px){.c-header-expander.has-tethered{transform:translateY(8px);width:auto}}@media only screen and (min-width:768px){.c-header-expander.has-tethered{min-width:225px}}.c-header-expander.has-tethered .c-header-expander__list{display:block}.c-header-expander.has-tethered .c-header-expander__item{margin:0;padding:8px 0}.c-header-expander.has-tethered .c-header-expander__item--keyline{border-top:1px solid #fff;margin-top:8px;padding-top:16px}.c-header-expander.has-tethered .c-header-expander__item--keyline-first-item-only~.c-header-expander__item--keyline-first-item-only{border-top:none;padding-top:0}.c-header-expander--tray.has-tethered{padding:32px 0 24px;transform:none;width:100%}.c-search{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-size:1.25rem;font-weight:400;line-height:1.3}.c-search--max-width{max-width:720px}.c-search__field{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-box-align:center;align-items:center;display:flex;flex-flow:row wrap}.c-search__input-container{-webkit-box-flex:1;flex:1 0 100%;margin-bottom:8px}@media only screen and (min-width:768px){.c-search__input-container--md{-webkit-box-flex:999;flex:999 1 auto;margin-bottom:0;margin-right:16px}}.c-search__select-container{-webkit-box-flex:1;flex:1 1 auto;margin-bottom:8px}@media only screen and (min-width:540px){.c-search__select-container{-webkit-box-flex:999;flex:999 1 auto;margin-bottom:0;margin-right:16px}}@media only screen and (min-width:768px){.c-search__select-container{-webkit-box-flex:1;flex:1 0 auto}}.c-search__button-container{-webkit-box-flex:1;flex:1 0 100%}@media only screen and (min-width:540px){.c-search__button-container{-webkit-box-flex:1;flex:1 0 auto}}.c-search__input,.c-search__select{background-color:#fff;border:1px solid;border-radius:3px;box-sizing:border-box;font-size:1rem;padding:.6em 1em;width:100%}.c-search__select{-webkit-appearance:none;background-image:url("data:image/svg+xml,%3Csvg height='16' viewBox='0 0 16 16' width='16' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='m5.58578644 3-3.29289322-3.29289322c-.39052429-.39052429-.39052429-1.02368927 0-1.41421356s1.02368927-.39052429 1.41421356 0l4 4c.39052429.39052429.39052429 1.02368927 0 1.41421356l-4 4c-.39052429.39052429-1.02368927.39052429-1.41421356 0s-.39052429-1.02368927 0-1.41421356z' fill='%23333' fill-rule='evenodd' transform='matrix(0 1 -1 0 11 3)'/%3E%3C/svg%3E");background-position:right .7em top 50%;background-repeat:no-repeat;background-size:1em;box-shadow:0 1px 0 1px rgba(0,0,0,.04);display:block;margin:0;max-width:100%;min-width:150px}.u-button{-webkit-box-align:center;-webkit-box-pack:center;align-items:center;background-color:transparent;background-image:none;border:1px solid #069;border-radius:2px;color:#069;cursor:pointer;display:inline-flex;font-family:sans-serif;font-size:1rem;justify-content:center;line-height:1.3;margin:0;padding:8px;position:relative;text-decoration:none;transition:all .25s ease 0s,color .25s ease 0s,border-color .25s ease 0s;width:auto}.u-button--primary{background-color:#069;background-image:none;border:1px solid #069;color:#fff}.u-button--full-width{display:flex;width:100%}.u-display-none{display:none}.js .u-js-hide,.u-hide{display:none;visibility:hidden}.u-visually-hidden{clip:rect(0,0,0,0);border:0;height:1px;margin:-100%;overflow:hidden;padding:0;position:absolute!important;width:1px}@media print{.u-hide-print{display:none}}@media only screen and (min-width:768px){.u-show-at-md{display:block;visibility:visible}}@media only screen and (min-width:1024px){.u-hide-at-lg{display:none;visibility:hidden}}.u-clearfix:after,.u-clearfix:before{content:"";display:table}.u-clearfix:after{clear:both}.u-float-left{float:left}.u-icon{fill:currentcolor;display:inline-block;height:1em;transform:translate(0);vertical-align:text-top;width:1em}.u-full-height{height:100%}.u-list-reset{list-style:none;margin:0;padding:0}.u-container{margin:0 auto;max-width:1280px;padding:0 16px}.u-display-inline-block{display:inline-block}.u-ma-0{margin:0}.u-mt-32{margin-top:32px}.u-mr-2{margin-right:2px}.u-mr-24{margin-right:24px}.u-mb-8{margin-bottom:8px}.u-mb-16{margin-bottom:16px}.u-mb-24{margin-bottom:24px}.u-mb-32{margin-bottom:32px}html *,html :after,html :before{box-sizing:inherit}.c-article-section__title,.c-article-title{font-weight:700}.c-card__title{line-height:1.4em}.c-header__link{text-decoration:inherit}.grade-c-hide{display:block}.u-lazy-ad-wrapper{background-color:#ccc;display:none;min-height:137px}@media only screen and (min-width:768px){.u-lazy-ad-wrapper{display:block}} }</style>

            
            
            
                <link data-inline-css-source="critical-css" rel="stylesheet" href="/static/css/article-nature-branded-c3e312d5ab.css" media="print" onload="this.media='only screen and (-webkit-min-device-pixel-ratio:0) and (min-color-index:0), (-ms-high-contrast: none), only all and (min--moz-device-pixel-ratio:0) and (min-resolution: 3e1dpcm)';this.onload=null">
                <noscript>
                    <link rel="stylesheet" type="text/css" href="/static/css/article-nature-branded-c3e312d5ab.css" media="only screen and (-webkit-min-device-pixel-ratio:0) and (min-color-index:0), (-ms-high-contrast: none), only all and (min--moz-device-pixel-ratio:0) and (min-resolution: 3e1dpcm)">
                </noscript>
            
            <link rel="stylesheet" type="text/css" href="/static/css/article-print-5caae571ed.css" media="print">
        
    




<link rel="apple-touch-icon" sizes="180x180" href=/static/images/favicons/nature/apple-touch-icon.png>
<link rel="icon" type="image/png" sizes="32x32" href=/static/images/favicons/nature/favicon-32x32.png>
<link rel="icon" type="image/png" sizes="16x16" href=/static/images/favicons/nature/favicon-16x16.png>
<link rel="manifest" href=/static/manifest.json crossorigin="use-credentials">
<link rel="mask-icon" href=/static/images/favicons/nature/safari-pinned-tab.svg color="#000000">
<link rel="shortcut icon" href=/static/images/favicons/nature/favicon.ico>
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-config" content=/static/browserconfig.xml>
<meta name="theme-color" content="#000000">
<meta name="application-name" content="Nature">


<script>
    (function () {
        if ( typeof window.CustomEvent === "function" ) return false;
        function CustomEvent ( event, params ) {
            params = params || { bubbles: false, cancelable: false, detail: null };
            var evt = document.createEvent( 'CustomEvent' );
            evt.initCustomEvent( event, params.bubbles, params.cancelable, params.detail );
            return evt;
        }

        CustomEvent.prototype = window.Event.prototype;

        window.CustomEvent = CustomEvent;
    })();
</script>



<!-- Google Tag Manager -->
<script data-test="gtm-head">
    window.initGTM = function() {
        if (window.config.mustardcut) {
            (function (w, d, s, l, i) {
                w[l] = w[l] || [];
                w[l].push({'gtm.start': new Date().getTime(), event: 'gtm.js'});
                var f = d.getElementsByTagName(s)[0],
                        j = d.createElement(s),
                        dl = l != 'dataLayer' ? '&l=' + l : '';
                j.async = true;
                
                    j.src = 'https://collect.nature.com/gtm.js?id=' + i + dl;
                
                f.parentNode.insertBefore(j, f);
            })(window, document, 'script', 'dataLayer', 'GTM-MRVXSHQ');
        }
    }
</script>
<!-- End Google Tag Manager -->

    <script>
    (function(w,d,t) {
        function cc() {
            var h = w.location.hostname;
            if (h.indexOf('preview-www.nature.com') > -1) return;

            var e = d.createElement(t),
                    s = d.getElementsByTagName(t)[0];

            if (h.indexOf('nature.com') > -1) {
                e.src = 'https://push-content.springernature.io/pcf_sb_5_1617714720898560639/production_live/consent-bundle-8-8.js';
                e.setAttribute('onload', "initGTM(window,document,'script','dataLayer','GTM-MRVXSHQ')");
            } else {
                e.src = '/static/js/cookie-consent-es5-bundle-444fb65518.js';
                e.setAttribute('data-consent', h);
            }
            s.insertAdjacentElement('afterend', e);
        }

        cc();
    })(window,document,'script');
</script>


    <script id="js-position0">
        (function(w, d) {
            w.idpVerifyPrefix = 'https://verify.nature.com';
            w.ra21Host = 'https://wayf.springernature.com';
            var moduleSupport = (function() {
                return 'noModule' in d.createElement('script');
            })();

            var polyfillsUrl = function() {
                var features = {
                    'IntersectionObserver': window.IntersectionObserver,
                    'Promise': window.Promise,
                    'URLSearchParams': window.URLSearchParams,
                    'Symbol.iterator': window.Symbol && Symbol.iterator,
                    'Array.from': Array.from,
                    'Array.prototype.includes': Array.prototype.includes,
                    'Array.prototype.find': Array.prototype.find,
                    'Array.prototype.forEach': Array.prototype.forEach,
                    'NodeList.prototype.forEach': NodeList.prototype.forEach,
                    'Element.prototype.closest': Element.prototype.closest,
                    'Element.prototype.prepend': Element.prototype.prepend,
                    'Element.prototype.remove': Element.prototype.remove,
                    'Object.assign': Object.assign
                };
                var req = [];
                for (var feature in features) {
                    if (Object.prototype.hasOwnProperty.call(features, feature) && !features[feature]) {
                        req.push(feature);
                    }
                }
                if (req.length) {
                    return 'https://polyfill.io/v3/polyfill.min.js?features=' + req.join('%2C') + '&flags=always';
                }
                return null;
            };

            if (w.config.mustardcut === true) {
                w.loader = {
                    index: 0,
                    registered: [],
                    scripts: [
                        {src: polyfillsUrl(), test: 'polyfills-js', noinit: true},
                        
                            {src: '/static/js/global-article-es6-bundle-72b56b511b.js', test: 'global-article-js', module: true},
                            {src: '/static/js/global-article-es5-bundle-4afb8cefba.js', test: 'global-article-js', nomodule: true},
                            {src: '/static/js/shared-es6-bundle-52043d4c0f.js', test: 'shared-js', module: true},
                            {src: '/static/js/shared-es5-bundle-19fd0d3511.js', test: 'shared-js', nomodule: true},
                            {src: '/static/js/header-150-es6-bundle-5bb959eaa1.js', test: 'header-150-js', module: true},
                            {src: '/static/js/header-150-es5-bundle-88bc691ce2.js', test: 'header-150-js', nomodule: true}
                        
                    ].filter(function (s) {
                        if (s.src === null) return false;
                        if (moduleSupport && s.nomodule) return false;
                        return !(!moduleSupport && s.module);
                    }),

                    register: function (value) {
                        this.registered.push(value);
                    },

                    ready: function () {
                        if (this.registered.length === this.scripts.length) {
                            this.registered.forEach(function (fn) {
                                if (typeof fn === 'function') {
                                    setTimeout(fn, 0); 
                                }
                            });
                            this.ready = function () {};
                        }
                    },

                    insert: function (s) {
                        var t = d.getElementById('js-position' + this.index);
                        if (t && t.insertAdjacentElement) {
                            t.insertAdjacentElement('afterend', s);
                        } else {
                            d.head.appendChild(s);
                        }
                        ++this.index;
                    },

                    createScript: function (script, beforeLoad) {
                        var s = d.createElement('script');
                        s.id = 'js-position' + (this.index + 1);
                        s.setAttribute('data-test', script.test);
                        if (beforeLoad) {
                            s.defer = 'defer';
                            s.onload = function () {
                                if (script.noinit) {
                                    loader.register(true);
                                }
                                if (d.readyState === 'interactive' || d.readyState === 'complete') {
                                    loader.ready();
                                }
                            };
                        } else {
                            s.async = 'async';
                        }
                        s.src = script.src;
                        return s;
                    },

                    init: function () {
                        this.scripts.forEach(function (s) {
                            loader.insert(loader.createScript(s, true));
                        });

                        d.addEventListener('DOMContentLoaded', function () {
                            loader.ready();
                            
                                var conditionalScripts = [
                                    {match: 'div[data-pan-container]', src: '/static/js/pan-zoom-es6-bundle-885b4d4cd7.js', test: 'pan-zoom-js',  module: true },
                                    {match: 'div[data-pan-container]', src: '/static/js/pan-zoom-es5-bundle-d50736306e.js', test: 'pan-zoom-js',  nomodule: true },
                                    {match: 'math,span.mathjax-tex', src: '/static/js/math-21da043fb2.js', test: 'math-js'}
                                ];
                            

                            if (conditionalScripts) {
                                conditionalScripts.filter(function (script) {
                                    return !!document.querySelector(script.match) && !((moduleSupport && script.nomodule) || (!moduleSupport && script.module));
                                }).forEach(function (script) {
                                    loader.insert(loader.createScript(script));
                                });
                            }
                        }, false);
                    }
                };
                loader.init();
            }
        })(window, document);
    </script>




<meta name="robots" content="noarchive">
<meta name="access" content="Yes">


<link rel="search" href="http://www.nature.com/search">
<link rel="search" href="http://www.nature.com/opensearch/opensearch.xml" type="application/opensearchdescription+xml" title="nature.com">
<link rel="search" href="http://www.nature.com/opensearch/request" type="application/sru+xml" title="nature.com">



    
    <script type="application/ld+json">{"mainEntity":{"headline":"Magnetic control of tokamak plasmas through deep reinforcement learning","description":"Nuclear fusion using magnetic confinement, in particular in the tokamak configuration, is a promising path towards sustainable energy. A core challenge is to shape and maintain a high-temperature plasma within the tokamak vessel. This requires high-dimensional, high-frequency, closed-loop control using magnetic actuator coils, further complicated by the diverse requirements across a wide range of plasma configurations. In this work, we introduce a previously undescribed architecture for tokamak magnetic controller design that autonomously learns to command the full set of control coils. This architecture meets control objectives specified at a high level, at the same time satisfying physical and operational constraints. This approach has unprecedented flexibility and generality in problem specification and yields a notable reduction in design effort to produce new plasma configurations. We successfully produce and control a diverse set of plasma configurations on the Tokamak à Configuration Variable1,2, including elongated, conventional shapes, as well as advanced configurations, such as negative triangularity and ‘snowflake’ configurations. Our approach achieves accurate tracking of the location, current and shape for these configurations. We also demonstrate sustained ‘droplets’ on TCV, in which two separate plasmas are maintained simultaneously within the vessel. This represents a notable advance for tokamak feedback control, showing the potential of reinforcement learning to accelerate research in the fusion domain, and is one of the most challenging real-world systems to which reinforcement learning has been applied. A newly designed control architecture uses deep reinforcement learning to learn to command the coils of a tokamak, and successfully stabilizes a wide variety of fusion plasma configurations.","datePublished":"2022-02-16","dateModified":"2022-02-16","pageStart":"414","pageEnd":"419","license":"http://creativecommons.org/licenses/by/4.0/","sameAs":"https://doi.org/10.1038/s41586-021-04301-9","keywords":"Computer science,Magnetically confined plasmas,Nuclear fusion and fission,Science,Humanities and Social Sciences,multidisciplinary","image":"https://static-content.springer.com/image/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig1_HTML.png","isPartOf":{"name":"Nature","issn":["1476-4687","0028-0836"],"volumeNumber":"602","@type":["Periodical","PublicationVolume"]},"publisher":{"name":"Nature Publishing Group UK","logo":{"url":"https://www.springernature.com/app-sn/public/images/logo-springernature.png","@type":"ImageObject"},"@type":"Organization"},"author":[{"name":"Degrave, Jonas","url":"http://orcid.org/0000-0002-2738-6500","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Felici, Federico","url":"http://orcid.org/0000-0001-7585-376X","affiliation":[{"name":"Swiss Plasma Center - EPFL","address":{"name":"Swiss Plasma Center - EPFL, Lausanne, Switzerland","@type":"PostalAddress"},"@type":"Organization"}],"email":"federico.felici@epfl.ch","@type":"Person"},{"name":"Buchli, Jonas","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"email":"buchli@deepmind.com","@type":"Person"},{"name":"Neunert, Michael","url":"http://orcid.org/0000-0003-2080-8376","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Tracey, Brendan","url":"http://orcid.org/0000-0001-5724-5912","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"email":"btracey@deepmind.com","@type":"Person"},{"name":"Carpanese, Francesco","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"},{"name":"Swiss Plasma Center - EPFL","address":{"name":"Swiss Plasma Center - EPFL, Lausanne, Switzerland","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Ewalds, Timo","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Hafner, Roland","url":"http://orcid.org/0000-0001-8061-8828","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Abdolmaleki, Abbas","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"de las Casas, Diego","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Donner, Craig","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Fritz, Leslie","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Galperti, Cristian","affiliation":[{"name":"Swiss Plasma Center - EPFL","address":{"name":"Swiss Plasma Center - EPFL, Lausanne, Switzerland","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Huber, Andrea","url":"http://orcid.org/0000-0002-4431-8171","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Keeling, James","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Tsimpoukelli, Maria","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Kay, Jackie","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Merle, Antoine","affiliation":[{"name":"Swiss Plasma Center - EPFL","address":{"name":"Swiss Plasma Center - EPFL, Lausanne, Switzerland","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Moret, Jean-Marc","affiliation":[{"name":"Swiss Plasma Center - EPFL","address":{"name":"Swiss Plasma Center - EPFL, Lausanne, Switzerland","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Noury, Seb","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Pesamosca, Federico","affiliation":[{"name":"Swiss Plasma Center - EPFL","address":{"name":"Swiss Plasma Center - EPFL, Lausanne, Switzerland","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Pfau, David","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Sauter, Olivier","affiliation":[{"name":"Swiss Plasma Center - EPFL","address":{"name":"Swiss Plasma Center - EPFL, Lausanne, Switzerland","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Sommariva, Cristian","affiliation":[{"name":"Swiss Plasma Center - EPFL","address":{"name":"Swiss Plasma Center - EPFL, Lausanne, Switzerland","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Coda, Stefano","affiliation":[{"name":"Swiss Plasma Center - EPFL","address":{"name":"Swiss Plasma Center - EPFL, Lausanne, Switzerland","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Duval, Basil","affiliation":[{"name":"Swiss Plasma Center - EPFL","address":{"name":"Swiss Plasma Center - EPFL, Lausanne, Switzerland","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Fasoli, Ambrogio","affiliation":[{"name":"Swiss Plasma Center - EPFL","address":{"name":"Swiss Plasma Center - EPFL, Lausanne, Switzerland","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Kohli, Pushmeet","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Kavukcuoglu, Koray","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Hassabis, Demis","url":"http://orcid.org/0000-0003-2812-9917","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"},{"name":"Riedmiller, Martin","url":"http://orcid.org/0000-0002-8465-5690","affiliation":[{"name":"DeepMind","address":{"name":"DeepMind, London, UK","@type":"PostalAddress"},"@type":"Organization"}],"@type":"Person"}],"@type":"ScholarlyArticle"},"@context":"https://schema.org","@type":"WebPage"}</script>



    
    <link rel="canonical" href="https://www.nature.com/articles/s41586-021-04301-9">
    

    <meta name="journal_id" content="41586">

    <meta name="dc.title" content="Magnetic control of tokamak plasmas through deep reinforcement learning">

    <meta name="dc.source" content="Nature 2022 602:7897">

    <meta name="dc.format" content="text/html">

    <meta name="dc.publisher" content="Nature Publishing Group">

    <meta name="dc.date" content="2022-02-16">

    <meta name="dc.type" content="OriginalPaper">

    <meta name="dc.language" content="En">

    <meta name="dc.copyright" content="2022 The Author(s)">

    <meta name="dc.rights" content="2022 The Author(s)">

    <meta name="dc.rightsAgent" content="journalpermissions@springernature.com">

    <meta name="dc.description" content="Nuclear fusion using magnetic confinement, in particular in the tokamak configuration, is a promising path towards sustainable energy. A core challenge is to shape and maintain a high-temperature plasma within the tokamak vessel. This requires high-dimensional, high-frequency, closed-loop control using magnetic actuator coils, further complicated by the diverse requirements across a wide range of plasma configurations. In this work, we introduce a previously undescribed architecture for tokamak magnetic controller design that autonomously learns to command the full set of control coils. This architecture meets control objectives specified at a high level, at the same time satisfying physical and operational constraints. This approach has unprecedented flexibility and generality in problem specification and yields a notable reduction in design effort to produce new plasma configurations. We successfully produce and control a diverse set of plasma configurations on the Tokamak &#224; Configuration Variable1,2, including elongated, conventional shapes, as well as advanced configurations, such as negative triangularity and &#8216;snowflake&#8217; configurations. Our approach achieves accurate tracking of the location, current and shape for these configurations. We also demonstrate sustained &#8216;droplets&#8217; on TCV, in which two separate plasmas are maintained simultaneously within the vessel. This represents a notable advance for tokamak feedback control, showing the potential of reinforcement learning to accelerate research in the fusion domain, and is one of the most challenging real-world systems to which reinforcement learning has been applied. A newly designed control architecture uses deep reinforcement learning to learn to command the coils of a tokamak, and successfully stabilizes a wide variety of fusion plasma configurations.">

    <meta name="prism.issn" content="1476-4687">

    <meta name="prism.publicationName" content="Nature">

    <meta name="prism.publicationDate" content="2022-02-16">

    <meta name="prism.volume" content="602">

    <meta name="prism.number" content="7897">

    <meta name="prism.section" content="OriginalPaper">

    <meta name="prism.startingPage" content="414">

    <meta name="prism.endingPage" content="419">

    <meta name="prism.copyright" content="2022 The Author(s)">

    <meta name="prism.rightsAgent" content="journalpermissions@springernature.com">

    <meta name="prism.url" content="https://www.nature.com/articles/s41586-021-04301-9">

    <meta name="prism.doi" content="doi:10.1038/s41586-021-04301-9">

    <meta name="citation_pdf_url" content="https://www.nature.com/articles/s41586-021-04301-9.pdf">

    <meta name="citation_fulltext_html_url" content="https://www.nature.com/articles/s41586-021-04301-9">

    <meta name="citation_journal_title" content="Nature">

    <meta name="citation_journal_abbrev" content="Nature">

    <meta name="citation_publisher" content="Nature Publishing Group">

    <meta name="citation_issn" content="1476-4687">

    <meta name="citation_title" content="Magnetic control of tokamak plasmas through deep reinforcement learning">

    <meta name="citation_volume" content="602">

    <meta name="citation_issue" content="7897">

    <meta name="citation_publication_date" content="2022/02">

    <meta name="citation_online_date" content="2022/02/16">

    <meta name="citation_firstpage" content="414">

    <meta name="citation_lastpage" content="419">

    <meta name="citation_article_type" content="Article">

    <meta name="citation_fulltext_world_readable" content="">

    <meta name="citation_language" content="en">

    <meta name="dc.identifier" content="doi:10.1038/s41586-021-04301-9">

    <meta name="DOI" content="10.1038/s41586-021-04301-9">

    <meta name="citation_doi" content="10.1038/s41586-021-04301-9">

    <meta name="description" content="Nuclear fusion using magnetic confinement, in particular in the tokamak configuration, is a promising path towards sustainable energy. A core challenge is to shape and maintain a high-temperature plasma within the tokamak vessel. This requires high-dimensional, high-frequency, closed-loop control using magnetic actuator coils, further complicated by the diverse requirements across a wide range of plasma configurations. In this work, we introduce a previously undescribed architecture for tokamak magnetic controller design that autonomously learns to command the full set of control coils. This architecture meets control objectives specified at a high level, at the same time satisfying physical and operational constraints. This approach has unprecedented flexibility and generality in problem specification and yields a notable reduction in design effort to produce new plasma configurations. We successfully produce and control a diverse set of plasma configurations on the Tokamak &#224; Configuration Variable1,2, including elongated, conventional shapes, as well as advanced configurations, such as negative triangularity and &#8216;snowflake&#8217; configurations. Our approach achieves accurate tracking of the location, current and shape for these configurations. We also demonstrate sustained &#8216;droplets&#8217; on TCV, in which two separate plasmas are maintained simultaneously within the vessel. This represents a notable advance for tokamak feedback control, showing the potential of reinforcement learning to accelerate research in the fusion domain, and is one of the most challenging real-world systems to which reinforcement learning has been applied. A newly designed control architecture uses deep reinforcement learning to learn to command the coils of a tokamak, and successfully stabilizes a wide variety of fusion plasma configurations.">

    <meta name="dc.creator" content="Degrave, Jonas">

    <meta name="dc.creator" content="Felici, Federico">

    <meta name="dc.creator" content="Buchli, Jonas">

    <meta name="dc.creator" content="Neunert, Michael">

    <meta name="dc.creator" content="Tracey, Brendan">

    <meta name="dc.creator" content="Carpanese, Francesco">

    <meta name="dc.creator" content="Ewalds, Timo">

    <meta name="dc.creator" content="Hafner, Roland">

    <meta name="dc.creator" content="Abdolmaleki, Abbas">

    <meta name="dc.creator" content="de las Casas, Diego">

    <meta name="dc.creator" content="Donner, Craig">

    <meta name="dc.creator" content="Fritz, Leslie">

    <meta name="dc.creator" content="Galperti, Cristian">

    <meta name="dc.creator" content="Huber, Andrea">

    <meta name="dc.creator" content="Keeling, James">

    <meta name="dc.creator" content="Tsimpoukelli, Maria">

    <meta name="dc.creator" content="Kay, Jackie">

    <meta name="dc.creator" content="Merle, Antoine">

    <meta name="dc.creator" content="Moret, Jean-Marc">

    <meta name="dc.creator" content="Noury, Seb">

    <meta name="dc.creator" content="Pesamosca, Federico">

    <meta name="dc.creator" content="Pfau, David">

    <meta name="dc.creator" content="Sauter, Olivier">

    <meta name="dc.creator" content="Sommariva, Cristian">

    <meta name="dc.creator" content="Coda, Stefano">

    <meta name="dc.creator" content="Duval, Basil">

    <meta name="dc.creator" content="Fasoli, Ambrogio">

    <meta name="dc.creator" content="Kohli, Pushmeet">

    <meta name="dc.creator" content="Kavukcuoglu, Koray">

    <meta name="dc.creator" content="Hassabis, Demis">

    <meta name="dc.creator" content="Riedmiller, Martin">

    <meta name="dc.subject" content="Computer science">

    <meta name="dc.subject" content="Magnetically confined plasmas">

    <meta name="dc.subject" content="Nuclear fusion and fission">

    <meta name="citation_reference" content="citation_journal_title=Plasma Phys. Control. Fusion; citation_title=Creation and control of variably shaped plasmas in TCV; citation_author=F Hofmann; citation_volume=36; citation_publication_date=1994; citation_pages=B277; citation_doi=10.1088/0741-3335/36/12B/023; citation_id=CR1">

    <meta name="citation_reference" content="citation_journal_title=Nucl. Fusion; citation_title=Physics research on the TCV tokamak facility: from conventional to alternative scenarios and beyond; citation_author=S Coda; citation_volume=59; citation_publication_date=2019; citation_pages=112023; citation_doi=10.1088/1741-4326/ab25cb; citation_id=CR2">

    <meta name="citation_reference" content="citation_journal_title=Nucl. Fusion; citation_title=A novel plasma position and shape controller for advanced configuration development on the TCV tokamak; citation_author=H Anand, S Coda, F Felici, C Galperti, J-M Moret; citation_volume=57; citation_publication_date=2017; citation_pages=126026; citation_doi=10.1088/1741-4326/aa7f4d; citation_id=CR3">

    <meta name="citation_reference" content="citation_journal_title=Fusion Eng. Des.; citation_title=MIMO shape control at the EAST tokamak: simulations and experiments; citation_author=A Mele; citation_volume=146; citation_publication_date=2019; citation_pages=1282-1285; citation_doi=10.1016/j.fusengdes.2019.02.058; citation_id=CR4">

    <meta name="citation_reference" content="citation_journal_title=Plasma Phys. Control. Fusion; citation_title=Plasma flux expansion control on the DIII-D tokamak; citation_author=H Anand; citation_volume=63; citation_publication_date=2020; citation_pages=015006; citation_doi=10.1088/1361-6587/abc457; citation_id=CR5">

    <meta name="citation_reference" content="citation_journal_title=J. Fusion Energy; citation_title=Plasma magnetic control in tokamak devices; citation_author=G Tommasi; citation_volume=38; citation_publication_date=2019; citation_pages=406-436; citation_doi=10.1007/s10894-018-0162-5; citation_id=CR6">

    <meta name="citation_reference" content="citation_journal_title=Fusion Sci. Technol.; citation_title=Valid coordinate systems for linearized plasma shape response models in tokamaks; citation_author=ML Walker, DA Humphreys; citation_volume=50; citation_publication_date=2006; citation_pages=473-489; citation_doi=10.13182/FST06-A1271; citation_id=CR7">

    <meta name="citation_reference" content="citation_journal_title=J. Comput. Phys.; citation_title=Automating the design of tokamak experiment scenarios; citation_author=J Blum, H Heumann, E Nardon, X Song; citation_volume=394; citation_publication_date=2019; citation_pages=594-614; citation_doi=10.1016/j.jcp.2019.05.046; citation_id=CR8">

    <meta name="citation_reference" content="citation_journal_title=Nucl. Fusion; citation_title=Real time equilibrium reconstruction for tokamak discharge control; citation_author=JR Ferron; citation_volume=38; citation_publication_date=1998; citation_pages=1055; citation_doi=10.1088/0029-5515/38/7/308; citation_id=CR9">

    <meta name="citation_reference" content="citation_journal_title=Fusion Eng. Des.; citation_title=Tokamak equilibrium reconstruction code LIUQE and its real time implementation; citation_author=J-M Moret; citation_volume=91; citation_publication_date=2015; citation_pages=1-15; citation_doi=10.1016/j.fusengdes.2014.09.019; citation_id=CR10">

    <meta name="citation_reference" content="Xie, Z., Berseth, G., Clary, P., Hurst, J. &amp; van de Panne, M. Feedback control for Cassie with deep reinforcement learning. In 2018 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS) 1241&#8211;1246 (IEEE, 2018).">

    <meta name="citation_reference" content="Akkaya, I. et al. Solving Rubik&#8217;s cube with a robot hand. Preprint at 
                  https://arxiv.org/abs/1910.07113
                  
                 (2019).">

    <meta name="citation_reference" content="citation_journal_title=Nature; citation_title=Autonomous navigation of stratospheric balloons using reinforcement learning; citation_author=MG Bellemare; citation_volume=588; citation_publication_date=2020; citation_pages=77-82; citation_doi=10.1038/s41586-020-2939-8; citation_id=CR13">

    <meta name="citation_reference" content="citation_journal_title=J. Fusion Energy; citation_title=Advancing fusion with machine learning research needs workshop report; citation_author=D Humphreys; citation_volume=39; citation_publication_date=2020; citation_pages=123-155; citation_doi=10.1007/s10894-020-00258-1; citation_id=CR14">

    <meta name="citation_reference" content="citation_journal_title=Neural Comput.; citation_title=Real time control of a tokamak plasma using neural networks; citation_author=CM Bishop, PS Haynes, ME Smith, TN Todd, DL Trotman; citation_volume=7; citation_publication_date=1995; citation_pages=206-217; citation_doi=10.1162/neco.1995.7.1.206; citation_id=CR15">

    <meta name="citation_reference" content="citation_journal_title=Nucl. Fusion; citation_title=Deep neural network Grad-Shafranov solver constrained with measured magnetic signals; citation_author=S Joung; citation_volume=60; citation_publication_date=2019; citation_pages=16034; citation_doi=10.1088/1741-4326/ab555f; citation_id=CR16">

    <meta name="citation_reference" content="citation_journal_title=Phys. Plasmas; citation_title=Fast modeling of turbulent transport in fusion plasmas using neural networks; citation_author=KL Plassche; citation_volume=27; citation_publication_date=2020; citation_pages=022310; citation_doi=10.1063/1.5134126; citation_id=CR17">

    <meta name="citation_reference" content="citation_journal_title=Nucl. Fusion; citation_title=Data-driven profile prediction for DIII-D; citation_author=J Abbate, R Conlin, E Kolemen; citation_volume=61; citation_publication_date=2021; citation_pages=046027; citation_doi=10.1088/1741-4326/abe08d; citation_id=CR18">

    <meta name="citation_reference" content="citation_journal_title=Nature; citation_title=Predicting disruptive instabilities in controlled fusion plasmas through deep learning; citation_author=J Kates-Harbeck, A Svyatkovskiy, W Tang; citation_volume=568; citation_publication_date=2019; citation_pages=526-531; citation_doi=10.1038/s41586-019-1116-4; citation_id=CR19">

    <meta name="citation_reference" content="Jardin, S. Computational Methods in Plasma Physics (CRC Press, 2010).">

    <meta name="citation_reference" content="citation_journal_title=J. Nucl. Energy (1954); citation_title=Hydromagnetic equilibria and force-free fields; citation_author=H Grad, H Rubin; citation_volume=7; citation_publication_date=1958; citation_pages=284-285; citation_doi=10.1016/0891-3919(58)90139-6; citation_id=CR21">

    <meta name="citation_reference" content="Carpanese, F. Development of Free-boundary Equilibrium and Transport Solvers for Simulation and Real-time Interpretation of Tokamak Experiments. PhD thesis, EPFL (2021).">

    <meta name="citation_reference" content="Abdolmaleki, A. et al. Relative entropy regularized policy iteration. Preprint at 
                  https://arxiv.org/abs/1812.02256
                  
                 (2018).">

    <meta name="citation_reference" content="Paley, J. I., Coda, S., Duval, B., Felici, F. &amp; Moret, J.-M. Architecture and commissioning of the TCV distributed feedback control system. In 2010 17th IEEE-NPSS Real Time Conference 1&#8211;6 (IEEE, 2010).">

    <meta name="citation_reference" content="Freidberg, J. P. Plasma Physics and Fusion Energy (Cambridge Univ. Press, 2008).">

    <meta name="citation_reference" content="citation_journal_title=Nucl. Fusion; citation_title=Real-time optical plasma boundary reconstruction for plasma position control at the TCV Tokamak; citation_author=GD Hommen; citation_volume=54; citation_publication_date=2014; citation_pages=073018; citation_doi=10.1088/0029-5515/54/7/073018; citation_id=CR26">

    <meta name="citation_reference" content="citation_journal_title=Phys. Rev. Lett.; citation_title=Achievement of reactor-relevant performance in negative triangularity shape in the DIII-D tokamak; citation_author=ME Austin; citation_volume=122; citation_publication_date=2019; citation_pages=115001; citation_doi=10.1103/PhysRevLett.122.115001; citation_id=CR27">

    <meta name="citation_reference" content="citation_journal_title=Nucl. Fusion; citation_title=Initial development of the DIII&#8211;D snowflake divertor control; citation_author=E Kolemen; citation_volume=58; citation_publication_date=2018; citation_pages=066007; citation_doi=10.1088/1741-4326/aab0d3; citation_id=CR28">

    <meta name="citation_reference" content="citation_journal_title=Nucl. Fusion; citation_title=Real time magnetic control of the snowflake plasma configuration in the TCV tokamak; citation_author=H Anand; citation_volume=59; citation_publication_date=2019; citation_pages=126032; citation_doi=10.1088/1741-4326/ab4440; citation_id=CR29">

    <meta name="citation_reference" content="Wigbers, M. &amp; Riedmiller, M. A new method for the analysis of neural reference model control. In Proc. International Conference on Neural Networks (ICNN&#8217;97) Vol. 2, 739&#8211;743 (IEEE, 1997).">

    <meta name="citation_reference" content="Berkenkamp, F., Turchetta, M., Schoellig, A. &amp; Krause, A. Safe model-based reinforcement learning with stability guarantees. In 2017 Advances in Neural Information Processing Systems 908&#8211;919 (ACM, 2017).">

    <meta name="citation_reference" content="citation_journal_title=IEEE Tran. Automat. Control; citation_title=Probabilistic model predictive safety certification for learning-based control; citation_author=KP Wabersich, L Hewing, A Carron, MN Zeilinger; citation_volume=67; citation_publication_date=2021; citation_pages=176-188; citation_doi=10.1109/TAC.2021.3049335; citation_id=CR32">

    <meta name="citation_reference" content="Abdolmaleki, A. et al. On multi-objective policy optimization as a tool for reinforcement learning. Preprint at 
                  https://arxiv.org/abs/2106.08199
                  
                 (2021).">

    <meta name="citation_reference" content="citation_journal_title=Nucl. Fusion; citation_title=Overview of the TCV tokamak program: scientific progress and facility upgrades; citation_author=S Coda; citation_volume=57; citation_publication_date=2017; citation_pages=102011; citation_doi=10.1088/1741-4326/aa6412; citation_id=CR34">

    <meta name="citation_reference" content="citation_journal_title=Fusion Eng. Des.; citation_title=Neutral beam heating on the TCV tokamak; citation_author=AN Karpushov; citation_volume=123; citation_publication_date=2017; citation_pages=468-472; citation_doi=10.1016/j.fusengdes.2017.02.076; citation_id=CR35">

    <meta name="citation_reference" content="citation_journal_title=Nucl. Fusion; citation_title=Plasma equilibrium response modelling and validation on JT-60U; citation_author=JB Lister; citation_volume=42; citation_publication_date=2002; citation_pages=708; citation_doi=10.1088/0029-5515/42/6/309; citation_id=CR36">

    <meta name="citation_reference" content="citation_journal_title=Fusion Technol.; citation_title=The control of tokamak configuration variable plasmas; citation_author=JB Lister; citation_volume=32; citation_publication_date=1997; citation_pages=321-373; citation_doi=10.13182/FST97-A1; citation_id=CR37">

    <meta name="citation_reference" content="Ulyanov, D., Vedaldi, A. &amp; Lempitsky, V. Instance normalization: the missing ingredient for fast stylization. Preprint at 
                  https://arxiv.org/abs/1607.08022
                  
                 (2016).">

    <meta name="citation_reference" content="Andrychowicz, M. et al. What matters in on-policy reinforcement learning? A large-scale empirical study. In ICLR 2021 Ninth International Conference on Learning Representations (2021).">

    <meta name="citation_reference" content="Cassirer, A. et al. Reverb: a framework for experience replay. Preprint at 
                  https://arxiv.org/abs/2102.04736
                  
                 (2021).">

    <meta name="citation_reference" content="Hoffman, M. et al. Acme: a research framework for distributed reinforcement learning. Preprint at 
                  https://arxiv.org/abs/2006.00979
                  
                 (2020).">

    <meta name="citation_reference" content="citation_journal_title=Comput. Phys. Commun.; citation_title=FBT-a free-boundary tokamak equilibrium code for highly elongated and shaped plasmas; citation_author=F Hofmann; citation_volume=48; citation_publication_date=1988; citation_pages=207-221; citation_doi=10.1016/0010-4655(88)90041-0; citation_id=CR42">

    <meta name="citation_reference" content="Abadi, M. et al. TensorFlow: a system for large-scale machine learning. In Proc. 12th USENIX Symposium on Operating Systems Design and Implementation (OSDI &#8217;16) 265&#8211;283 (2016).">

    <meta name="citation_reference" content="citation_journal_title=Fusion Eng. Des.; citation_title=Model-based plasma vertical stabilization and position control at EAST; citation_author=G Tommasi; citation_volume=129; citation_publication_date=2018; citation_pages=152-157; citation_doi=10.1016/j.fusengdes.2018.02.020; citation_id=CR44">

    <meta name="citation_reference" content="Gerk&#353;i&#269;, S. &amp; De Tommasi, G. ITER plasma current and shape control using MPC. In 2016 IEEE Conference on Control Applications (CCA) 599&#8211;604 (IEEE, 2016).">

    <meta name="citation_reference" content="Boncagni, L. et al. Performance-based controller switching: an application to plasma current control at FTU. In 2015 54th IEEE Conference on Decision and Control (CDC) 2319&#8211;2324 (IEEE, 2015).">

    <meta name="citation_reference" content="citation_journal_title=Nucl. Fusion; citation_title=Safety factor profile control with reduced central solenoid flux consumption during plasma current ramp-up phase using a reinforcement learning technique; citation_author=T Wakatsuki, T Suzuki, N Hayashi, N Oyama, S Ide; citation_volume=59; citation_publication_date=2019; citation_pages=066022; citation_doi=10.1088/1741-4326/ab1571; citation_id=CR47">

    <meta name="citation_reference" content="citation_journal_title=Nucl. Fusion; citation_title=Ion temperature gradient control using reinforcement learning technique; citation_author=T Wakatsuki, T Suzuki, N Oyama, N Hayashi; citation_volume=61; citation_publication_date=2021; citation_pages=046036; citation_doi=10.1088/1741-4326/abe68d; citation_id=CR48">

    <meta name="citation_reference" content="citation_journal_title=Nucl. Fusion; citation_title=Feedforward beta control in the KSTAR tokamak by deep reinforcement learning; citation_author=J Seo; citation_volume=61; citation_publication_date=2021; citation_pages=106010; citation_doi=10.1088/1741-4326/ac121b; citation_id=CR49">

    <meta name="citation_reference" content="Yang, F. et al. Launchpad: a programming model for distributed machine learning research. Preprint at 
                  https://arxiv.org/abs/2106.04516
                  
                 (2021).">

    <meta name="citation_reference" content="Muldal, A. et al. dm_env: a Python interface for reinforcement learning environments. 
                  http://github.com/deepmind/dm_env
                  
                 (2019).">

    <meta name="citation_reference" content="Reynolds, M. et al. Sonnet: TensorFlow-based neural network library. 
                  http://github.com/deepmind/sonnet
                  
                 (2017).">

    <meta name="citation_reference" content="Mart&#237;n A. et al. TensorFlow: large-scale machine learning on heterogeneous systems. Software available from 
                  https://www.tensorflow.org/
                  
                 2015.">

    <meta name="citation_reference" content="Hender, T. C. et al. Chapter 3: MHD stability, operational limits and disruptions. Nucl. Fusion 47, S128&#8211;S202 (2007).&#160;">

    <meta name="citation_author" content="Degrave, Jonas">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Felici, Federico">

    <meta name="citation_author_institution" content="Swiss Plasma Center - EPFL, Lausanne, Switzerland">

    <meta name="citation_author" content="Buchli, Jonas">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Neunert, Michael">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Tracey, Brendan">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Carpanese, Francesco">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author_institution" content="Swiss Plasma Center - EPFL, Lausanne, Switzerland">

    <meta name="citation_author" content="Ewalds, Timo">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Hafner, Roland">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Abdolmaleki, Abbas">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="de las Casas, Diego">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Donner, Craig">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Fritz, Leslie">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Galperti, Cristian">

    <meta name="citation_author_institution" content="Swiss Plasma Center - EPFL, Lausanne, Switzerland">

    <meta name="citation_author" content="Huber, Andrea">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Keeling, James">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Tsimpoukelli, Maria">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Kay, Jackie">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Merle, Antoine">

    <meta name="citation_author_institution" content="Swiss Plasma Center - EPFL, Lausanne, Switzerland">

    <meta name="citation_author" content="Moret, Jean-Marc">

    <meta name="citation_author_institution" content="Swiss Plasma Center - EPFL, Lausanne, Switzerland">

    <meta name="citation_author" content="Noury, Seb">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Pesamosca, Federico">

    <meta name="citation_author_institution" content="Swiss Plasma Center - EPFL, Lausanne, Switzerland">

    <meta name="citation_author" content="Pfau, David">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Sauter, Olivier">

    <meta name="citation_author_institution" content="Swiss Plasma Center - EPFL, Lausanne, Switzerland">

    <meta name="citation_author" content="Sommariva, Cristian">

    <meta name="citation_author_institution" content="Swiss Plasma Center - EPFL, Lausanne, Switzerland">

    <meta name="citation_author" content="Coda, Stefano">

    <meta name="citation_author_institution" content="Swiss Plasma Center - EPFL, Lausanne, Switzerland">

    <meta name="citation_author" content="Duval, Basil">

    <meta name="citation_author_institution" content="Swiss Plasma Center - EPFL, Lausanne, Switzerland">

    <meta name="citation_author" content="Fasoli, Ambrogio">

    <meta name="citation_author_institution" content="Swiss Plasma Center - EPFL, Lausanne, Switzerland">

    <meta name="citation_author" content="Kohli, Pushmeet">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Kavukcuoglu, Koray">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Hassabis, Demis">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="citation_author" content="Riedmiller, Martin">

    <meta name="citation_author_institution" content="DeepMind, London, UK">

    <meta name="access_endpoint" content="https://www.nature.com/platform/readcube-access">

    <meta name="twitter:site" content="@nature">

    <meta name="twitter:card" content="summary">

    <meta name="twitter:image:alt" content="Content cover image">

    <meta name="twitter:title" content="Magnetic control of tokamak plasmas through deep reinforcement learning">

    <meta name="twitter:description" content="Nature - A newly designed control architecture uses deep reinforcement learning to learn to command the coils of a tokamak, and successfully stabilizes a wide variety of fusion plasma configurations.">

    <meta name="twitter:image" content="https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig1_HTML.png">


    
        <meta property="og:url" content="https://www.nature.com/articles/s41586-021-04301-9">
        <meta property="og:type" content="article">
        <meta property="og:site_name" content="Nature">
        <meta property="og:title" content="Magnetic control of tokamak plasmas through deep reinforcement learning - Nature">
        <meta property="og:description" content="A newly designed control architecture uses deep reinforcement learning to learn to command the coils of a tokamak, and successfully stabilizes a wide variety of fusion plasma configurations.">
        <meta property="og:image" content="https://media.springernature.com/m685/springer-static/image/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig1_HTML.png">
    
    <script>
        window.eligibleForRa21 = 'false'; 
    </script>
</head>
<body class="article-page">

<noscript><iframe src="https://collect.nature.com/ns.html?id=GTM-MRVXSHQ"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>



<div class="position-relative cleared z-index-50 background-white" data-test="top-containers">
    <a class="c-skip-link" href="#content">Skip to main content</a>



<div class="c-grade-c-banner u-hide">
    <div class="c-grade-c-banner__container">
        
        <p>Thank you for visiting nature.com. You are using a browser version with limited support for CSS. To obtain
            the best experience, we recommend you use a more up to date browser (or turn off compatibility mode in
            Internet Explorer). In the meantime, to ensure continued support, we are displaying the site without styles
            and JavaScript.</p>

    </div>
</div>

    

    <div class="u-lazy-ad-wrapper">
            <div class="deferred-placeholder" data-replace="true"
                 data-placeholder="/placeholder/v1/institutionalBanner?bpids=[bpids] #institutional-banner-container"></div>
            <aside class="c-ad c-ad--728x90">
                <div class="c-ad__inner" data-container-type="banner-advert">
                    <p class="c-ad__label">Advertisement</p>
                    
        
            
    <div id="div-gpt-ad-top-1"
         class="div-gpt-ad advert leaderboard js-ad text-center hide-print grade-c-hide"
         data-ad-type="top"
         data-pa11y-ignore
         data-gpt
         data-gpt-unitpath="/285/nature.com/article"
         data-gpt-sizes="728x90"
         data-gpt-targeting="type=article;pos=top;artid=s41586-021-04301-9;doi=10.1038/s41586-021-04301-9;techmeta=119,120,123,129,139,144;subjmeta=1136,117,1960,4077,4091,4093,639,705,766;kwrd=Computer+science,Magnetically+confined+plasmas,Nuclear+fusion+and+fission">
        <noscript>
            <a href="//pubads.g.doubleclick.net/gampad/jump?iu=/285/nature.com/article&amp;sz=728x90&amp;c=-291376024&amp;t=pos%3Dtop%26type%3Darticle%26artid%3Ds41586-021-04301-9%26doi%3D10.1038/s41586-021-04301-9%26techmeta%3D119,120,123,129,139,144%26subjmeta%3D1136,117,1960,4077,4091,4093,639,705,766%26kwrd%3DComputer+science,Magnetically+confined+plasmas,Nuclear+fusion+and+fission">
                <img data-test="gpt-advert-fallback-img"
                     src="//pubads.g.doubleclick.net/gampad/ad?iu=/285/nature.com/article&amp;sz=728x90&amp;c=-291376024&amp;t=pos%3Dtop%26type%3Darticle%26artid%3Ds41586-021-04301-9%26doi%3D10.1038/s41586-021-04301-9%26techmeta%3D119,120,123,129,139,144%26subjmeta%3D1136,117,1960,4077,4091,4093,639,705,766%26kwrd%3DComputer+science,Magnetically+confined+plasmas,Nuclear+fusion+and+fission"
                     alt="Advertisement"
                     width="728"
                     height="90"></a>
        </noscript>
    </div>

        
    
                </div>
            </aside>
        </div>
    <header class="c-header" id="header" data-header data-track-component="nature-150-split-header" style="border-color:#000">
        <div class="c-header__row c-header__row--flush">
            <div class="c-header__container">
                <div class="c-header__split">
                    
                    
                    <div class="c-header__logo-container">
                        
                        <a href="/"
                           data-track="click" data-track-action="home" data-track-label="image">
                            <picture class="c-header__logo">
                                <source srcset="//media.springernature.com/full/nature-cms/uploads/product/nature/header-86f1267ea01eccd46b530284be10585e.svg" media="(min-width: 875px)">
                                <img src="//media.springernature.com/full/nature-cms/uploads/product/nature/header-86f1267ea01eccd46b530284be10585e.svg" alt="Nature">
                            </picture>
                        </a>
                    
                    </div>
                    
                    <ul class="c-header__menu c-header__menu--global">
                        <li class="c-header__item c-header__item--nature-research">
                            <a class="c-header__link" href="https://www.nature.com/siteindex" data-test="siteindex-link"
                               data-track="click" data-track-action="open nature research index" data-track-label="link">
                                <span>View all journals</span>
                            </a>
                        </li>
                        <li class="c-header__item c-header__item--pipe">
                            <a class="c-header__link"
                               href="#search-menu"
                               data-header-expander
                               data-test="search-link" data-track="click" data-track-action="open search tray" data-track-label="button">
                                <span>Search</span><svg role="img" aria-hidden="true" focusable="false" height="22" width="22" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path d="M16.48 15.455c.283.282.29.749.007 1.032a.738.738 0 01-1.032-.007l-3.045-3.044a7 7 0 111.026-1.026zM8 14A6 6 0 108 2a6 6 0 000 12z"/></svg>
                            </a>
                        </li>
                        <li class="c-header__item">
                            <a href="/nams/svc/myaccount"
    id="my-account"
    class="c-header__link placeholder"
    data-test="login-link" data-track="click" data-track-action="my account" data-track-category="nature-150-split-header" data-track-label="link">
    <span>My Account</span><svg role="img" aria-hidden="true" focusable="false" height="22" width="22" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path d="M10.238 16.905a7.96 7.96 0 003.53-1.48c-.874-2.514-2.065-3.936-3.768-4.319V9.83a3.001 3.001 0 10-2 0v1.277c-1.703.383-2.894 1.805-3.767 4.319A7.96 7.96 0 009 17c.419 0 .832-.032 1.238-.095zm4.342-2.172a8 8 0 10-11.16 0c.757-2.017 1.84-3.608 3.49-4.322a4 4 0 114.182 0c1.649.714 2.731 2.305 3.488 4.322zM9 18A9 9 0 119 0a9 9 0 010 18z" fill="#333" fill-rule="evenodd"/></svg>
</a>
<a href="https://idp.nature.com/authorize/natureuser?client_id&#x3D;grover&amp;redirect_uri&#x3D;https%3A%2F%2Fwww.nature.com%2Farticles%2Fs41586-021-04301-9"
    id="login-button"
    style="display: none;"
    class="c-header__link placeholder"
    data-test="login-link" data-track="click" data-track-action="login" data-track-category="nature-150-split-header" data-track-label="link">
    <span>Login</span><svg role="img" aria-hidden="true" focusable="false" height="22" width="22" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path d="M10.238 16.905a7.96 7.96 0 003.53-1.48c-.874-2.514-2.065-3.936-3.768-4.319V9.83a3.001 3.001 0 10-2 0v1.277c-1.703.383-2.894 1.805-3.767 4.319A7.96 7.96 0 009 17c.419 0 .832-.032 1.238-.095zm4.342-2.172a8 8 0 10-11.16 0c.757-2.017 1.84-3.608 3.49-4.322a4 4 0 114.182 0c1.649.714 2.731 2.305 3.488 4.322zM9 18A9 9 0 119 0a9 9 0 010 18z" fill="#333" fill-rule="evenodd"/></svg>
</a>

                        </li>
                    </ul>
                </div>
            </div>
        </div>
        
            <div class="c-header__row">
                <div class="c-header__container" data-test="navigation-row">
                    <div class="c-header__split">
                        <div class="c-header__split">
                            <ul class="c-header__menu c-header__menu--journal">
                                
                                    <li class="c-header__item c-header__item--dropdown-menu" data-test="explore-content-button">
                                        <a href="#explore"
                                           class="c-header__link c-header__link--chevron"
                                           data-header-expander
                                           data-test="menu-button--explore"
                                           data-track="click" data-track-action="open explore expander" data-track-label="button">
                                            <span><span class="c-header__show-text">Explore</span> content</span><svg role="img" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="m5.58578644 3-3.29289322-3.29289322c-.39052429-.39052429-.39052429-1.02368927 0-1.41421356s1.02368927-.39052429 1.41421356 0l4 4c.39052429.39052429.39052429 1.02368927 0 1.41421356l-4 4c-.39052429.39052429-1.02368927.39052429-1.41421356 0s-.39052429-1.02368927 0-1.41421356z" transform="matrix(0 1 -1 0 11 3)"/></svg>
                                        </a>
                                    </li>
                                
                                <li class="c-header__item c-header__item--dropdown-menu">
                                    <a href="#about-the-journal"
                                       class="c-header__link c-header__link--chevron"
                                       data-header-expander
                                       data-test="menu-button--about-the-journal"
                                       data-track="click" data-track-action="open about the journal expander" data-track-label="button">
                                        <span>About <span class="c-header__show-text">the journal</span></span><svg role="img" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="m5.58578644 3-3.29289322-3.29289322c-.39052429-.39052429-.39052429-1.02368927 0-1.41421356s1.02368927-.39052429 1.41421356 0l4 4c.39052429.39052429.39052429 1.02368927 0 1.41421356l-4 4c-.39052429.39052429-1.02368927.39052429-1.41421356 0s-.39052429-1.02368927 0-1.41421356z" transform="matrix(0 1 -1 0 11 3)"/></svg>
                                    </a>
                                </li>
                                
                                    <li class="c-header__item c-header__item--dropdown-menu u-mr-2" data-test="publish-with-us-button">
                                        <a href="#publish-with-us"
                                           class="c-header__link c-header__link--chevron c-header__link--dropdown-menu"
                                           data-header-expander
                                           data-test="menu-button--publish"
                                           data-track="click" data-track-action="open publish with us expander" data-track-label="button">
                                            <span>Publish <span class="c-header__show-text">with us</span></span><svg role="img" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="m5.58578644 3-3.29289322-3.29289322c-.39052429-.39052429-.39052429-1.02368927 0-1.41421356s1.02368927-.39052429 1.41421356 0l4 4c.39052429.39052429.39052429 1.02368927 0 1.41421356l-4 4c-.39052429.39052429-1.02368927.39052429-1.41421356 0s-.39052429-1.02368927 0-1.41421356z" transform="matrix(0 1 -1 0 11 3)"/></svg>
                                        </a>
                                    </li>
                                
                            </ul>

                            
                        </div>

                        <ul class="c-header__menu c-header__menu--tools">
                            
                                <li class="c-header__item">
                                    <a class="c-header__link"
                                       href="https://www.nature.com/my-account/alerts/subscribe-journal?list-id&#x3D;1"
                                       rel="nofollow"
                                       data-track="click"
                                       data-track-action="Sign up for alerts"
                                       data-track-label="link (desktop site header)"
                                       data-track-external>
                                        <span>Sign up for alerts</span><svg role="img" aria-hidden="true" focusable="false" height="18" viewBox="0 0 18 18" width="18" xmlns="http://www.w3.org/2000/svg"><path d="m4 10h2.5c.27614237 0 .5.2238576.5.5s-.22385763.5-.5.5h-3.08578644l-1.12132034 1.1213203c-.18753638.1875364-.29289322.4418903-.29289322.7071068v.1715729h14v-.1715729c0-.2652165-.1053568-.5195704-.2928932-.7071068l-1.7071068-1.7071067v-3.4142136c0-2.76142375-2.2385763-5-5-5-2.76142375 0-5 2.23857625-5 5zm3 4c0 1.1045695.8954305 2 2 2s2-.8954305 2-2zm-5 0c-.55228475 0-1-.4477153-1-1v-.1715729c0-.530433.21071368-1.0391408.58578644-1.4142135l1.41421356-1.4142136v-3c0-3.3137085 2.6862915-6 6-6s6 2.6862915 6 6v3l1.4142136 1.4142136c.3750727.3750727.5857864.8837805.5857864 1.4142135v.1715729c0 .5522847-.4477153 1-1 1h-4c0 1.6568542-1.3431458 3-3 3-1.65685425 0-3-1.3431458-3-3z" fill="#222"/></svg>
                                    </a>
                                </li>
                            
                            
                                <li class="c-header__item c-header__item--pipe">
                                    <a class="c-header__link"
                                       href="http://feeds.nature.com/nature/rss/current"
                                       data-track="click"
                                       data-track-action="rss feed"
                                       data-track-label="link">
                                        <span>RSS feed</span>
                                    </a>
                                </li>
                            
                        </ul>
                    </div>
                </div>
            </div>
        
    </header>


    
    
        <nav class="u-mb-16 u-hide u-show-at-md" aria-label="breadcrumbs">
            <div class="u-container">
                <ol class="c-breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">
                    <li class="c-breadcrumbs__item" id="breadcrumb0" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a class="c-breadcrumbs__link"
                               href="/" itemprop="item"
                               data-track="click" data-track-action="breadcrumb" data-track-category="header" data-track-label="link:nature"><span itemprop="name">nature</span></a><meta itemprop="position" content="1">
                                    <svg class="c-breadcrumbs__chevron" role="img" aria-hidden="true" focusable="false" height="10" viewBox="0 0 10 10" width="10"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <path d="m5.96738168 4.70639573 2.39518594-2.41447274c.37913917-.38219212.98637524-.38972225 1.35419292-.01894278.37750606.38054586.37784436.99719163-.00013556 1.37821513l-4.03074001 4.06319683c-.37758093.38062133-.98937525.38100976-1.367372-.00003075l-4.03091981-4.06337806c-.37759778-.38063832-.38381821-.99150444-.01600053-1.3622839.37750607-.38054587.98772445-.38240057 1.37006824.00302197l2.39538588 2.4146743.96295325.98624457z"
                                              fill="#666" fill-rule="evenodd" transform="matrix(0 -1 1 0 0 10)"/>
                                    </svg>
                                </li><li class="c-breadcrumbs__item" id="breadcrumb1" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a class="c-breadcrumbs__link"
                               href="/nature/articles?type&#x3D;article" itemprop="item"
                               data-track="click" data-track-action="breadcrumb" data-track-category="header" data-track-label="link:articles"><span itemprop="name">articles</span></a><meta itemprop="position" content="2">
                                    <svg class="c-breadcrumbs__chevron" role="img" aria-hidden="true" focusable="false" height="10" viewBox="0 0 10 10" width="10"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <path d="m5.96738168 4.70639573 2.39518594-2.41447274c.37913917-.38219212.98637524-.38972225 1.35419292-.01894278.37750606.38054586.37784436.99719163-.00013556 1.37821513l-4.03074001 4.06319683c-.37758093.38062133-.98937525.38100976-1.367372-.00003075l-4.03091981-4.06337806c-.37759778-.38063832-.38381821-.99150444-.01600053-1.3622839.37750607-.38054587.98772445-.38240057 1.37006824.00302197l2.39538588 2.4146743.96295325.98624457z"
                                              fill="#666" fill-rule="evenodd" transform="matrix(0 -1 1 0 0 10)"/>
                                    </svg>
                                </li><li class="c-breadcrumbs__item" id="breadcrumb2" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                                    <span itemprop="name">article</span><meta itemprop="position" content="3"></li>
                </ol>
            </div>
        </nav>
    



    

</div>


<div class="u-container u-mt-32 u-mb-32 u-clearfix" id="content" data-component="article-container"  data-container-type="article">
    <main class="c-article-main-column u-float-left js-main-column" data-track-component="article body">
        
            <div class="c-context-bar u-hide" data-component="context-bar" aria-hidden="true">
                <div class="c-context-bar__container u-container">
                    <div class="c-context-bar__title">
                        Magnetic control of tokamak plasmas through deep reinforcement learning
                    </div>
                    
    
    <div class="c-pdf-download u-clear-both">
        <a href="/articles/s41586-021-04301-9.pdf" class="c-pdf-download__link" data-article-pdf="true" data-readcube-pdf-url="true" data-test="download-pdf" data-draft-ignore="true" data-track="click" data-track-action="download pdf" data-track-label="link" data-track-external>
            <span>Download PDF</span>
            <svg aria-hidden="true" focusable="false" width="16" height="16" class="u-icon"><use xlink:href="#global-icon-download"/></svg>
        </a>
    </div>
    

                </div>
            </div>
        
        <article lang="en">
            <div class="c-article-header">
                <header>
                    <ul class="c-article-identifiers" data-test="article-identifier">
                        
    
        <li class="c-article-identifiers__item" data-test="article-category">Article</li>
    
    
        <li class="c-article-identifiers__item">
            <span class="c-article-identifiers__open" data-test="open-access">Open Access</span>
        </li>
    
    

                        <li class="c-article-identifiers__item"><a href="#article-info" data-track="click" data-track-action="publication date" data-track-label="link">Published: <time datetime="2022-02-16">16 February 2022</time></a></li>
                    </ul>

                    <h1 class="c-article-title" data-test="article-title" data-article-title="">Magnetic control of tokamak plasmas through deep reinforcement learning</h1>
                    <ul class="c-article-author-list js-etal-collapsed" data-etal="25" data-etal-small="3" data-test="authors-list" data-component-authors-activator="authors-list"><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Jonas-Degrave" data-author-popup="auth-Jonas-Degrave">Jonas Degrave</a><span class="u-js-hide"> 
            <a class="js-orcid" href="http://orcid.org/0000-0002-2738-6500"><span class="u-visually-hidden">ORCID: </span>orcid.org/0000-0002-2738-6500</a></span><sup class="u-js-hide"><a href="#Aff1">1</a></sup><sup class="u-js-hide"> <a href="#na1">na1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Federico-Felici" data-author-popup="auth-Federico-Felici" data-corresp-id="c1">Federico Felici<svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-email"></use></svg></a><span class="u-js-hide"> 
            <a class="js-orcid" href="http://orcid.org/0000-0001-7585-376X"><span class="u-visually-hidden">ORCID: </span>orcid.org/0000-0001-7585-376X</a></span><sup class="u-js-hide"><a href="#Aff2">2</a></sup><sup class="u-js-hide"> <a href="#na1">na1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Jonas-Buchli" data-author-popup="auth-Jonas-Buchli" data-corresp-id="c2">Jonas Buchli<svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-email"></use></svg></a><sup class="u-js-hide"><a href="#Aff1">1</a></sup><sup class="u-js-hide"> <a href="#na1">na1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Michael-Neunert" data-author-popup="auth-Michael-Neunert">Michael Neunert</a><span class="u-js-hide"> 
            <a class="js-orcid" href="http://orcid.org/0000-0003-2080-8376"><span class="u-visually-hidden">ORCID: </span>orcid.org/0000-0003-2080-8376</a></span><sup class="u-js-hide"><a href="#Aff1">1</a></sup><sup class="u-js-hide"> <a href="#na1">na1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Brendan-Tracey" data-author-popup="auth-Brendan-Tracey" data-corresp-id="c3">Brendan Tracey<svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-email"></use></svg></a><span class="u-js-hide"> 
            <a class="js-orcid" href="http://orcid.org/0000-0001-5724-5912"><span class="u-visually-hidden">ORCID: </span>orcid.org/0000-0001-5724-5912</a></span><sup class="u-js-hide"><a href="#Aff1">1</a></sup><sup class="u-js-hide"> <a href="#na1">na1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Francesco-Carpanese" data-author-popup="auth-Francesco-Carpanese">Francesco Carpanese</a><sup class="u-js-hide"><a href="#Aff1">1</a>,<a href="#Aff2">2</a></sup><sup class="u-js-hide"> <a href="#na1">na1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Timo-Ewalds" data-author-popup="auth-Timo-Ewalds">Timo Ewalds</a><sup class="u-js-hide"><a href="#Aff1">1</a></sup><sup class="u-js-hide"> <a href="#na1">na1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Roland-Hafner" data-author-popup="auth-Roland-Hafner">Roland Hafner</a><span class="u-js-hide"> 
            <a class="js-orcid" href="http://orcid.org/0000-0001-8061-8828"><span class="u-visually-hidden">ORCID: </span>orcid.org/0000-0001-8061-8828</a></span><sup class="u-js-hide"><a href="#Aff1">1</a></sup><sup class="u-js-hide"> <a href="#na1">na1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Abbas-Abdolmaleki" data-author-popup="auth-Abbas-Abdolmaleki">Abbas Abdolmaleki</a><sup class="u-js-hide"><a href="#Aff1">1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Diego-de_las_Casas" data-author-popup="auth-Diego-de_las_Casas">Diego de las Casas</a><sup class="u-js-hide"><a href="#Aff1">1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Craig-Donner" data-author-popup="auth-Craig-Donner">Craig Donner</a><sup class="u-js-hide"><a href="#Aff1">1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Leslie-Fritz" data-author-popup="auth-Leslie-Fritz">Leslie Fritz</a><sup class="u-js-hide"><a href="#Aff1">1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Cristian-Galperti" data-author-popup="auth-Cristian-Galperti">Cristian Galperti</a><sup class="u-js-hide"><a href="#Aff2">2</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Andrea-Huber" data-author-popup="auth-Andrea-Huber">Andrea Huber</a><span class="u-js-hide"> 
            <a class="js-orcid" href="http://orcid.org/0000-0002-4431-8171"><span class="u-visually-hidden">ORCID: </span>orcid.org/0000-0002-4431-8171</a></span><sup class="u-js-hide"><a href="#Aff1">1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-James-Keeling" data-author-popup="auth-James-Keeling">James Keeling</a><sup class="u-js-hide"><a href="#Aff1">1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Maria-Tsimpoukelli" data-author-popup="auth-Maria-Tsimpoukelli">Maria Tsimpoukelli</a><sup class="u-js-hide"><a href="#Aff1">1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Jackie-Kay" data-author-popup="auth-Jackie-Kay">Jackie Kay</a><sup class="u-js-hide"><a href="#Aff1">1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Antoine-Merle" data-author-popup="auth-Antoine-Merle">Antoine Merle</a><sup class="u-js-hide"><a href="#Aff2">2</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Jean_Marc-Moret" data-author-popup="auth-Jean_Marc-Moret">Jean-Marc Moret</a><sup class="u-js-hide"><a href="#Aff2">2</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Seb-Noury" data-author-popup="auth-Seb-Noury">Seb Noury</a><sup class="u-js-hide"><a href="#Aff1">1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Federico-Pesamosca" data-author-popup="auth-Federico-Pesamosca">Federico Pesamosca</a><sup class="u-js-hide"><a href="#Aff2">2</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-David-Pfau" data-author-popup="auth-David-Pfau">David Pfau</a><sup class="u-js-hide"><a href="#Aff1">1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Olivier-Sauter" data-author-popup="auth-Olivier-Sauter">Olivier Sauter</a><sup class="u-js-hide"><a href="#Aff2">2</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Cristian-Sommariva" data-author-popup="auth-Cristian-Sommariva">Cristian Sommariva</a><sup class="u-js-hide"><a href="#Aff2">2</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Stefano-Coda" data-author-popup="auth-Stefano-Coda">Stefano Coda</a><sup class="u-js-hide"><a href="#Aff2">2</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Basil-Duval" data-author-popup="auth-Basil-Duval">Basil Duval</a><sup class="u-js-hide"><a href="#Aff2">2</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Ambrogio-Fasoli" data-author-popup="auth-Ambrogio-Fasoli">Ambrogio Fasoli</a><sup class="u-js-hide"><a href="#Aff2">2</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Pushmeet-Kohli" data-author-popup="auth-Pushmeet-Kohli">Pushmeet Kohli</a><sup class="u-js-hide"><a href="#Aff1">1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Koray-Kavukcuoglu" data-author-popup="auth-Koray-Kavukcuoglu">Koray Kavukcuoglu</a><sup class="u-js-hide"><a href="#Aff1">1</a></sup>, </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Demis-Hassabis" data-author-popup="auth-Demis-Hassabis">Demis Hassabis</a><span class="u-js-hide"> 
            <a class="js-orcid" href="http://orcid.org/0000-0003-2812-9917"><span class="u-visually-hidden">ORCID: </span>orcid.org/0000-0003-2812-9917</a></span><sup class="u-js-hide"><a href="#Aff1">1</a></sup> &amp; </li><li class="c-article-author-list__item"><a data-test="author-name" data-track="click" data-track-action="open author" data-track-label="link" href="#auth-Martin-Riedmiller" data-author-popup="auth-Martin-Riedmiller">Martin Riedmiller</a><span class="u-js-hide"> 
            <a class="js-orcid" href="http://orcid.org/0000-0002-8465-5690"><span class="u-visually-hidden">ORCID: </span>orcid.org/0000-0002-8465-5690</a></span><sup class="u-js-hide"><a href="#Aff1">1</a></sup><sup class="u-js-hide"> <a href="#na1">na1</a></sup> </li></ul>

                    

                    <p class="c-article-info-details" data-container-section="info">
                        
    <a data-test="journal-link" href="/"><i data-test="journal-title">Nature</i></a>

                        <b data-test="journal-volume"><span class="u-visually-hidden">volume</span> 602</b>, <span class="u-visually-hidden">pages </span>414–419 (<span data-test="article-publication-year">2022</span>)<a href="#citeas" class="c-article-info-details__cite-as u-hide-print" data-track="click" data-track-action="cite this article" data-track-label="link">Cite this article</a>
                    </p>
                    
    <div class="c-article-metrics-bar__wrapper u-clear-both">
        <ul class="c-article-metrics-bar u-list-reset">
            
                <li class=" c-article-metrics-bar__item">
                    <p class="c-article-metrics-bar__count">70k <span class="c-article-metrics-bar__label">Accesses</span></p>
                </li>
            
            
            
                
                    <li class="c-article-metrics-bar__item">
                        <p class="c-article-metrics-bar__count">2089 <span class="c-article-metrics-bar__label">Altmetric</span></p>
                    </li>
                
            
            <li class="c-article-metrics-bar__item">
                <p class="c-article-metrics-bar__details"><a href="/articles/s41586-021-04301-9/metrics" data-track="click" data-track-action="view metrics" data-track-label="link" rel="nofollow">Metrics <span class="u-visually-hidden">details</span></a></p>
            </li>
        </ul>
    </div>

                    
                </header>

                
    <div class="u-js-hide" data-component="article-subject-links">
        <h3 class="c-article__sub-heading">Subjects</h3>
        <ul class="c-article-subject-list">
            <li class="c-article-subject-list__subject"><a href="/subjects/computer-science" data-track="click" data-track-action="view subject" data-track-label="link">Computer science</a></li><li class="c-article-subject-list__subject"><a href="/subjects/magnetically-confined-plasmas" data-track="click" data-track-action="view subject" data-track-label="link">Magnetically confined plasmas</a></li><li class="c-article-subject-list__subject"><a href="/subjects/nuclear-fusion-and-fission" data-track="click" data-track-action="view subject" data-track-label="link">Nuclear fusion and fission</a></li>
        </ul>
    </div>

                
    

    

                
            </div>

        <div class="c-article-body">
            <section aria-labelledby="Abs1" data-title="Abstract" lang="en"><div class="c-article-section" id="Abs1-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="Abs1">Abstract</h2><div class="c-article-section__content" id="Abs1-content"><p>Nuclear fusion using magnetic confinement, in particular in the tokamak configuration, is a promising path towards sustainable energy. A core challenge is to shape and maintain a high-temperature plasma within the tokamak vessel. This requires high-dimensional, high-frequency, closed-loop control using magnetic actuator coils, further complicated by the diverse requirements across a wide range of plasma configurations. In this work, we introduce a previously undescribed architecture for tokamak magnetic controller design that autonomously learns to command the full set of control coils. This architecture meets control objectives specified at a high level, at the same time satisfying physical and operational constraints. This approach has unprecedented flexibility and generality in problem specification and yields a notable reduction in design effort to produce new plasma configurations. We successfully produce and control a diverse set of plasma configurations on the Tokamak à Configuration Variable<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 1" title="Hofmann, F. et al. Creation and control of variably shaped plasmas in TCV. Plasma Phys. Control. Fusion 36, B277 (1994)." href="/articles/s41586-021-04301-9#ref-CR1" id="ref-link-section-d263546778e653">1</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 2" title="Coda, S. et al. Physics research on the TCV tokamak facility: from conventional to alternative scenarios and beyond. Nucl. Fusion 59, 112023 (2019)." href="/articles/s41586-021-04301-9#ref-CR2" id="ref-link-section-d263546778e656">2</a></sup>, including elongated, conventional shapes, as well as advanced configurations, such as negative triangularity and ‘snowflake’ configurations. Our approach achieves accurate tracking of the location, current and shape for these configurations. We also demonstrate sustained ‘droplets’ on TCV, in which two separate plasmas are maintained simultaneously within the vessel. This represents a notable advance for tokamak feedback control, showing the potential of reinforcement learning to accelerate research in the fusion domain, and is one of the most challenging real-world systems to which reinforcement learning has been applied.</p></div></div></section>
            <noscript>
                
            </noscript>

            
                <div class="c-pdf-button__container">
                    
                        
    
    <div class="c-pdf-download u-clear-both">
        <a href="/articles/s41586-021-04301-9.pdf" class="c-pdf-download__link" data-article-pdf="true" data-readcube-pdf-url="true" data-test="download-pdf" data-draft-ignore="true" data-track="click" data-track-action="download pdf" data-track-label="link" data-track-external>
            <span>Download PDF</span>
            <svg aria-hidden="true" focusable="false" width="16" height="16" class="u-icon"><use xlink:href="#global-icon-download"/></svg>
        </a>
    </div>
    

                    
                </div>
            
            
                <section data-title="Main"><div class="c-article-section" id="Sec1-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="Sec1">Main</h2><div class="c-article-section__content" id="Sec1-content"><p>Tokamaks are torus-shaped devices for nuclear fusion research and are a leading candidate for the generation of sustainable electric power. A main direction of research is to study the effects of shaping the distribution of the plasma into different configurations<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="Anand, H., Coda, S., Felici, F., Galperti, C. &amp; Moret, J.-M. A novel plasma position and shape controller for advanced configuration development on the TCV tokamak. Nucl. Fusion 57, 126026 (2017)." href="#ref-CR3" id="ref-link-section-d263546778e682">3</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="Mele, A. et al. MIMO shape control at the EAST tokamak: simulations and experiments. Fusion Eng. Des. 146, 1282–1285 (2019)." href="#ref-CR4" id="ref-link-section-d263546778e682_1">4</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 5" title="Anand, H. et al. Plasma flux expansion control on the DIII-D tokamak. Plasma Phys. Control. Fusion 63, 015006 (2020)." href="/articles/s41586-021-04301-9#ref-CR5" id="ref-link-section-d263546778e685">5</a></sup> to optimize the stability, confinement and energy exhaust, and, in particular, to inform the first burning-plasma experiment, ITER. Confining each configuration within the tokamak requires designing a feedback controller that can manipulate the magnetic field<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 6" title="De Tommasi, G. Plasma magnetic control in tokamak devices. J. Fusion Energy 38, 406–436 (2019)." href="/articles/s41586-021-04301-9#ref-CR6" id="ref-link-section-d263546778e689">6</a></sup> through precise control of several coils that are magnetically coupled to the plasma to achieve the desired plasma current, position and shape, a problem known as the tokamak magnetic control problem.</p><p>The conventional approach to this time-varying, non-linear, multivariate control problem is to first solve an inverse problem to precompute a set of feedforward coil currents and voltages<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 7" title="Walker, M. L. &amp; Humphreys, D. A. Valid coordinate systems for linearized plasma shape response models in tokamaks. Fusion Sci. Technol. 50, 473–489 (2006)." href="/articles/s41586-021-04301-9#ref-CR7" id="ref-link-section-d263546778e696">7</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 8" title="Blum, J., Heumann, H., Nardon, E. &amp; Song, X. Automating the design of tokamak experiment scenarios. J. Comput. Phys. 394, 594–614 (2019)." href="/articles/s41586-021-04301-9#ref-CR8" id="ref-link-section-d263546778e699">8</a></sup>. Then, a set of independent, single-input single-output PID controllers is designed to stabilize the plasma vertical position and control the radial position and plasma current, all of which must be designed to not mutually interfere<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 6" title="De Tommasi, G. Plasma magnetic control in tokamak devices. J. Fusion Energy 38, 406–436 (2019)." href="/articles/s41586-021-04301-9#ref-CR6" id="ref-link-section-d263546778e703">6</a></sup>. Most control architectures are further augmented by an outer control loop for the plasma shape, which involves implementing a real-time estimate of the plasma equilibrium<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 9" title="Ferron, J. R. et al. Real time equilibrium reconstruction for tokamak discharge control. Nucl. Fusion 38, 1055 (1998)." href="/articles/s41586-021-04301-9#ref-CR9" id="ref-link-section-d263546778e707">9</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 10" title="Moret, J.-M. et al. Tokamak equilibrium reconstruction code LIUQE and its real time implementation. Fusion Eng. Des. 91, 1–15 (2015)." href="/articles/s41586-021-04301-9#ref-CR10" id="ref-link-section-d263546778e710">10</a></sup> to modulate the feedforward coil currents<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 8" title="Blum, J., Heumann, H., Nardon, E. &amp; Song, X. Automating the design of tokamak experiment scenarios. J. Comput. Phys. 394, 594–614 (2019)." href="/articles/s41586-021-04301-9#ref-CR8" id="ref-link-section-d263546778e714">8</a></sup>. The controllers are designed on the basis of linearized model dynamics, and gain scheduling is required to track time-varying control targets. Although these controllers are usually effective, they require substantial engineering effort, design effort and expertise whenever the target plasma configuration is changed, together with complex, real-time calculations for equilibrium estimation.</p><p>A radically new approach to controller design is made possible by using reinforcement learning (RL) to generate non-linear feedback controllers. The RL approach, already used successfully in several challenging applications in other domains<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="Xie, Z., Berseth, G., Clary, P., Hurst, J. &amp; van de Panne, M. Feedback control for Cassie with deep reinforcement learning. In 2018 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS) 1241–1246 (IEEE, 2018)." href="#ref-CR11" id="ref-link-section-d263546778e721">11</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="Akkaya, I. et al. Solving Rubik’s cube with a robot hand. Preprint at 
                  https://arxiv.org/abs/1910.07113
                  
                 (2019)." href="#ref-CR12" id="ref-link-section-d263546778e721_1">12</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 13" title="Bellemare, M. G. et al. Autonomous navigation of stratospheric balloons using reinforcement learning. Nature 588, 77–82 (2020)." href="/articles/s41586-021-04301-9#ref-CR13" id="ref-link-section-d263546778e724">13</a></sup>, enables intuitive setting of performance objectives, shifting the focus towards what should be achieved, rather than how. Furthermore, RL greatly simplifies the control system. A single computationally inexpensive controller replaces the nested control architecture, and an internalized state reconstruction removes the requirement for independent equilibrium reconstruction. These combined benefits reduce the controller&nbsp;development cycle and accelerate the study of alternative plasma configurations. Indeed, artificial intelligence has recently been identified as a ‘Priority Research Opportunity’ for fusion control<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 14" title="Humphreys, D. et al. Advancing fusion with machine learning research needs workshop report. J. Fusion Energy 39, 123–155 (2020)." href="/articles/s41586-021-04301-9#ref-CR14" id="ref-link-section-d263546778e728">14</a></sup>, building on demonstrated successes in reconstructing plasma-shape parameters<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 15" title="Bishop, C. M., Haynes, P. S., Smith, M. E., Todd, T. N. &amp; Trotman, D. L. Real time control of a tokamak plasma using neural networks. Neural Comput. 7, 206–217 (1995)." href="/articles/s41586-021-04301-9#ref-CR15" id="ref-link-section-d263546778e732">15</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 16" title="Joung, S. et al. Deep neural network Grad-Shafranov solver constrained with measured magnetic signals. Nucl. Fusion 60, 16034 (2019)." href="/articles/s41586-021-04301-9#ref-CR16" id="ref-link-section-d263546778e735">16</a></sup>, accelerating simulations using surrogate models<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 17" title="van de Plassche, K. L. et al. Fast modeling of turbulent transport in fusion plasmas using neural networks. Phys. Plasmas 27, 022310 (2020)." href="/articles/s41586-021-04301-9#ref-CR17" id="ref-link-section-d263546778e739">17</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 18" title="Abbate, J., Conlin, R. &amp; Kolemen, E. Data-driven profile prediction for DIII-D. Nucl. Fusion 61, 046027 (2021)." href="/articles/s41586-021-04301-9#ref-CR18" id="ref-link-section-d263546778e742">18</a></sup> and detecting impending plasma disruptions<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 19" title="Kates-Harbeck, J., Svyatkovskiy, A. &amp; Tang, W. Predicting disruptive instabilities in controlled fusion plasmas through deep learning. Nature 568, 526–531 (2019)." href="/articles/s41586-021-04301-9#ref-CR19" id="ref-link-section-d263546778e746">19</a></sup>. RL has not, however, been used for magnetic controller design, which is challenging due to high-dimensional measurements and actuation, long time horizons, rapid instability growth rates and the need to infer the plasma shape through indirect measurements.</p><p>In this work, we present an RL-designed magnetic controller and experimentally verify its performance on a tokamak. The control policies are learned through interaction with a tokamak simulator and are shown to be directly capable of tokamak magnetic control on hardware, successfully bridging the ‘sim-to-real’ gap. This enables a fundamental shift from engineering-driven control of a pre-designed state to artificial-intelligence-driven optimization of objectives specified by an operator. We demonstrate the effectiveness of our controllers in experiments carried out on the Tokamak à Configuration Variable (TCV)<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 1" title="Hofmann, F. et al. Creation and control of variably shaped plasmas in TCV. Plasma Phys. Control. Fusion 36, B277 (1994)." href="/articles/s41586-021-04301-9#ref-CR1" id="ref-link-section-d263546778e753">1</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 2" title="Coda, S. et al. Physics research on the TCV tokamak facility: from conventional to alternative scenarios and beyond. Nucl. Fusion 59, 112023 (2019)." href="/articles/s41586-021-04301-9#ref-CR2" id="ref-link-section-d263546778e756">2</a></sup>, in which we demonstrate control of a variety of plasma shapes, including elongated ones, such as those foreseen in ITER, as well as advanced configurations, such as negative triangularity and ‘snowflake’ plasmas. Additionally, we demonstrate a sustained configuration in which two separate plasma ‘droplets’ are simultaneously maintained within the vessel. Tokamak magnetic control is one of the most complex real-world systems to which RL has been applied. This is a promising new direction for plasma controller design, with the potential to accelerate fusion science, explore new configurations and aid in future tokamak development.</p></div></div></section><section data-title="Learning control and training architecture"><div class="c-article-section" id="Sec2-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="Sec2">Learning control and training architecture</h2><div class="c-article-section__content" id="Sec2-content"><p>Our architecture, depicted in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig1">1</a>, is a flexible approach for designing tokamak magnetic confinement controllers. The approach has three main phases. First, a designer specifies objectives for the experiment, potentially accompanied by time-varying control targets. Second, a deep RL algorithm interacts with a tokamak simulator to find a near-optimal control policy to meet the specified goals. Third, the control policy, represented as a neural network, is run directly (‘zero shot’) on tokamak hardware in real time.</p><div class="c-article-section__figure js-c-reading-companion-figures-item" data-test="figure" data-container-section="figure" id="figure-1" data-title="Representation of the components of our controller design architecture."><figure><figcaption><b id="Fig1" class="c-article-section__figure-caption" data-test="figure-caption-text">Fig. 1: Representation of the components of our controller design architecture.</b></figcaption><div class="c-article-section__figure-content"><div class="c-article-section__figure-item"><a class="c-article-section__figure-link" data-test="img-link" data-track="click" data-track-label="image" data-track-action="view figure" href="/articles/s41586-021-04301-9/figures/1" rel="nofollow"><picture><source type="image/webp" srcset="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig1_HTML.png?as=webp"><img aria-describedby="Fig1" src="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig1_HTML.png" alt="figure 1" loading="lazy" width="685" height="386"></picture></a></div><div class="c-article-section__figure-description" data-test="bottom-caption" id="figure-1-desc"><p><b>a</b>, Depiction of the learning loop. The controller sends voltage commands on the basis of the current plasma state and control targets. These data are sent to the replay buffer, which feeds data to the learner to update the policy. <b>b</b>, Our environment interaction loop, consisting of a power supply model, sensing model, environment physical parameter variation and reward computation. <b>c</b>, Our control policy is an MLP with three hidden layers that takes measurements and control targets and outputs voltage commands. <b>d</b>–<b>f</b>, The interaction of TCV and the real-time-deployed control system implemented using either a conventional controller composed of many subcomponents (<b>f</b>) or our architecture using a single deep neural network to control all 19 coils directly (<b>e</b>). <b>g</b>, A depiction of TCV and the 19 actuated coils. The vessel is 1.5 m high, with minor radius 0.88 m and&nbsp;vessel half-width 0.26 m. <b>j</b>, A cross section of the vessel and plasma, with the important aspects labelled.</p></div></div><div class="u-text-right u-hide-print"><a class="c-article__pill-button" data-test="article-link" data-track="click" data-track-label="button" data-track-action="view figure" href="/articles/s41586-021-04301-9/figures/1" data-track-dest="link:Figure1 Full size image" aria-label="Full size image figure 1" rel="nofollow"><span>Full size image</span><svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-chevron-right"></use></svg></a></div></figure></div><p>In the first phase, the experimental goal is specified by a set of objectives that can contain a wide variety of desired properties (Extended Data Table <a data-track="click" data-track-label="link" data-track-action="table anchor" href="/articles/s41586-021-04301-9#Tab4">4</a>). These properties range from basic stabilization of position and plasma current to sophisticated combinations of several time-varying targets, including a precise shape outline with specified elongation, triangularity and X-point location. These objectives are then combined into a ‘reward function’ that assigns a scalar quality measure to the state at each time step. This function also penalizes the control policy for reaching undesired terminal states, as discussed below. Crucially, a well-designed reward function will be minimally specified, giving the learning algorithm maximum flexibility to attain the desired outcome.</p><p>In the second phase, a high-performance RL algorithm collects data and finds a control policy through interaction with an environment, as depicted in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig1">1a, b</a>. We use a simulator that has enough physical fidelity to describe the evolution of plasma shape and current, while remaining sufficiently computationally cheap for learning. Specifically, we model the dynamics governing the evolution of the plasma state under the influence of the poloidal field coil voltages using a free-boundary plasma-evolution model<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 20" title="Jardin, S. Computational Methods in Plasma Physics (CRC Press, 2010)." href="/articles/s41586-021-04301-9#ref-CR20" id="ref-link-section-d263546778e830">20</a></sup>. In this model, the currents in the coils and passive conductors evolve under the influence of externally applied voltages from the power supplies, as well as induced voltages from time-varying currents in other conductors and in the plasma itself. The plasma is, in turn, modelled by the Grad–Shafranov equation<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 21" title="Grad, H. &amp; Rubin, H. Hydromagnetic equilibria and force-free fields. J. Nucl. Energy (1954) 7, 284–285 (1958)." href="/articles/s41586-021-04301-9#ref-CR21" id="ref-link-section-d263546778e834">21</a></sup>, which results from the balance between the Lorentz force and the pressure gradient inside the plasma on the timescales of interest. The evolution of total plasma current <i>I</i><sub>p</sub> is modelled using a lumped-circuit equation. This set of equations is solved numerically by the FGE software package<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 22" title="Carpanese, F. Development of Free-boundary Equilibrium and Transport Solvers for Simulation and Real-time Interpretation of Tokamak Experiments. PhD thesis, EPFL (2021)." href="/articles/s41586-021-04301-9#ref-CR22" id="ref-link-section-d263546778e842">22</a></sup>.</p><p>The RL algorithm uses the collected simulator data to find a near-optimal policy with respect to the specified reward function. The data rate of our simulator is markedly slower than that of a typical RL environment due to the computational requirements of evolving the plasma state. We overcome the paucity of data by optimizing the policy using maximum a posteriori policy optimization (MPO)<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 23" title="Abdolmaleki, A. et al. Relative entropy regularized policy iteration. Preprint at 
                  https://arxiv.org/abs/1812.02256
                  
                 (2018)." href="/articles/s41586-021-04301-9#ref-CR23" id="ref-link-section-d263546778e849">23</a></sup>, an actor-critic algorithm. MPO supports data collection across distributed parallel streams and learns in a data-efficient way. We additionally exploit the asymmetry inherent to the actor-critic design of MPO to overcome the constraints of magnetic control. In actor-critic algorithms, the ‘critic’ learns the discounted expected future reward for various actions using the available data and the ‘actor’ uses the predictions of the critic to set the control policy. The representation of the control policy of the actor is restricted, as it must run on TCV with real-time guarantees, whereas the critic is unrestricted, as it is only used during training. We therefore use a fast, four-layer feedforward neural network in the actor (Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig1">1c</a>) and a much larger recurrent neural network in the critic. This asymmetry enables the critic to infer the underlying state from measurements, deal with complex state-transition dynamics over different timescales and assess the influence of system measurement and action delays. The information from the coupled dynamics is then distilled into a real-time-capable controller.</p><p>In the third phase, the control policy is bundled with the associated experiment control targets into an executable using a compiler tailored towards real-time control at 10 kHz that minimizes dependencies and eliminates unnecessary computations. This executable is loaded by the TCV control framework<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 24" title="Paley, J. I., Coda, S., Duval, B., Felici, F. &amp; Moret, J.-M. Architecture and commissioning of the TCV distributed feedback control system. In 2010 17th IEEE-NPSS Real Time Conference 1–6 (IEEE, 2010)." href="/articles/s41586-021-04301-9#ref-CR24" id="ref-link-section-d263546778e860">24</a></sup> (Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig1">1d</a>). Each experiment begins with standard plasma-formation procedures, in which a traditional controller maintains the location of the plasma and total current. At a prespecified time, termed the ‘handover’, control is switched to our control policy, which then actuates the 19 TCV control coils to transform the plasma shape and current to the desired targets. Experiments are executed without further tuning of the control-policy network weights after training, in other words, there is ‘zero-shot’ transfer from simulation to hardware.</p><p>The control policies reliably transfer onto TCV through several key attributes of the learning procedure, depicted in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig1">1b</a>. We identified an actuator and sensor model that incorporates properties affecting control stability, such as delays, measurement noise and control-voltage offsets. We applied targeted parameter variation during training across an appropriate range for the plasma pressure, current density profile and plasma resistivity through analysis of experiment data, to account for varying, uncontrolled experimental conditions. This provides robustness while ensuring performance. Although the simulator is generally accurate, there are known regions where the dynamics are known to be poorly represented. We built ‘learned-region avoidance’ into the training loop to avoid these regimes through the use of rewards and termination conditions (Extended Data Table <a data-track="click" data-track-label="link" data-track-action="table anchor" href="/articles/s41586-021-04301-9#Tab5">5</a>), which halt the simulation when specified conditions are encountered. Termination conditions are also used to enforce operational limits. The control policies learn to stay within the specified limits, for example, on maximum coil current or the edge safety factor<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 25" title="Freidberg, J. P. Plasma Physics and Fusion Energy (Cambridge Univ. Press, 2008)." href="/articles/s41586-021-04301-9#ref-CR25" id="ref-link-section-d263546778e876">25</a></sup>.</p><p>The controllers designed by our architecture are greatly structurally simplified compared with conventional designs, as depicted in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig1">1e, f</a>. Instead of a series of controllers, RL-driven design creates a single network controller.</p></div></div></section><section data-title="Fundamental capability demonstration"><div class="c-article-section" id="Sec3-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="Sec3">Fundamental capability demonstration</h2><div class="c-article-section__content" id="Sec3-content"><p>We demonstrate the capability of our architecture on control targets in real-world experiments on TCV. We first show accurate control of the fundamental qualities of plasma equilibria. We then control a wide range of equilibria with complex, time-varying objectives and physically relevant plasma configurations. Finally, we demonstrate control of a configuration with several plasma ‘droplets’ in the vessel simultaneously.</p><p>We first test the fundamental tasks of plasma control through a series of changes representative of those required for a full plasma discharge. First, from the handover at 0.0872 s, take&nbsp;over and stabilize <i>I</i><sub>p</sub> at −110 kA. Next, ramp the plasma current to −150 kA and then elongate the plasma from 1.24 to 1.44, thereby increasing the vertical instability growth rate to 150 Hz. Next, demonstrate position control through shifting the vertical plasma position by 10 cm and then divert the plasma with control of the active X-point location (see Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig1">1h</a>). Finally, return the plasma to the handover condition and ramp down <i>I</i><sub>p</sub> to −70 kA to shut down safely. Although accuracy requirements will generally depend on the exact experiment, a reasonable aim is to control <i>I</i><sub>p</sub> to within 5 kA (3% of the final 150-kA target) and the shape to within 2 cm (8% of the vessel radial half width of 26 cm). Note that the equilibrium reconstruction used matches a visually reconstructed boundary with a typical accuracy<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 26" title="Hommen, G. D. et al. Real-time optical plasma boundary reconstruction for plasma position control at the TCV Tokamak. Nucl. Fusion 54, 073018 (2014)." href="/articles/s41586-021-04301-9#ref-CR26" id="ref-link-section-d263546778e913">26</a></sup> of 1 cm.</p><p>The performance of the control policy is depicted in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig2">2</a>. All tasks are performed successfully, with a tracking accuracy below the desired thresholds. In the initial limited phase (0.1 s to 0.45 s), the <i>I</i><sub>p</sub> root-mean-square error (RMSE) is 0.71 kA (0.59% of the target) and the shape RMSE is 0.78 cm (3% of the vessel half width). In the diverted phase (0.55 s to 0.8 s), the <i>I</i><sub>p</sub> and shape RMSE are 0.28 kA and 0.53 cm,respectively (0.2% and 2.1%), yielding RMSE across the full window (0.1 s to 1.0 s) of 0.62 kA and 0.75 cm (0.47% and 2.9%). This demonstrates that our RL architecture is capable of accurate plasma control across all relevant phases of a discharge experiment.</p><div class="c-article-section__figure js-c-reading-companion-figures-item" data-test="figure" data-container-section="figure" id="figure-2" data-title="Fundamental capability demonstration."><figure><figcaption><b id="Fig2" class="c-article-section__figure-caption" data-test="figure-caption-text">Fig. 2: Fundamental capability demonstration.</b></figcaption><div class="c-article-section__figure-content"><div class="c-article-section__figure-item"><a class="c-article-section__figure-link" data-test="img-link" data-track="click" data-track-label="image" data-track-action="view figure" href="/articles/s41586-021-04301-9/figures/2" rel="nofollow"><picture><source type="image/webp" srcset="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig2_HTML.png?as=webp"><img aria-describedby="Fig2" src="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig2_HTML.png" alt="figure 2" loading="lazy" width="685" height="371"></picture></a></div><div class="c-article-section__figure-description" data-test="bottom-caption" id="figure-2-desc"><p>Demonstration of plasma current, vertical stability, position and shape control. Top, target shape points with 2 cm radius&nbsp;(blue circles),&nbsp;compared with the post-experiment equilibrium reconstruction (black continuous line in contour plot). Bottom left, target time traces (blue traces) compared with reconstructed observation (orange traces),&nbsp;with the window of diverted plasma marked (green rectangle). Bottom right, picture inside the vessel at 0.6 s showing the diverted plasma with its legs.</p><p><a data-track="click" data-track-label="link" data-track-action="supplementary material anchor" href="/articles/s41586-021-04301-9#MOESM3">Source data</a></p></div></div><div class="u-text-right u-hide-print"><a class="c-article__pill-button" data-test="article-link" data-track="click" data-track-label="button" data-track-action="view figure" href="/articles/s41586-021-04301-9/figures/2" data-track-dest="link:Figure2 Full size image" aria-label="Full size image figure 2" rel="nofollow"><span>Full size image</span><svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-chevron-right"></use></svg></a></div></figure></div></div></div></section><section data-title="Control demonstrations"><div class="c-article-section" id="Sec4-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="Sec4">Control demonstrations</h2><div class="c-article-section__content" id="Sec4-content"><p>We next demonstrate the capability of our architecture to produce complex configurations for scientific study. Each demonstration has its own time-varying targets but, otherwise, uses the same architectural setup to generate a control policy, including the training and environment configuration, with only minor adjustments to the reward function (shown in Extended Data Table <a data-track="click" data-track-label="link" data-track-action="table anchor" href="/articles/s41586-021-04301-9#Tab3">3</a>). Recall that, in each experiment, the plasma has low elongation before the handover, and the control policy actively modulates the plasma to the configuration of interest. Selected time slices from these experiments are shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig3">3</a>, with further detail in Extended Data Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig5">1</a> and error metrics in Extended Data Table <a data-track="click" data-track-label="link" data-track-action="table anchor" href="/articles/s41586-021-04301-9#Tab1">1</a>.</p><div class="c-article-section__figure js-c-reading-companion-figures-item" data-test="figure" data-container-section="figure" id="figure-3" data-title="Control demonstrations."><figure><figcaption><b id="Fig3" class="c-article-section__figure-caption" data-test="figure-caption-text">Fig. 3: Control demonstrations.</b></figcaption><div class="c-article-section__figure-content"><div class="c-article-section__figure-item"><a class="c-article-section__figure-link" data-test="img-link" data-track="click" data-track-label="image" data-track-action="view figure" href="/articles/s41586-021-04301-9/figures/3" rel="nofollow"><picture><source type="image/webp" srcset="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig3_HTML.png?as=webp"><img aria-describedby="Fig3" src="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig3_HTML.png" alt="figure 3" loading="lazy" width="685" height="438"></picture></a></div><div class="c-article-section__figure-description" data-test="bottom-caption" id="figure-3-desc"><p>Control demonstrations obtained during TCV experiments. Target shape points with 2 cm radius&nbsp;(blue circles), compared with the equilibrium reconstruction plasma boundary (black continuous line). In all figures, the first time slice shows the handover condition. <b>a</b>, Elongation of 1.9 with vertical instability growth rate of 1.4 kHz. <b>b</b>, Approximate ITER-proposed shape with neutral beam heating (NBH) entering H-mode. <b>c</b>, Diverted negative triangularity of −0.8. <b>d</b>, Snowflake configuration with a time-varying control of the bottom X-point, where the target X-points are&nbsp;marked in blue. Extended traces for these shots can be found in Extended Data&nbsp;Fig.&nbsp;2.</p><p><a data-track="click" data-track-label="link" data-track-action="supplementary material anchor" href="/articles/s41586-021-04301-9#MOESM4">Source data</a></p></div></div><div class="u-text-right u-hide-print"><a class="c-article__pill-button" data-test="article-link" data-track="click" data-track-label="button" data-track-action="view figure" href="/articles/s41586-021-04301-9/figures/3" data-track-dest="link:Figure3 Full size image" aria-label="Full size image figure 3" rel="nofollow"><span>Full size image</span><svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-chevron-right"></use></svg></a></div></figure></div><p>Elongating plasmas improves their thermal&nbsp;confinement properties, but their increased vertical-instability growth rate complicates control. We targeted a high elongation of 1.9 with a considerable growth rate. The controller was able to produce and stabilize this elongation, as shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig3">3a</a>. We obtained a good match between the targeted and the desired elongation, with an RMSE of 0.018. We also controlled shape and plasma current to their target values, with an <i>I</i><sub>p</sub> RMSE of 1.2 kA and shape RMSE of 1.6 cm. This demonstrates the capability to stabilize a high vertical-instability growth rate of more than 1.4 kHz, despite acting at only 10 kHz.</p><p>We next tested applying auxiliary heating through neutral beam injection to enter ‘H-mode’, which is desirable for having higher energy confinement time, but causes notable changes to the plasma properties. We were provided a time-varying trajectory on the basis of the proposed ITER configuration that uses such auxiliary heating. As the normalized pressure <i>β</i><sub>p</sub> increases to 1.12, seen in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig3">3b</a>, the plasma position and current were maintained accurately, with an <i>I</i><sub>p</sub> RMSE of 2.6 kA and shape RMSE of 1.4 cm. This shows that our controller can robustly adapt to a changing plasma state and can work with heated H-mode plasma under externally specified configurations.</p><p>Negative triangularity plasmas are attractive as they have favourable confinement properties without the strong edge pressure gradient typical of H-modes. We targeted a diverted configuration with triangularity of −0.8, and with X-points at both corners. We successfully achieved this configuration, shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig3">3c</a>. The triangularity was accurately matched, with an RMSE of 0.070, as were the plasma current and shape, with RMSE values of 3.5 kA and 1.3 cm, respectively. This demonstrates the ability to rapidly and directly create a configuration under active study<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 27" title="Austin, M. E. et al. Achievement of reactor-relevant performance in negative triangularity shape in the DIII-D tokamak. Phys. Rev. Lett. 122, 115001 (2019)." href="/articles/s41586-021-04301-9#ref-CR27" id="ref-link-section-d263546778e1040">27</a></sup>.</p><p>Snowflake configurations are researched<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 28" title="Kolemen, E. et al. Initial development of the DIII–D snowflake divertor control. Nucl. Fusion 58, 066007 (2018)." href="/articles/s41586-021-04301-9#ref-CR28" id="ref-link-section-d263546778e1048">28</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 29" title="Anand, H. et al. Real time magnetic control of the snowflake plasma configuration in the TCV tokamak. Nucl. Fusion 59, 126032 (2019)." href="/articles/s41586-021-04301-9#ref-CR29" id="ref-link-section-d263546778e1051">29</a></sup>, as they distribute the particle exhaust across several strike points. A crucial parameter is the distance between the two X-points that form the divertor legs. We demonstrated our ability to control this distance, shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig3">3d</a>. The control policy first established a snowflake configuration with X-points separated by 34 cm. It then manipulated the far X-point to approach the limiting X-point, ending with a separation of 6.6 cm. The time-varying X-point targets were tracked with a combined RMSE of 3.7 cm. The plasma current and shape were maintained to high accuracy during this transition, with RMSE values of 0.50 kA and 0.65 cm, respectively. This demonstrates accurate control of a complex time-varying target with several coupled objectives.</p><p>In aggregate, these experiments demonstrate the ease with which new configurations can be explored, prove the ability of our architecture to operate in high-performance discharges and confirm the breadth of its capability. In the&nbsp;<a data-track="click" data-track-label="link" data-track-action="section anchor" href="/articles/s41586-021-04301-9#Sec7">Methods</a> section, we further investigate the control-policy behaviours.</p></div></div></section><section data-title="New multi-domain plasma demonstration"><div class="c-article-section" id="Sec5-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="Sec5">New multi-domain plasma demonstration</h2><div class="c-article-section__content" id="Sec5-content"><p>Lastly, we demonstrate the power of our architecture to explore new plasma configurations. We test control of ‘droplets’, a configuration in which two separate plasmas exist within the vessel simultaneously. It is probably possible that existing approaches could stabilize such droplets. Nonetheless, great investment would be required to develop feedforward coil-current programming, implement real-time estimators, tune controller gains and successfully take control after plasma creation. By contrast, with our approach, we simply adjust the simulated handover state to account for the different handover condition from single-axis plasmas and define a reward function to keep the position of each droplet component steady while ramping up the domain plasma currents. This loose specification gives the architecture the freedom to choose how to best adapt the droplet shapes as <i>I</i><sub>p</sub> increases to maintain stability. The architecture was able to successfully stabilize droplets over the entire 200&nbsp;ms control window and ramp the current within each domain, as shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig4">4</a>. This highlights the advantage of a general, learning-based control architecture to adapt control for previously unknown configurations.</p><div class="c-article-section__figure js-c-reading-companion-figures-item" data-test="figure" data-container-section="figure" id="figure-4" data-title="Droplets."><figure><figcaption><b id="Fig4" class="c-article-section__figure-caption" data-test="figure-caption-text">Fig. 4: Droplets.</b></figcaption><div class="c-article-section__figure-content"><div class="c-article-section__figure-item"><a class="c-article-section__figure-link" data-test="img-link" data-track="click" data-track-label="image" data-track-action="view figure" href="/articles/s41586-021-04301-9/figures/4" rel="nofollow"><picture><source type="image/webp" srcset="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig4_HTML.png?as=webp"><img aria-describedby="Fig4" src="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig4_HTML.png" alt="figure 4" loading="lazy" width="685" height="378"></picture></a></div><div class="c-article-section__figure-description" data-test="bottom-caption" id="figure-4-desc"><p>Demonstration of sustained control of two independent droplets on TCV for the entire 200-ms control window. Left, control of <i>I</i><sub>p</sub> for each independent lobe up to the same target value. Right, a picture in which the two droplets are visible, taken from a camera looking into the vessel at <i>t</i> = 0.55.</p><p><a data-track="click" data-track-label="link" data-track-action="supplementary material anchor" href="/articles/s41586-021-04301-9#MOESM5">Source data</a></p></div></div><div class="u-text-right u-hide-print"><a class="c-article__pill-button" data-test="article-link" data-track="click" data-track-label="button" data-track-action="view figure" href="/articles/s41586-021-04301-9/figures/4" data-track-dest="link:Figure4 Full size image" aria-label="Full size image figure 4" rel="nofollow"><span>Full size image</span><svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-chevron-right"></use></svg></a></div></figure></div></div></div></section><section data-title="Discussion"><div class="c-article-section" id="Sec6-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="Sec6">Discussion</h2><div class="c-article-section__content" id="Sec6-content"><p>We present a new paradigm for plasma magnetic confinement on tokamaks. Our control design fulfils many of the hopes of the community for a machine-learning-based control approach<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 14" title="Humphreys, D. et al. Advancing fusion with machine learning research needs workshop report. J. Fusion Energy 39, 123–155 (2020)." href="/articles/s41586-021-04301-9#ref-CR14" id="ref-link-section-d263546778e1119">14</a></sup>, including high performance, robustness to uncertain operating conditions, intuitive target specification and unprecedented versatility. This achievement required overcoming gaps in capability and infrastructure through scientific and engineering advances: an accurate, numerically robust simulator; an informed trade-off between simulation accuracy and computational complexity; a sensor and actuator model tuned to specific hardware control; realistic variation of operating conditions during training; a highly data-efficient RL algorithm that scales to high-dimensional problems; an asymmetric learning setup with an expressive critic but fast-to-evaluate policy; a process for compiling neural networks into real-time-capable code and deployment on a tokamak digital control system. This resulted in successful hardware experiments that demonstrate fundamental capability alongside advanced shape control without requiring fine-tuning on the plant. It additionally shows that a free-boundary equilibrium evolution model has sufficient fidelity to develop transferable controllers, offering a justification for using this approach to test control of future devices.</p><p>Efforts could further develop our architecture to quantify its robustness through analysis of the non-linear dynamics<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="Wigbers, M. &amp; Riedmiller, M. A new method for the analysis of neural reference model control. In Proc. International Conference on Neural Networks (ICNN’97) Vol. 2, 739–743 (IEEE, 1997)." href="#ref-CR30" id="ref-link-section-d263546778e1126">30</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="Berkenkamp, F., Turchetta, M., Schoellig, A. &amp; Krause, A. Safe model-based reinforcement learning with stability guarantees. In 2017 Advances in Neural Information Processing Systems 908–919 (ACM, 2017)." href="#ref-CR31" id="ref-link-section-d263546778e1126_1">31</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 32" title="Wabersich, K. P., Hewing, L., Carron, A. &amp; Zeilinger, M. N. Probabilistic model predictive safety certification for learning-based control. IEEE Tran. Automat. Control 67, 176–188 (2021)." href="/articles/s41586-021-04301-9#ref-CR32" id="ref-link-section-d263546778e1129">32</a></sup> and reduce training time through increased reuse of data and multi-fidelity learning<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 33" title="Abdolmaleki, A. et al. On multi-objective policy optimization as a tool for reinforcement learning. Preprint at 
                  https://arxiv.org/abs/2106.08199
                  
                 (2021)." href="/articles/s41586-021-04301-9#ref-CR33" id="ref-link-section-d263546778e1133">33</a></sup>. Additionally, the set of control targets can be expanded, for example, to reduce target heat loads through flux expansion<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 5" title="Anand, H. et al. Plasma flux expansion control on the DIII-D tokamak. Plasma Phys. Control. Fusion 63, 015006 (2020)." href="/articles/s41586-021-04301-9#ref-CR5" id="ref-link-section-d263546778e1137">5</a></sup>, aided by the use ofprivileged information in the critic to avoid requiring real-time observers. The architecture can be coupled to a more capable simulator, for example, incorporating plasma pressure and current-density-evolution physics, to optimize the global plasma performance.</p><p>Our learning framework has the potential to shape future fusion research and tokamak development. Underspecified objectives can find configurations that maximize a desired performance objective or even maximize power production. Our architecture can be rapidly deployed on a new tokamak without the need to design and commission the complex system of controllers deployed today, and evaluate proposed designs before they are constructed. More broadly, our approach may enable the discovery of new reactor designs by jointly optimizing the plasma shape, sensing, actuation, wall design, heat load and magnetic controller to maximize overall performance.</p></div></div></section><section data-title="Methods"><div class="c-article-section" id="Sec7-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="Sec7">Methods</h2><div class="c-article-section__content" id="Sec7-content"><h3 class="c-article__sub-heading" id="Sec8">Tokamak à Configuration Variable</h3><p>The TCV <sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 1" title="Hofmann, F. et al. Creation and control of variably shaped plasmas in TCV. Plasma Phys. Control. Fusion 36, B277 (1994)." href="/articles/s41586-021-04301-9#ref-CR1" id="ref-link-section-d263546778e1156">1</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 34" title="Coda, S. et al. Overview of the TCV tokamak program: scientific progress and facility upgrades. Nucl. Fusion 57, 102011 (2017)." href="/articles/s41586-021-04301-9#ref-CR34" id="ref-link-section-d263546778e1159">34</a></sup>, shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig1">1</a>, is a research tokamak at the Swiss Plasma Center, with a major radius of 0.88 m and vessel height and width of 1.50 m and 0.512 m, respectively. TCV has a flexible set of magnetic coils that enable the creation of a wide range of plasma configurations. Electron cyclotron resonance heating and neutral beam injection<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 35" title="Karpushov, A. N. et al. Neutral beam heating on the TCV tokamak. Fusion Eng. Des. 123, 468–472 (2017)." href="/articles/s41586-021-04301-9#ref-CR35" id="ref-link-section-d263546778e1166">35</a></sup> systems provide external heating and current drive, as used in the experiment in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig3">3b</a>. TCV is equipped with several real-time sensors and our control policies use a subset of these sensors. In particular, we use 34 of the wire loops that measure magnetic flux, 38 probes that measure the local magnetic field and 19 measurements of the current in active control coils (augmented with an explicit measure of the difference in current between the ohmic coils). In addition to the magnetic sensors, TCV is equipped with other sensors that are not available in real time, such as the cameras shown in Figs. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig2">2</a> and <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig4">4</a>. Our control policy consumesthe magnetic and current sensors of TCV at a 10-kHz control rate. The control policy produces a reference voltage command at each time step for the active control coils.</p><h3 class="c-article__sub-heading c-article__sub-heading--divider" id="Sec9">Tokamak simulator</h3><p>The coupled dynamics of the plasma and external active and passiveconductors are modelled with a free-boundary simulator, FGE<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 22" title="Carpanese, F. Development of Free-boundary Equilibrium and Transport Solvers for Simulation and Real-time Interpretation of Tokamak Experiments. PhD thesis, EPFL (2021)." href="/articles/s41586-021-04301-9#ref-CR22" id="ref-link-section-d263546778e1188">22</a></sup>. The conductors are described by a circuit model in which the resistivity is considered known and constant, and the mutual inductance is computed analytically.</p><p>The plasma is assumed to be in a state of toroidally symmetric equilibrium force balance (Grad–Shafranov equation<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 21" title="Grad, H. &amp; Rubin, H. Hydromagnetic equilibria and force-free fields. J. Nucl. Energy (1954) 7, 284–285 (1958)." href="/articles/s41586-021-04301-9#ref-CR21" id="ref-link-section-d263546778e1195">21</a></sup>), in which the Lorentz force <i>J</i> × <i>B</i> generated from the interaction of the plasma current density, <i>J</i>, and the magnetic field, <i>B</i>, balances the plasma pressure gradient <span class="stix">∇</span><i>p</i>. The transport of radial pressure and current density caused by heat and current drive sources is not modelled. Instead, the plasma radial profiles are modelled as polynomials whose coefficients are constrained by the plasma current <i>I</i><sub>p</sub> plus two free parameters: the normalized plasma pressure <i>β</i><sub>p</sub>, which is the ratio of kinetic pressure to the magnetic pressure, and the safety factor at the plasma axis <i>q</i><sub>A</sub>, which controls the current density peakedness.</p><p>The evolution of the total plasma current <i>I</i><sub>p</sub>, is described as a lumped-parameter equation on the basis of the generalized Ohm’s law for the magnetohydrodynamics model. For this model, the total plasma resistance, <i>R</i><sub>p</sub>, and the total plasma self-inductance, <i>L</i><sub>p</sub>, are free parameters. Finally, FGE produces the synthetic magnetic measurements that simulate the TCV sensors, which are used to learn the control policies, as discussed below.</p><h3 class="c-article__sub-heading c-article__sub-heading--divider" id="Sec10">Specific settings for the droplets</h3><p>In the experiment with the droplets (Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig4">4</a>), the plasma is considered pressureless, which simplifies the numerical solution of the force balance equation. Moreover, the G coil was disabled in simulation, as it was placed in open circuit during experiments (the fast radial fields it generates were deemed unnecessary for these plasmas). This experiment used an earlier model for the <i>I</i><sub>p</sub> evolution designed for stationary-state plasma operation. This model has one free parameter, the radial profile of the neoclassical parallel plasma conductivity <span class="mathjax-tex">\({\sigma }_{\parallel }\)</span> (ref. <sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 22" title="Carpanese, F. Development of Free-boundary Equilibrium and Transport Solvers for Simulation and Real-time Interpretation of Tokamak Experiments. PhD thesis, EPFL (2021)." href="/articles/s41586-021-04301-9#ref-CR22" id="ref-link-section-d263546778e1285">22</a></sup>). This model was replaced with the one described above for the single-domain plasma experiment, as it better describes the evolution of <i>I</i><sub>p</sub>, especially when it is changing rapidly.</p><h3 class="c-article__sub-heading c-article__sub-heading--divider" id="Sec11">Plasma parameter variation</h3><p>We vary the plasma-evolution parameters introduced above during training to provide robust performance across the true but unknown condition of the plasma. The amount of variation is set within ranges identified from experimental data as shown in Extended Data Table <a data-track="click" data-track-label="link" data-track-action="table anchor" href="/articles/s41586-021-04301-9#Tab2">2</a>. In the single-plasma experiments, we vary the plasma resistivity <i>R</i><sub>p</sub>, as well as the profile parameters <i>β</i><sub>p</sub> and <i>q</i><sub>A</sub>. <i>L</i><sub>p</sub> is not varied, as it can be computed from a simple relation<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 36" title="Lister, J. B. et al. Plasma equilibrium response modelling and validation on JT-60U. Nucl. Fusion 42, 708 (2002)." href="/articles/s41586-021-04301-9#ref-CR36" id="ref-link-section-d263546778e1322">36</a></sup>. These are all independently sampled from a parameter-specific log-uniform distribution. In the experiment with droplets, we vary the initial ohmic coil current values according to a uniform distribution. We set two different values for the droplet <span class="mathjax-tex">\({\sigma }_{\parallel }\)</span> components. We sample the log of the difference between them from a scaled beta distribution and the overall shift in the combined geometric mean from a log-uniform distribution, and then solve for the individual <span class="mathjax-tex">\({\sigma }_{\parallel }\)</span>. Parameter values are sampled at the beginning of each episode and kept constant for the duration of the simulation. The sampled value is deliberately not exposed to the learning architecture because it is not directly measureable. Therefore, the agent is forced to learn a controller that can robustly handle all combinations of these parameters. This informed and targeted domain-randomization technique proved to be effective to find policies that track time targets for shape and <i>I</i><sub>p</sub> while being robust to the injection of external heating and the edge-localized mode perturbations during high confinement mode.</p><h3 class="c-article__sub-heading c-article__sub-heading--divider" id="Sec12">Sensing and actuation</h3><p>The raw sensor data on TCV go through a low-pass filtering and signal-conditioning stage<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 37" title="Lister, J. B. et al. The control of tokamak configuration variable plasmas. Fusion Technol. 32, 321–373 (1997)." href="/articles/s41586-021-04301-9#ref-CR37" id="ref-link-section-d263546778e1395">37</a></sup>. We model this stage in simulation by a time delay and a Gaussian noise model, identified from data during a stationary-plasma operation phase (Extended Data Table <a data-track="click" data-track-label="link" data-track-action="table anchor" href="/articles/s41586-021-04301-9#Tab2">2</a>). This sensor model (shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig1">1b</a>) captures the relevant dynamics affecting control stability. The power-supply dynamics (also shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig1">1b</a>) are modelled with a fixed bias and a fixed time delay identified from data, as well as a further offset varied randomly at the beginning of each episode. The values for these modifications can be found in Extended Data Table <a data-track="click" data-track-label="link" data-track-action="table anchor" href="/articles/s41586-021-04301-9#Tab2">2</a>. This is a conservative approximation of the true thyristor-based power supplies<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 37" title="Lister, J. B. et al. The control of tokamak configuration variable plasmas. Fusion Technol. 32, 321–373 (1997)." href="/articles/s41586-021-04301-9#ref-CR37" id="ref-link-section-d263546778e1412">37</a></sup>, but captures the essential dynamics for control purposes.</p><p>The control policy can learn to be robust against very non-linear hardware-specific phenomena. For example, when the current in the active coils changes polarity and the controller requests a too low voltage, the power supplies can get ‘stuck’, erroneously providing zero output current over an extended period of time (Extended Data Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig8">4b</a>). This phenomenon might affect both the controller stability and the precision. To demonstrate the capability of our controller to deal with this issue, we applied ‘learned-region avoidance’ in the advanced controldemonstration to indicate that currents near zero are undesirable. As a result, the control policy effectively learns to increase the voltages when changing the current polarity to avoid stuck coils on the plant (Extended Data Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig8">4c</a>).</p><h3 class="c-article__sub-heading c-article__sub-heading--divider" id="Sec13">Neural-network architecture</h3><p>MPO<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 23" title="Abdolmaleki, A. et al. Relative entropy regularized policy iteration. Preprint at 
                  https://arxiv.org/abs/1812.02256
                  
                 (2018)." href="/articles/s41586-021-04301-9#ref-CR23" id="ref-link-section-d263546778e1433">23</a></sup> uses two neural-network architectures to design and optimize the policy: the critic network and the policy network. Both networks are adapted during training, but only the policy network is deployed on the plant.</p><p>For the critic network, the inputs are combined with the hyperbolic tangent function value of the last commanded action and fed to a long short-term memory (LSTM) layer 256 units wide. The outputs of the LSTM layer are then concatenated with its inputs and fed to a multilayer perceptron (MLP), that is, a stack of two densely connected hidden layers with 256 latents each. Each of the MLP layers uses an exponential linear unit non-linearity. Finally, we use a last linear layer to output the Q-value.</p><p>The policy network is restricted to a network architecture that can be evaluated on the target hardware within 50 μs to obtain the necessary 10-kHz control rate. Additionally, the network needs to perform this inference to sufficient numerical accuracy on the control system, which uses a different processor architecture from the hardware used for training. Therefore, the policy network is built as follows. We feed the inputs to a stack of a linear layer with 256 outputs. The outputs of this linear layer are normalized with a LayerNorm<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 38" title="Ulyanov, D., Vedaldi, A. &amp; Lempitsky, V. Instance normalization: the missing ingredient for fast stylization. Preprint at 
                  https://arxiv.org/abs/1607.08022
                  
                 (2016)." href="/articles/s41586-021-04301-9#ref-CR38" id="ref-link-section-d263546778e1443">38</a></sup> and bounded using a hyperbolic tangent function. After this, the output is fed through a three-layer MLP using exponential linear unit non-linearity and 256 latents each. The output of this stack is fed through a final linear layer that outputs two parameters per action: one mean of the Gaussian distribution and one standard deviation of the Gaussian distribution. The standard deviation uses a softplus non-linearity to make sure it is always positive. The parameters of this Gaussian distribution over actions are the output of the neural network. Note that, for assessing the policy in simulation and executing on TCV, only the mean of the distribution is used. With this small neural network, we can perform inference within the L2 cache of the CPU on the control system.</p><p>These neural networks are initialized with the weights of a truncated normal distribution scaled with the number of inputs and a bias of zero. The exception is the last layer of the policy network, which is initialized the same way but scaled with 0.0001 (ref. <sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 39" title="Andrychowicz, M. et al. What matters in on-policy reinforcement learning? A large-scale empirical study. In ICLR 2021 Ninth International Conference on Learning Representations (2021)." href="/articles/s41586-021-04301-9#ref-CR39" id="ref-link-section-d263546778e1450">39</a></sup>). These networks are trained with an unroll length of 64 steps. For training, we used a batch size of 256 and a discount of 0.99.</p><p>Extended Data Figure <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig9">5a</a> shows the importance of an asymmetric design between the actor network and the critic network. We compare the standard setup with a symmetric setup in which the critic is also limited by the control rate on the plant. In the standard setup, the critic network is much larger than the policy network (718,337 parameters compared with 266,280 parameters) and also uses a recurrent LSTM. In the symmetric setup, the critic is also an MLP that is about the same size as the policy (266,497 parameters). We see that the symmetric design notably underperforms the asymmetric design in learning an effective policy. We additionally find that the main benefit comes from the recurrent design in the critic to handle the non-Markovian properties of this environment. When we scale up the critic keeping the feedforward structure of the policy, we find that widening its width to512 units (926,209 parameters) or even 1,024 units (3,425,281 parameters) still does not match the performance of the setup with the smaller but recurrent critic.</p><h3 class="c-article__sub-heading c-article__sub-heading--divider" id="Sec14">Learning loop</h3><p>Our approach uses an episodic training approach in which data are collected by running the simulator with a control policy in the loop, as shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig1">1a</a>. The data from these interactions are collected in a finite-capacity first-in-first-out buffer<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 40" title="Cassirer, A. et al. Reverb: a framework for experience replay. Preprint at 
                  https://arxiv.org/abs/2102.04736
                  
                 (2021)." href="/articles/s41586-021-04301-9#ref-CR40" id="ref-link-section-d263546778e1472">40</a></sup>. The interaction trajectories are sampled at random from the buffer by a ‘learner’, which executes the MPO algorithm to update the control-policy parameters. During training, the executed control policy is stochastic to explore successful control options. This stochastic policy is represented by a diagonal Gaussian distribution over coil actions.</p><p>Each episode corresponds to a single simulation run that terminates either when a termination condition is hit, which we will discuss below, or when a fixed simulation time has passed in the episode. This fixed time was 0.2 s for the droplets, 0.5 s in the case of Extended Data Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig6">2a, c</a>,&nbsp;and 1 s&nbsp;otherwise. Each episode is initialized from an equilibrium state at the preprogrammed handover time, which was reconstructed from a previous experiment on TCV.</p><p>Our training loop emulates the control frequency of 10 kHz. At each step, the policy is evaluated using the observation from the previous step. The resulting action is then applied to the simulator, which is then stepped. Observations and rewards are also collected at the 10-kHz control frequency, resulting in training data collected at 0.1&nbsp;ms intervals. For our simulation, we chose a time step of 50 kHz. Hence, for each evaluation of the policy, five simulation time steps are computed. The action, that is, the desired coil voltage, is kept constant during these substeps. Data from intermediate steps are only used for checking termination conditions and are discarded afterwards. This enables choosing the control rate and simulator time step independently and, hence, setting the latter on the basis of numerical considerations.</p><p>We use a distributed architecture<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 41" title="Hoffman, M. et al. Acme: a research framework for distributed reinforcement learning. Preprint at 
                  https://arxiv.org/abs/2006.00979
                  
                 (2020)." href="/articles/s41586-021-04301-9#ref-CR41" id="ref-link-section-d263546778e1488">41</a></sup> with a single learner instance on a tensor processing unit and several actors each running an independent instance of the simulator. We used 5,000 actors in parallel for our experiments, generally resulting in training times of 1-3 days, although sometimes longer for complex target specifications. We ran a sweep on the number of actors required to stabilize a basic plasma and the results can be seen in Extended Data Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig9">5</a>. We see that a similar level of performance can be achieved with a large reduction in the number of actors for a moderate cost in training time.</p><p>As RL only interacts sample-wise with the environment, the policy could be fine-tuned further with data from interacting with the plant. Alternatively, one might imagine leveraging the database of past experiments performed on TCV to improve the policy. However, it is unclear if the data are sufficiently diverse, given the versatility of TCV and the fact that the same plasma configuration can be achieved by various coil-voltage configurations. Especially for previously unknown plasma shapes, no data or only very limited data are available, rendering this approach ineffective. Conversely, the simulator can directly model the dynamics for the configurations of interest. This issue in which data collection requires a good policy becomes even more pronounced if one wants to optimize a policy de novo from data, without relying on a simulator model.</p><h3 class="c-article__sub-heading c-article__sub-heading--divider" id="Sec15">Rewards and terminations</h3><p>All of our experiments have several objectives that must be satisfied simultaneously. These objectives are specified as individual reward components that track an aspect of the simulation — typically, a physical quantity — and these individual components are combined into a single scalar reward value. Descriptions of the targets used are listed in Extended Data Table <a data-track="click" data-track-label="link" data-track-action="table anchor" href="/articles/s41586-021-04301-9#Tab4">4</a>. The target values of the objectives are often time-varying (for example, the plasma current and boundary target points), and are sent to the policy as part of the observations. This time-varying trace of targets is defined by a sequence of values at points in time, which are linearly interpolated for all time steps in between.</p><p>Shape targets for each experiment were generated using the shape generator<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 42" title="Hofmann, F. FBT-a free-boundary tokamak equilibrium code for highly elongated and shaped plasmas. Comput. Phys. Commun. 48, 207–221 (1988)." href="/articles/s41586-021-04301-9#ref-CR42" id="ref-link-section-d263546778e1513">42</a></sup> or specified manually. These points are then canonicalized to 32 equally spaced points along a spline, which are the targets that are fed to the policy. The spline is periodic for closed shapes but non-periodic for diverted shapes, ending at the X-points.</p><p>The process for combining these multiple objectives into a single scalar is as follows. First, for each objective, the difference between the actual and target values is computed, and then transformed with a non-linear function to a quality measure between 0 and 1. In the case of a vector-valued objective (for example, distance to each target-shape point), the individual differences are first merged into a single scalar through a ‘combiner’, a weighted non-linear function. Finally, a weighted combination of the individual objective-specific quality measures is computed into a single scalar reward value between 0 and 1 using a combiner as above. This (stepwise) reward is then normalized so that the maximum cumulative reward is 100 for 1 s of control. In cases in which the control policy has triggered a termination, a large negative reward is given. See Extended Data Table <a data-track="click" data-track-label="link" data-track-action="table anchor" href="/articles/s41586-021-04301-9#Tab5">5</a> for more details.</p><p>We typically compute the quality measure from the error using a softplus or sigmoid, which provides a non-zero learning signal early in training when the errors are large, while simultaneously encouraging precision as the policy improves. Similarly, we combine the rewards using a (weighted) smooth max or geometric mean, which gives a larger gradient to improving the worst reward, while still encouraging improving all objectives. The precise reward definitions used in each of our experiments are listed in Extended Data Table <a data-track="click" data-track-label="link" data-track-action="table anchor" href="/articles/s41586-021-04301-9#Tab3">3</a> and the implementations are available in the supplementary material.</p><h3 class="c-article__sub-heading c-article__sub-heading--divider" id="Sec16">Further findings</h3><p>Some controllers exhibited several interesting behaviours, which are briefly mentioned here. These control behaviours hint at further potential capabilities of learned-control approaches.</p><p>External heating was applied during the experiment shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig3">3b</a>. We first ran a test experiment without heating, but with the exact same controller and objectives. This provides a simple repeatability test in the control window before heating was applied. A performance comparison is depicted in Extended Data Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig7">3</a> and shows that, in these two experiments, the controller performed similarly.</p><p>When given the goal to maintain only the plasma position and current, our architecture autonomously constructed a low-elongation plasma that eliminates the vertical instability mode (Extended Data Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig8">4a</a>), without being explicitly told to do so.</p><p>Our control architecture can naturally choose to use a varying combination of poloidal field and ohmic coils to drive the inductive voltage required for sustaining the plasma current (Extended Data Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig8">4b</a>), in contrast to existing control architectures that typically assume a strict separation.</p><p>Our architecture can learn to include non-linear physical and control requests by adding objectives to the goal specification. It can, for example, avoid limitations in the power supplies that occasionally cause ‘stuck’ control-coil currents when reversing polarity (Extended Data Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig8">4c</a>) and avoid X-points in the vessel but outside the plasma (Extended Data Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig8">4d</a>) when requested with high-level rewards.</p><p>We see that, for some quantities, there is a steady-state error in the target value (for example, <i>κ</i> in Extended Data Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig7">3</a>). Future development will be towards removing such errors, for example, by making the control policy recurrent rather than feedforward. Care must be taken to ensure that these more powerful recurrent policies do not overspecialize to the specific dynamics of the simulator and continue to transfer to TCV successfully.</p><h3 class="c-article__sub-heading c-article__sub-heading--divider" id="Sec17">Deployment</h3><p>As the stochastic nature of the training policy is only useful for exploration, the final control policy is taken to be the mean of the Gaussian policy at the conclusion of training. This gives a deterministic policy to execute on the plant. During training, we monitor the quality of this deterministic policy before deployment.</p><p>The control loop of TCV runs at 10 kHz, although only half of the cycle time, that is, 50 μs, is available for the control algorithm due to other signal processing and logging. Therefore we created a deployment system that compiles our neural network into real-time-capable code that is guaranteed to run within this time window. To achieve this, we remove superfluous weights and computations (such as the exploration variance) and then use tfcompile<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 43" title="Abadi, M. et al. TensorFlow: a system for large-scale machine learning. In Proc. 12th USENIX Symposium on Operating Systems Design and Implementation (OSDI ’16) 265–283 (2016)." href="/articles/s41586-021-04301-9#ref-CR43" id="ref-link-section-d263546778e1588">43</a></sup> to compile it into binary code, carefully avoiding unnecessary dependencies. We tailored the neural network structure to optimize the use of the processor’s cache and enable vectorized instructions for optimal performance. The table of time-varying control targets is also compiled into the binary for ease of deployment. In future work, targets could easily be supplied at runtime to dynamically adjust the behaviour of the control policy. We then test all compiled policies in an automated, extensive benchmark before deployment to ensure that timings are met consistently.</p><h3 class="c-article__sub-heading c-article__sub-heading--divider" id="Sec18">Post-experiment analysis</h3><p>The plasma shape and position are not directly observed and need to be inferred from the available magnetic measurements. This is done with magnetic-equilibrium reconstruction, which solves an inverse problem to find the plasma-current distribution that respects the force balance (Grad–Shafranov equation) and best matches the given experimental magnetic measurements at a specific time in a least-squares sense.</p><p>In a conventional magnetic control design, a real-time-capable magnetic-equilibrium reconstruction is needed as a plasma-shape observer to close the shape-control feedback loop (shown as the ‘Plasma shape’ observer in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig1">1f</a>). In our approach, instead, we only make use of equilibrium reconstruction with LIUQE code<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 10" title="Moret, J.-M. et al. Tokamak equilibrium reconstruction code LIUQE and its real time implementation. Fusion Eng. Des. 91, 1–15 (2015)." href="/articles/s41586-021-04301-9#ref-CR10" id="ref-link-section-d263546778e1607">10</a></sup> during post-discharge analysis to validate the plasma-shape controller performances and compute the physical initial conditions for the simulation during training.</p><p>After running the experiment, we use this equilibrium-reconstruction code to obtain an estimate of the plasma state and magnetic flux field. Using this approach is consistent with previous literature for evaluating performance<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 9" title="Ferron, J. R. et al. Real time equilibrium reconstruction for tokamak discharge control. Nucl. Fusion 38, 1055 (1998)." href="/articles/s41586-021-04301-9#ref-CR9" id="ref-link-section-d263546778e1614">9</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 10" title="Moret, J.-M. et al. Tokamak equilibrium reconstruction code LIUQE and its real time implementation. Fusion Eng. Des. 91, 1–15 (2015)." href="/articles/s41586-021-04301-9#ref-CR10" id="ref-link-section-d263546778e1617">10</a></sup>.</p><p>The plasma boundary is defined by the last closed-flux surface (LCFS) in the domain. We extract the LCFS as 32 equiangular points around the plasma axis and then canonicalize with splines to 128 equidistant points. The error distance is computed using the shortest distance between each of the points that defined the target shape and the polygon defined by the 128 points on the LCFS. The shape RMSE is computed across these 32 error distances over all time steps in the time range of interest.</p><p>Errors on scalar quantities, such as <i>I</i><sub>p</sub> or elongation, are computed from the error between the reference and the respective estimation from the equilibrium reconstruction over the time period of interest. The estimate of the growth rate of the vertical displacement instability<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 6" title="De Tommasi, G. Plasma magnetic control in tokamak devices. J. Fusion Energy 38, 406–436 (2019)." href="/articles/s41586-021-04301-9#ref-CR6" id="ref-link-section-d263546778e1632">6</a></sup> is computed from a spectral decomposition of the linearized system of equations of the simulator around the reconstructed equilibrium.</p><h3 class="c-article__sub-heading c-article__sub-heading--divider" id="Sec19">Comparison with previous work</h3><p>In recent years, advanced control techniques have been applied to magnetic confinement control. De Tommasi et al.<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 44" title="De Tommasi, G. et al. Model-based plasma vertical stabilization and position control at EAST. Fusion Eng. Des. 129, 152–157 (2018)." href="/articles/s41586-021-04301-9#ref-CR44" id="ref-link-section-d263546778e1644">44</a></sup> describe a model-based control approach for plasma-position control using a linear model and a cascaded feedback-control structure. Gerkšič and De Tommasi<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 45" title="Gerkšič, S. &amp; De Tommasi, G. ITER plasma current and shape control using MPC. In 2016 IEEE Conference on Control Applications (CCA) 599–604 (IEEE, 2016)." href="/articles/s41586-021-04301-9#ref-CR45" id="ref-link-section-d263546778e1648">45</a></sup> propose a model predictive control approach, demonstrating linear model predictive control for plasma position and shape control in simulation, including a feasibility estimate for hardware deployment. Boncagni et al.<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 46" title="Boncagni, L. et al. Performance-based controller switching: an application to plasma current control at FTU. In 2015 54th IEEE Conference on Decision and Control (CDC) 2319–2324 (IEEE, 2015)." href="/articles/s41586-021-04301-9#ref-CR46" id="ref-link-section-d263546778e1652">46</a></sup> have proposed a switching controller, improving on plasma-current tracking on hardware but without demonstrating further capabilities. There has been other previous work in which RL has learned on plasma models, for example, to control the safety factor<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 47" title="Wakatsuki, T., Suzuki, T., Hayashi, N., Oyama, N. &amp; Ide, S. Safety factor profile control with reduced central solenoid flux consumption during plasma current ramp-up phase using a reinforcement learning technique. Nucl. Fusion 59, 066022 (2019)." href="/articles/s41586-021-04301-9#ref-CR47" id="ref-link-section-d263546778e1656">47</a></sup> or to control the ion-temperature gradient<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 48" title="Wakatsuki, T., Suzuki, T., Oyama, N. &amp; Hayashi, N. Ion temperature gradient control using reinforcement learning technique. Nucl. Fusion 61, 046036 (2021)." href="/articles/s41586-021-04301-9#ref-CR48" id="ref-link-section-d263546778e1660">48</a></sup>. Recently, Seo et al.<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 49" title="Seo, J. et al. Feedforward beta control in the KSTAR tokamak by deep reinforcement learning. Nucl. Fusion 61, 106010 (2021)." href="/articles/s41586-021-04301-9#ref-CR49" id="ref-link-section-d263546778e1665">49</a></sup> have developed feedforward signals for beta control using RL, which have then been verified on the KSTAR tokamak.</p><p>More generally, machine-learning-based approaches are being developed for magnetic-confinement control and fusion in general, not limited to control. A survey of this area is provided by Humphreys et al.<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 14" title="Humphreys, D. et al. Advancing fusion with machine learning research needs workshop report. J. Fusion Energy 39, 123–155 (2020)." href="/articles/s41586-021-04301-9#ref-CR14" id="ref-link-section-d263546778e1672">14</a></sup>, who categorized approaches into seven Priority Research Opportunities, including accelerating science, diagnostics, model extraction, control, large data, prediction and platform development. Early use of neural networks in a control loop for plasma control is presented by Bishop et al.<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 15" title="Bishop, C. M., Haynes, P. S., Smith, M. E., Todd, T. N. &amp; Trotman, D. L. Real time control of a tokamak plasma using neural networks. Neural Comput. 7, 206–217 (1995)." href="/articles/s41586-021-04301-9#ref-CR15" id="ref-link-section-d263546778e1676">15</a></sup>, who used a small-scale neural network to estimate the plasma position and low-dimensional shape parameters, which were subsequently used as error signals for feedback control.</p><p>Our architecture constitutes an important step forward in terms of generality, in which a single framework is used to solve a broad variety of fusion-control challenges, satisfying several of the key promises of machine learning and artificial intelligence for fusion set out in ref. <sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 14" title="Humphreys, D. et al. Advancing fusion with machine learning research needs workshop report. J. Fusion Energy 39, 123–155 (2020)." href="/articles/s41586-021-04301-9#ref-CR14" id="ref-link-section-d263546778e1683">14</a></sup>.</p><h3 class="c-article__sub-heading c-article__sub-heading--divider" id="Sec20">Application to alternative tokamaks</h3><p>Our approach has been successfully demonstrated on TCV, and we are confident that, with a few basic modifications, our approach is directly applicable to other tokamaks that meet some assumptions and technical requirements laid out below. All present-day tokamaks have been confirmed to respect, from the magnetic control point of view, the coupled equations solved by free-boundary simulators. Equilibrium controllers have routinely been designed on the basis of these models, and — for future tokamaks — there is no reason as of yet to believe this model will no longer be valid. Naturally, we cannot predict the performance of our approach on other kinds of devices.</p><p>To simulate a different device, the free-boundary simulator parameters will need to be set appropriately. This includes the machine description with the locations and electrical properties of coils, vessel and limiter, the actuator and sensor characteristics, such as current and voltage ranges, noise and delay. Operational conditions such as the expected range of variation of profile parameters also need to be determined. Finally, rewards and targets need to be updated to match the geometry and desired shapes.</p><p>The aforementioned characteristics should be readily available, as these are typically part of the design process for a given tokamak. Indeed, Grad–Shafranov equilibrium calculations are routinely carried out for the general design and analysis of a new tokamak, and these include all required parameters. These variations in vessel geometry and the number, placement and range of sensors and coils should not require changes to the learning algorithm beyond adjusting design bounds. The learning algorithm will automatically adjust input and output layer dimensions for the neural network and will automatically learn a policy suited to the new vessel and control system.</p><p>Further considerations are required for deployment. Our approach requires a centralized control system with sufficient computational power to evaluate a neural network at the desired control frequency, although a desktop-grade CPU is sufficient to meet this requirement. Also, an existing magnetic controller is needed to perform plasma breakdown and early ramp-up before handing over to the learned controller. Although our controllers are trained to avoid terminations in simulation corresponding to disruption criteria, they are not guaranteed to avoid plasma disruptions. Hence, if the target tokamak cannot tolerate certain kinds of disruptions, a machine-protection layer such as a simpler fallback controller or interlock system should be in place during experiments.</p></div></div></section>
            

            <section data-title="Data availability"><div class="c-article-section" id="data-availability-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="data-availability">Data availability</h2><div class="c-article-section__content" id="data-availability-content">
              
              <p>TCV experimental data from the images in this paper are available in the Supplementary information. <a data-track="click" data-track-label="link" data-track-action="section anchor" href="/articles/s41586-021-04301-9#Sec24">Source data</a> are provided with this paper.</p>
            </div></div></section><section data-title="Code availability"><div class="c-article-section" id="code-availability-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="code-availability">Code availability</h2><div class="c-article-section__content" id="code-availability-content">
              
              <p>The learning algorithm used in the actor-critic RL method is MPO<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 23" title="Abdolmaleki, A. et al. Relative entropy regularized policy iteration. Preprint at &#xA;                  https://arxiv.org/abs/1812.02256&#xA;                  &#xA;                 (2018)." href="/articles/s41586-021-04301-9#ref-CR23" id="ref-link-section-d263546778e1817">23</a></sup>, a reference implementation of which is available under an open-source license<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 41" title="Hoffman, M. et al. Acme: a research framework for distributed reinforcement learning. Preprint at &#xA;                  https://arxiv.org/abs/2006.00979&#xA;                  &#xA;                 (2020)." href="/articles/s41586-021-04301-9#ref-CR41" id="ref-link-section-d263546778e1821">41</a></sup>. Additionally, the software libraries launchpad<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 50" title="Yang, F. et al. Launchpad: a programming model for distributed machine learning research. Preprint at &#xA;                  https://arxiv.org/abs/2106.04516&#xA;                  &#xA;                 (2021)." href="/articles/s41586-021-04301-9#ref-CR50" id="ref-link-section-d263546778e1825">50</a></sup>, dm_env<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 51" title="Muldal, A. et al. dm_env: a Python interface for reinforcement learning environments. &#xA;                  http://github.com/deepmind/dm_env&#xA;                  &#xA;                 (2019)." href="/articles/s41586-021-04301-9#ref-CR51" id="ref-link-section-d263546778e1829">51</a></sup>, sonnet<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 52" title="Reynolds, M. et al. Sonnet: TensorFlow-based neural network library. &#xA;                  http://github.com/deepmind/sonnet&#xA;                  &#xA;                 (2017)." href="/articles/s41586-021-04301-9#ref-CR52" id="ref-link-section-d263546778e1833">52</a></sup>, tensorflow<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 53" title="Martín A. et al. TensorFlow: large-scale machine learning on heterogeneous systems. Software available from &#xA;                  https://www.tensorflow.org/&#xA;                  &#xA;                 2015." href="/articles/s41586-021-04301-9#ref-CR53" id="ref-link-section-d263546778e1838">53</a></sup> and reverb<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 40" title="Cassirer, A. et al. Reverb: a framework for experience replay. Preprint at &#xA;                  https://arxiv.org/abs/2102.04736&#xA;                  &#xA;                 (2021)." href="/articles/s41586-021-04301-9#ref-CR40" id="ref-link-section-d263546778e1842">40</a></sup> were used, which are also available as open source. The code to compute the control targets, rewards and terminations is available in the Supplementary information. FGE and LIUQE are available subject to license agreement from the Swiss Plasma Center at EPFL (Antoine Merle antoine.merle@epfl.ch, Federico Felici federico.felici@epfl.ch).</p>
            </div></div></section><div id="MagazineFulltextArticleBodySuffix"><section aria-labelledby="Bib1" data-title="References"><div class="c-article-section" id="Bib1-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="Bib1">References</h2><div class="c-article-section__content" id="Bib1-content"><div data-container-section="references"><ol class="c-article-references"><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="1."><p class="c-article-references__text" id="ref-CR1">Hofmann, F. et al. Creation and control of variably shaped plasmas in TCV. <i>Plasma Phys. Control. Fusion</i> <b>36</b>, B277 (1994).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=1994PPCF...36..277H" aria-label="ADS reference 1">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DyaK2MXjvFSisrw%3D" aria-label="CAS reference 1">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F0741-3335%2F36%2F12B%2F023" aria-label="Article reference 1">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 1" href="http://scholar.google.com/scholar_lookup?&amp;title=Creation%20and%20control%20of%20variably%20shaped%20plasmas%20in%20TCV&amp;journal=Plasma%20Phys.%20Control.%20Fusion&amp;volume=36&amp;publication_year=1994&amp;author=Hofmann%2CF">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="2."><p class="c-article-references__text" id="ref-CR2">Coda, S. et al. Physics research on the TCV tokamak facility: from conventional to alternative scenarios and beyond. <i>Nucl. Fusion</i> <b>59</b>, 112023 (2019).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2019NucFu..59k2023C" aria-label="ADS reference 2">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BC1MXisVOgtb3F" aria-label="CAS reference 2">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F1741-4326%2Fab25cb" aria-label="Article reference 2">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 2" href="http://scholar.google.com/scholar_lookup?&amp;title=Physics%20research%20on%20the%20TCV%20tokamak%20facility%3A%20from%20conventional%20to%20alternative%20scenarios%20and%20beyond&amp;journal=Nucl.%20Fusion&amp;volume=59&amp;publication_year=2019&amp;author=Coda%2CS">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="3."><p class="c-article-references__text" id="ref-CR3">Anand, H., Coda, S., Felici, F., Galperti, C. &amp; Moret, J.-M. A novel plasma position and shape controller for advanced configuration development on the TCV tokamak. <i>Nucl. Fusion</i> <b>57</b>, 126026 (2017).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2017NucFu..57l6026A" aria-label="ADS reference 3">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F1741-4326%2Faa7f4d" aria-label="Article reference 3">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 3" href="http://scholar.google.com/scholar_lookup?&amp;title=A%20novel%20plasma%20position%20and%20shape%20controller%20for%20advanced%20configuration%20development%20on%20the%20TCV%20tokamak&amp;journal=Nucl.%20Fusion&amp;volume=57&amp;publication_year=2017&amp;author=Anand%2CH&amp;author=Coda%2CS&amp;author=Felici%2CF&amp;author=Galperti%2CC&amp;author=Moret%2CJ-M">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="4."><p class="c-article-references__text" id="ref-CR4">Mele, A. et al. MIMO shape control at the EAST tokamak: simulations and experiments. <i>Fusion Eng. Des.</i> <b>146</b>, 1282–1285 (2019).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BC1MXltVSqsbs%3D" aria-label="CAS reference 4">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1016%2Fj.fusengdes.2019.02.058" aria-label="Article reference 4">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 4" href="http://scholar.google.com/scholar_lookup?&amp;title=MIMO%20shape%20control%20at%20the%20EAST%20tokamak%3A%20simulations%20and%20experiments&amp;journal=Fusion%20Eng.%20Des.&amp;volume=146&amp;pages=1282-1285&amp;publication_year=2019&amp;author=Mele%2CA">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="5."><p class="c-article-references__text" id="ref-CR5">Anand, H. et al. Plasma flux expansion control on the DIII-D tokamak. <i>Plasma Phys. Control. Fusion</i> <b>63</b>, 015006 (2020).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2021PPCF...63a5006A" aria-label="ADS reference 5">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F1361-6587%2Fabc457" aria-label="Article reference 5">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 5" href="http://scholar.google.com/scholar_lookup?&amp;title=Plasma%20flux%20expansion%20control%20on%20the%20DIII-D%20tokamak&amp;journal=Plasma%20Phys.%20Control.%20Fusion&amp;volume=63&amp;publication_year=2020&amp;author=Anand%2CH">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="6."><p class="c-article-references__text" id="ref-CR6">De Tommasi, G. Plasma magnetic control in tokamak devices. <i>J. Fusion Energy</i> <b>38</b>, 406–436 (2019).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1007%2Fs10894-018-0162-5" aria-label="Article reference 6">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 6" href="http://scholar.google.com/scholar_lookup?&amp;title=Plasma%20magnetic%20control%20in%20tokamak%20devices&amp;journal=J.%20Fusion%20Energy&amp;volume=38&amp;pages=406-436&amp;publication_year=2019&amp;author=Tommasi%2CG">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="7."><p class="c-article-references__text" id="ref-CR7">Walker, M. L. &amp; Humphreys, D. A. Valid coordinate systems for linearized plasma shape response models in tokamaks. <i>Fusion Sci. Technol.</i> <b>50</b>, 473–489 (2006).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BD28Xht1Ogu7nP" aria-label="CAS reference 7">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.13182%2FFST06-A1271" aria-label="Article reference 7">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 7" href="http://scholar.google.com/scholar_lookup?&amp;title=Valid%20coordinate%20systems%20for%20linearized%20plasma%20shape%20response%20models%20in%20tokamaks&amp;journal=Fusion%20Sci.%20Technol.&amp;volume=50&amp;pages=473-489&amp;publication_year=2006&amp;author=Walker%2CML&amp;author=Humphreys%2CDA">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="8."><p class="c-article-references__text" id="ref-CR8">Blum, J., Heumann, H., Nardon, E. &amp; Song, X. Automating the design of tokamak experiment scenarios. <i>J. Comput. Phys.</i> <b>394</b>, 594–614 (2019).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2019JCoPh.394..594B" aria-label="ADS reference 8">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://www.ams.org/mathscinet-getitem?mr=3961817" aria-label="MathSciNet reference 8">MathSciNet</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1016%2Fj.jcp.2019.05.046" aria-label="Article reference 8">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 8" href="http://scholar.google.com/scholar_lookup?&amp;title=Automating%20the%20design%20of%20tokamak%20experiment%20scenarios&amp;journal=J.%20Comput.%20Phys.&amp;volume=394&amp;pages=594-614&amp;publication_year=2019&amp;author=Blum%2CJ&amp;author=Heumann%2CH&amp;author=Nardon%2CE&amp;author=Song%2CX">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="9."><p class="c-article-references__text" id="ref-CR9">Ferron, J. R. et al. Real time equilibrium reconstruction for tokamak discharge control. <i>Nucl. Fusion</i> <b>38</b>, 1055 (1998).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=1998NucFu..38.1055F" aria-label="ADS reference 9">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DyaK1cXlvFWhtrs%3D" aria-label="CAS reference 9">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F0029-5515%2F38%2F7%2F308" aria-label="Article reference 9">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 9" href="http://scholar.google.com/scholar_lookup?&amp;title=Real%20time%20equilibrium%20reconstruction%20for%20tokamak%20discharge%20control&amp;journal=Nucl.%20Fusion&amp;volume=38&amp;publication_year=1998&amp;author=Ferron%2CJR">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="10."><p class="c-article-references__text" id="ref-CR10">Moret, J.-M. et al. Tokamak equilibrium reconstruction code LIUQE and its real time implementation. <i>Fusion Eng. Des.</i> <b>91</b>, 1–15 (2015).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BC2cXitFOntLbM" aria-label="CAS reference 10">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1016%2Fj.fusengdes.2014.09.019" aria-label="Article reference 10">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 10" href="http://scholar.google.com/scholar_lookup?&amp;title=Tokamak%20equilibrium%20reconstruction%20code%20LIUQE%20and%20its%20real%20time%20implementation&amp;journal=Fusion%20Eng.%20Des.&amp;volume=91&amp;pages=1-15&amp;publication_year=2015&amp;author=Moret%2CJ-M">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="11."><p class="c-article-references__text" id="ref-CR11">Xie, Z., Berseth, G., Clary, P., Hurst, J. &amp; van de Panne, M. Feedback control for Cassie with deep reinforcement learning. In <i>2018 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS)</i> 1241–1246 (IEEE, 2018).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="12."><p class="c-article-references__text" id="ref-CR12">Akkaya, I. et al. Solving Rubik’s cube with a robot hand. Preprint at <a href="https://arxiv.org/abs/1910.07113">https://arxiv.org/abs/1910.07113</a> (2019).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="13."><p class="c-article-references__text" id="ref-CR13">Bellemare, M. G. et al. Autonomous navigation of stratospheric balloons using reinforcement learning. <i>Nature</i> <b>588</b>, 77–82 (2020).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2020Natur.588...77B" aria-label="ADS reference 13">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BB3cXisVOks7rO" aria-label="CAS reference 13">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1038%2Fs41586-020-2939-8" aria-label="Article reference 13">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 13" href="http://scholar.google.com/scholar_lookup?&amp;title=Autonomous%20navigation%20of%20stratospheric%20balloons%20using%20reinforcement%20learning&amp;journal=Nature&amp;volume=588&amp;pages=77-82&amp;publication_year=2020&amp;author=Bellemare%2CMG">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="14."><p class="c-article-references__text" id="ref-CR14">Humphreys, D. et al. Advancing fusion with machine learning research needs workshop report. <i>J. Fusion Energy</i> <b>39</b>, 123–155 (2020).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BB3cXhvFWlsbrM" aria-label="CAS reference 14">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1007%2Fs10894-020-00258-1" aria-label="Article reference 14">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 14" href="http://scholar.google.com/scholar_lookup?&amp;title=Advancing%20fusion%20with%20machine%20learning%20research%20needs%20workshop%20report&amp;journal=J.%20Fusion%20Energy&amp;volume=39&amp;pages=123-155&amp;publication_year=2020&amp;author=Humphreys%2CD">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="15."><p class="c-article-references__text" id="ref-CR15">Bishop, C. M., Haynes, P. S., Smith, M. E., Todd, T. N. &amp; Trotman, D. L. Real time control of a tokamak plasma using neural networks. <i>Neural Comput.</i> <b>7</b>, 206–217 (1995).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1162%2Fneco.1995.7.1.206" aria-label="Article reference 15">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 15" href="http://scholar.google.com/scholar_lookup?&amp;title=Real%20time%20control%20of%20a%20tokamak%20plasma%20using%20neural%20networks&amp;journal=Neural%20Comput.&amp;volume=7&amp;pages=206-217&amp;publication_year=1995&amp;author=Bishop%2CCM&amp;author=Haynes%2CPS&amp;author=Smith%2CME&amp;author=Todd%2CTN&amp;author=Trotman%2CDL">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="16."><p class="c-article-references__text" id="ref-CR16">Joung, S. et al. Deep neural network Grad-Shafranov solver constrained with measured magnetic signals. <i>Nucl. Fusion</i> <b>60</b>, 16034 (2019).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F1741-4326%2Fab555f" aria-label="Article reference 16">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 16" href="http://scholar.google.com/scholar_lookup?&amp;title=Deep%20neural%20network%20Grad-Shafranov%20solver%20constrained%20with%20measured%20magnetic%20signals&amp;journal=Nucl.%20Fusion&amp;volume=60&amp;publication_year=2019&amp;author=Joung%2CS">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="17."><p class="c-article-references__text" id="ref-CR17">van de Plassche, K. L. et al. Fast modeling of turbulent transport in fusion plasmas using neural networks. <i>Phys. Plasmas</i> <b>27</b>, 022310 (2020).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2020PhPl...27b2310V" aria-label="ADS reference 17">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1063%2F1.5134126" aria-label="Article reference 17">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 17" href="http://scholar.google.com/scholar_lookup?&amp;title=Fast%20modeling%20of%20turbulent%20transport%20in%20fusion%20plasmas%20using%20neural%20networks&amp;journal=Phys.%20Plasmas&amp;volume=27&amp;publication_year=2020&amp;author=Plassche%2CKL">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="18."><p class="c-article-references__text" id="ref-CR18">Abbate, J., Conlin, R. &amp; Kolemen, E. Data-driven profile prediction for DIII-D. <i>Nucl. Fusion</i> <b>61</b>, 046027 (2021).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2021NucFu..61d6027A" aria-label="ADS reference 18">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BB3MXhtFWqt7fP" aria-label="CAS reference 18">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F1741-4326%2Fabe08d" aria-label="Article reference 18">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 18" href="http://scholar.google.com/scholar_lookup?&amp;title=Data-driven%20profile%20prediction%20for%20DIII-D&amp;journal=Nucl.%20Fusion&amp;volume=61&amp;publication_year=2021&amp;author=Abbate%2CJ&amp;author=Conlin%2CR&amp;author=Kolemen%2CE">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="19."><p class="c-article-references__text" id="ref-CR19">Kates-Harbeck, J., Svyatkovskiy, A. &amp; Tang, W. Predicting disruptive instabilities in controlled fusion plasmas through deep learning. <i>Nature</i> <b>568</b>, 526–531 (2019).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2019Natur.568..526K" aria-label="ADS reference 19">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BC1MXosVSmt70%3D" aria-label="CAS reference 19">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1038%2Fs41586-019-1116-4" aria-label="Article reference 19">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 19" href="http://scholar.google.com/scholar_lookup?&amp;title=Predicting%20disruptive%20instabilities%20in%20controlled%20fusion%20plasmas%20through%20deep%20learning&amp;journal=Nature&amp;volume=568&amp;pages=526-531&amp;publication_year=2019&amp;author=Kates-Harbeck%2CJ&amp;author=Svyatkovskiy%2CA&amp;author=Tang%2CW">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="20."><p class="c-article-references__text" id="ref-CR20">Jardin, S. <i>Computational Methods in Plasma Physics</i> (CRC Press, 2010).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="21."><p class="c-article-references__text" id="ref-CR21">Grad, H. &amp; Rubin, H. Hydromagnetic equilibria and force-free fields. <i>J. Nucl. Energy (1954)</i> <b>7</b>, 284–285 (1958).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1016%2F0891-3919%2858%2990139-6" aria-label="Article reference 21">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 21" href="http://scholar.google.com/scholar_lookup?&amp;title=Hydromagnetic%20equilibria%20and%20force-free%20fields&amp;journal=J.%20Nucl.%20Energy%20%281954%29&amp;volume=7&amp;pages=284-285&amp;publication_year=1958&amp;author=Grad%2CH&amp;author=Rubin%2CH">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="22."><p class="c-article-references__text" id="ref-CR22">Carpanese, F. <i>Development of Free-boundary Equilibrium and Transport Solvers for Simulation and Real-time Interpretation of Tokamak Experiments</i>. PhD thesis, EPFL (2021).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="23."><p class="c-article-references__text" id="ref-CR23">Abdolmaleki, A. et al. Relative entropy regularized policy iteration. Preprint at <a href="https://arxiv.org/abs/1812.02256">https://arxiv.org/abs/1812.02256</a> (2018).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="24."><p class="c-article-references__text" id="ref-CR24">Paley, J. I., Coda, S., Duval, B., Felici, F. &amp; Moret, J.-M. Architecture and commissioning of the TCV distributed feedback control system. In <i>2010 17th IEEE</i>-<i>NPSS Real Time Conference</i> 1–6 (IEEE, 2010).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="25."><p class="c-article-references__text" id="ref-CR25">Freidberg, J. P. <i>Plasma Physics and Fusion Energy</i> (Cambridge Univ. Press, 2008).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="26."><p class="c-article-references__text" id="ref-CR26">Hommen, G. D. et al. Real-time optical plasma boundary reconstruction for plasma position control at the TCV Tokamak. <i>Nucl. Fusion</i> <b>54</b>, 073018 (2014).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2014NucFu..54g3018H" aria-label="ADS reference 26">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BC2cXhvFensL7O" aria-label="CAS reference 26">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F0029-5515%2F54%2F7%2F073018" aria-label="Article reference 26">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 26" href="http://scholar.google.com/scholar_lookup?&amp;title=Real-time%20optical%20plasma%20boundary%20reconstruction%20for%20plasma%20position%20control%20at%20the%20TCV%20Tokamak&amp;journal=Nucl.%20Fusion&amp;volume=54&amp;publication_year=2014&amp;author=Hommen%2CGD">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="27."><p class="c-article-references__text" id="ref-CR27">Austin, M. E. et al. Achievement of reactor-relevant performance in negative triangularity shape in the DIII-D tokamak. <i>Phys. Rev. Lett.</i> <b>122</b>, 115001 (2019).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2019PhRvL.122k5001A" aria-label="ADS reference 27">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BC1MXpslSksrY%3D" aria-label="CAS reference 27">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1103%2FPhysRevLett.122.115001" aria-label="Article reference 27">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 27" href="http://scholar.google.com/scholar_lookup?&amp;title=Achievement%20of%20reactor-relevant%20performance%20in%20negative%20triangularity%20shape%20in%20the%20DIII-D%20tokamak&amp;journal=Phys.%20Rev.%20Lett.&amp;volume=122&amp;publication_year=2019&amp;author=Austin%2CME">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="28."><p class="c-article-references__text" id="ref-CR28">Kolemen, E. et al. Initial development of the DIII–D snowflake divertor control. <i>Nucl. Fusion</i> <b>58</b>, 066007 (2018).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2018NucFu..58f6007K" aria-label="ADS reference 28">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F1741-4326%2Faab0d3" aria-label="Article reference 28">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 28" href="http://scholar.google.com/scholar_lookup?&amp;title=Initial%20development%20of%20the%20DIII%E2%80%93D%20snowflake%20divertor%20control&amp;journal=Nucl.%20Fusion&amp;volume=58&amp;publication_year=2018&amp;author=Kolemen%2CE">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="29."><p class="c-article-references__text" id="ref-CR29">Anand, H. et al. Real time magnetic control of the snowflake plasma configuration in the TCV tokamak. <i>Nucl. Fusion</i> <b>59</b>, 126032 (2019).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2019NucFu..59l6032A" aria-label="ADS reference 29">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BB3cXitVWltrk%3D" aria-label="CAS reference 29">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F1741-4326%2Fab4440" aria-label="Article reference 29">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 29" href="http://scholar.google.com/scholar_lookup?&amp;title=Real%20time%20magnetic%20control%20of%20the%20snowflake%20plasma%20configuration%20in%20the%20TCV%20tokamak&amp;journal=Nucl.%20Fusion&amp;volume=59&amp;publication_year=2019&amp;author=Anand%2CH">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="30."><p class="c-article-references__text" id="ref-CR30">Wigbers, M. &amp; Riedmiller, M. A new method for the analysis of neural reference model control. In <i>Proc. International Conference on Neural Networks (ICNN’97)</i> Vol. 2, 739–743 (IEEE, 1997).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="31."><p class="c-article-references__text" id="ref-CR31">Berkenkamp, F., Turchetta, M., Schoellig, A. &amp; Krause, A. Safe model-based reinforcement learning with stability guarantees. In <i>2017 Advances in Neural Information Processing Systems</i> 908–919 (ACM, 2017).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="32."><p class="c-article-references__text" id="ref-CR32">Wabersich, K. P., Hewing, L., Carron, A. &amp; Zeilinger, M. N. Probabilistic model predictive safety certification for learning-based control. <i>IEEE Tran. Automat. Control</i> <b>67</b>, 176–188 (2021).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://www.ams.org/mathscinet-getitem?mr=4362626" aria-label="MathSciNet reference 32">MathSciNet</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1109%2FTAC.2021.3049335" aria-label="Article reference 32">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 32" href="http://scholar.google.com/scholar_lookup?&amp;title=Probabilistic%20model%20predictive%20safety%20certification%20for%20learning-based%20control&amp;journal=IEEE%20Tran.%20Automat.%20Control&amp;volume=67&amp;pages=176-188&amp;publication_year=2021&amp;author=Wabersich%2CKP&amp;author=Hewing%2CL&amp;author=Carron%2CA&amp;author=Zeilinger%2CMN">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="33."><p class="c-article-references__text" id="ref-CR33">Abdolmaleki, A. et al. On multi-objective policy optimization as a tool for reinforcement learning. Preprint at <a href="https://arxiv.org/abs/2106.08199">https://arxiv.org/abs/2106.08199</a> (2021).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="34."><p class="c-article-references__text" id="ref-CR34">Coda, S. et al. Overview of the TCV tokamak program: scientific progress and facility upgrades. <i>Nucl. Fusion</i> <b>57</b>, 102011 (2017).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2017NucFu..57j2011C" aria-label="ADS reference 34">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F1741-4326%2Faa6412" aria-label="Article reference 34">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 34" href="http://scholar.google.com/scholar_lookup?&amp;title=Overview%20of%20the%20TCV%20tokamak%20program%3A%20scientific%20progress%20and%20facility%20upgrades&amp;journal=Nucl.%20Fusion&amp;volume=57&amp;publication_year=2017&amp;author=Coda%2CS">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="35."><p class="c-article-references__text" id="ref-CR35">Karpushov, A. N. et al. Neutral beam heating on the TCV tokamak. <i>Fusion Eng. Des.</i> <b>123</b>, 468–472 (2017).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BC2sXjtl2nurs%3D" aria-label="CAS reference 35">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1016%2Fj.fusengdes.2017.02.076" aria-label="Article reference 35">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 35" href="http://scholar.google.com/scholar_lookup?&amp;title=Neutral%20beam%20heating%20on%20the%20TCV%20tokamak&amp;journal=Fusion%20Eng.%20Des.&amp;volume=123&amp;pages=468-472&amp;publication_year=2017&amp;author=Karpushov%2CAN">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="36."><p class="c-article-references__text" id="ref-CR36">Lister, J. B. et al. Plasma equilibrium response modelling and validation on JT-60U. <i>Nucl. Fusion</i> <b>42</b>, 708 (2002).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2002NucFu..42..708L" aria-label="ADS reference 36">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BD38XlsVGksr4%3D" aria-label="CAS reference 36">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F0029-5515%2F42%2F6%2F309" aria-label="Article reference 36">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 36" href="http://scholar.google.com/scholar_lookup?&amp;title=Plasma%20equilibrium%20response%20modelling%20and%20validation%20on%20JT-60U&amp;journal=Nucl.%20Fusion&amp;volume=42&amp;publication_year=2002&amp;author=Lister%2CJB">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="37."><p class="c-article-references__text" id="ref-CR37">Lister, J. B. et al. The control of tokamak configuration variable plasmas. <i>Fusion Technol.</i> <b>32</b>, 321–373 (1997).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DyaK2sXnt1ahtr4%3D" aria-label="CAS reference 37">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.13182%2FFST97-A1" aria-label="Article reference 37">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 37" href="http://scholar.google.com/scholar_lookup?&amp;title=The%20control%20of%20tokamak%20configuration%20variable%20plasmas&amp;journal=Fusion%20Technol.&amp;volume=32&amp;pages=321-373&amp;publication_year=1997&amp;author=Lister%2CJB">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="38."><p class="c-article-references__text" id="ref-CR38">Ulyanov, D., Vedaldi, A. &amp; Lempitsky, V. Instance normalization: the missing ingredient for fast stylization. Preprint at <a href="https://arxiv.org/abs/1607.08022">https://arxiv.org/abs/1607.08022</a> (2016).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="39."><p class="c-article-references__text" id="ref-CR39">Andrychowicz, M. et al. What matters in on-policy reinforcement learning? A large-scale empirical study. In <i>ICLR 2021 Ninth International Conference on Learning Representations</i> (2021).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="40."><p class="c-article-references__text" id="ref-CR40">Cassirer, A. et al. Reverb: a framework for experience replay. Preprint at <a href="https://arxiv.org/abs/2102.04736">https://arxiv.org/abs/2102.04736</a> (2021).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="41."><p class="c-article-references__text" id="ref-CR41">Hoffman, M. et al. Acme: a research framework for distributed reinforcement learning. Preprint at <a href="https://arxiv.org/abs/2006.00979">https://arxiv.org/abs/2006.00979</a> (2020).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="42."><p class="c-article-references__text" id="ref-CR42">Hofmann, F. FBT-a free-boundary tokamak equilibrium code for highly elongated and shaped plasmas. <i>Comput. Phys. Commun.</i> <b>48</b>, 207–221 (1988).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=1988CoPhC..48..207H" aria-label="ADS reference 42">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DyaL1cXhtl2gsrw%3D" aria-label="CAS reference 42">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1016%2F0010-4655%2888%2990041-0" aria-label="Article reference 42">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 42" href="http://scholar.google.com/scholar_lookup?&amp;title=FBT-a%20free-boundary%20tokamak%20equilibrium%20code%20for%20highly%20elongated%20and%20shaped%20plasmas&amp;journal=Comput.%20Phys.%20Commun.&amp;volume=48&amp;pages=207-221&amp;publication_year=1988&amp;author=Hofmann%2CF">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="43."><p class="c-article-references__text" id="ref-CR43">Abadi, M. et al. TensorFlow: a system for large-scale machine learning. In <i>Proc</i>. <i>12th USENIX Symposium on Operating Systems Design and Implementation (OSDI ’16)</i> 265–283 (2016).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="44."><p class="c-article-references__text" id="ref-CR44">De Tommasi, G. et al. Model-based plasma vertical stabilization and position control at EAST. <i>Fusion Eng. Des.</i> <b>129</b>, 152–157 (2018).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1016%2Fj.fusengdes.2018.02.020" aria-label="Article reference 44">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 44" href="http://scholar.google.com/scholar_lookup?&amp;title=Model-based%20plasma%20vertical%20stabilization%20and%20position%20control%20at%20EAST&amp;journal=Fusion%20Eng.%20Des.&amp;volume=129&amp;pages=152-157&amp;publication_year=2018&amp;author=Tommasi%2CG">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="45."><p class="c-article-references__text" id="ref-CR45">Gerkšič, S. &amp; De Tommasi, G. ITER plasma current and shape control using MPC. In <i>2016 IEEE Conference on Control Applications (CCA)</i> 599–604 (IEEE, 2016).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="46."><p class="c-article-references__text" id="ref-CR46">Boncagni, L. et al. Performance-based controller switching: an application to plasma current control at FTU. In <i>2015 54th IEEE Conference on Decision and Control (CDC)</i> 2319–2324 (IEEE, 2015).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="47."><p class="c-article-references__text" id="ref-CR47">Wakatsuki, T., Suzuki, T., Hayashi, N., Oyama, N. &amp; Ide, S. Safety factor profile control with reduced central solenoid flux consumption during plasma current ramp-up phase using a reinforcement learning technique. <i>Nucl. Fusion</i> <b>59</b>, 066022 (2019).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2019NucFu..59f6022W" aria-label="ADS reference 47">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BC1MXhtFynurvK" aria-label="CAS reference 47">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F1741-4326%2Fab1571" aria-label="Article reference 47">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 47" href="http://scholar.google.com/scholar_lookup?&amp;title=Safety%20factor%20profile%20control%20with%20reduced%20central%20solenoid%20flux%20consumption%20during%20plasma%20current%20ramp-up%20phase%20using%20a%20reinforcement%20learning%20technique&amp;journal=Nucl.%20Fusion&amp;volume=59&amp;publication_year=2019&amp;author=Wakatsuki%2CT&amp;author=Suzuki%2CT&amp;author=Hayashi%2CN&amp;author=Oyama%2CN&amp;author=Ide%2CS">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="48."><p class="c-article-references__text" id="ref-CR48">Wakatsuki, T., Suzuki, T., Oyama, N. &amp; Hayashi, N. Ion temperature gradient control using reinforcement learning technique. <i>Nucl. Fusion</i> <b>61</b>, 046036 (2021).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2021NucFu..61d6036W" aria-label="ADS reference 48">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BB3MXhtFWqtL7E" aria-label="CAS reference 48">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F1741-4326%2Fabe68d" aria-label="Article reference 48">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 48" href="http://scholar.google.com/scholar_lookup?&amp;title=Ion%20temperature%20gradient%20control%20using%20reinforcement%20learning%20technique&amp;journal=Nucl.%20Fusion&amp;volume=61&amp;publication_year=2021&amp;author=Wakatsuki%2CT&amp;author=Suzuki%2CT&amp;author=Oyama%2CN&amp;author=Hayashi%2CN">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="49."><p class="c-article-references__text" id="ref-CR49">Seo, J. et al. Feedforward beta control in the KSTAR tokamak by deep reinforcement learning. <i>Nucl. Fusion</i> <b>61</b>, 106010 (2021).</p><p class="c-article-references__links u-hide-print"><a data-track="click" data-track-action="outbound reference" data-track-label="link" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2021NucFu..61j6010S" aria-label="ADS reference 49">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="/articles/cas-redirect/1:CAS:528:DC%2BB3MXisFKntLzI" aria-label="CAS reference 49">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" href="https://doi.org/10.1088%2F1741-4326%2Fac121b" aria-label="Article reference 49">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" aria-label="Google Scholar reference 49" href="http://scholar.google.com/scholar_lookup?&amp;title=Feedforward%20beta%20control%20in%20the%20KSTAR%20tokamak%20by%20deep%20reinforcement%20learning&amp;journal=Nucl.%20Fusion&amp;volume=61&amp;publication_year=2021&amp;author=Seo%2CJ">
                    Google Scholar</a> 
                </p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="50."><p class="c-article-references__text" id="ref-CR50">Yang, F. et al. Launchpad: a programming model for distributed machine learning research. Preprint at <a href="https://arxiv.org/abs/2106.04516">https://arxiv.org/abs/2106.04516</a> (2021).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="51."><p class="c-article-references__text" id="ref-CR51">Muldal, A. et al. dm_env: a Python interface for reinforcement learning environments. <a href="http://github.com/deepmind/dm_env">http://github.com/deepmind/dm_env</a> (2019).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="52."><p class="c-article-references__text" id="ref-CR52">Reynolds, M. et al. Sonnet: TensorFlow-based neural network library. <a href="http://github.com/deepmind/sonnet">http://github.com/deepmind/sonnet</a> (2017).</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="53."><p class="c-article-references__text" id="ref-CR53">Martín A. et al. TensorFlow: large-scale machine learning on heterogeneous systems. Software available from <a href="https://www.tensorflow.org/">https://www.tensorflow.org/</a> 2015.</p></li><li class="c-article-references__item js-c-reading-companion-references-item" data-counter="54."><p class="c-article-references__text" id="ref-CR54">Hender, T. C. et al. Chapter 3: MHD stability, operational limits and disruptions. <i>Nucl. Fusion</i> <b>47</b>, S128–S202 (2007). </p></li></ol><p class="c-article-references__download u-hide-print"><a data-track="click" data-track-action="download citation references" data-track-label="link" href="https://citation-needed.springer.com/v2/references/10.1038/s41586-021-04301-9?format=refman&amp;flavour=references">Download references<svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-download"></use></svg></a></p></div></div></div></section></div><section data-title="Acknowledgements"><div class="c-article-section" id="Ack1-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="Ack1">Acknowledgements</h2><div class="c-article-section__content" id="Ack1-content"><p>We gratefully acknowledge the work and support of the TCV team (see the author list of Coda et al.<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 2" title="Coda, S. et al. Physics research on the TCV tokamak facility: from conventional to alternative scenarios and beyond. Nucl. Fusion 59, 112023 (2019)." href="/articles/s41586-021-04301-9#ref-CR2" id="ref-link-section-d263546778e1771">2</a></sup>) in enabling these experimental results. We thank C. Wüthrich and Y. Andrebe for support with the diagnostics. We thank C. Jones and E. Smith for strategic help and inspiration at the start of the project. We thank R. Ahamed, P. Komarek, V. Panneershelvam and F. Song for their support in the preparation and during this research. This work was supported in part by the Swiss National Science Foundation.</p></div></div></section><section aria-labelledby="author-information" data-title="Author information"><div class="c-article-section" id="author-information-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="author-information">Author information</h2><div class="c-article-section__content" id="author-information-content"><span class="c-article-author-information__subtitle u-visually-hidden" id="author-notes">Author notes</span><ol class="c-article-author-information__list"><li class="c-article-author-information__item" id="na1"><p>These authors contributed equally: Jonas Degrave, Federico Felici, Jonas Buchli, Michael Neunert, Brendan Tracey, Francesco Carpanese, Timo Ewalds, Roland Hafner, Martin Riedmiller</p></li></ol><h3 class="c-article__sub-heading" id="affiliations">Affiliations</h3><ol class="c-article-author-affiliation__list"><li id="Aff1"><p class="c-article-author-affiliation__address">DeepMind, London, UK</p><p class="c-article-author-affiliation__authors-list">Jonas Degrave, Jonas Buchli, Michael Neunert, Brendan Tracey, Francesco Carpanese, Timo Ewalds, Roland Hafner, Abbas Abdolmaleki, Diego de las Casas, Craig Donner, Leslie Fritz, Andrea Huber, James Keeling, Maria Tsimpoukelli, Jackie Kay, Seb Noury, David Pfau, Pushmeet Kohli, Koray Kavukcuoglu, Demis Hassabis &amp; Martin Riedmiller</p></li><li id="Aff2"><p class="c-article-author-affiliation__address">Swiss Plasma Center - EPFL, Lausanne, Switzerland</p><p class="c-article-author-affiliation__authors-list">Federico Felici, Francesco Carpanese, Cristian Galperti, Antoine Merle, Jean-Marc Moret, Federico Pesamosca, Olivier Sauter, Cristian Sommariva, Stefano Coda, Basil Duval &amp; Ambrogio Fasoli</p></li></ol><div class="u-js-hide u-hide-print" data-test="author-info"><span class="c-article__sub-heading">Authors</span><ol class="c-article-authors-search u-list-reset"><li id="auth-Jonas-Degrave"><span class="c-article-authors-search__title u-h3 js-search-name">Jonas Degrave</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Jonas%20Degrave%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Jonas%20Degrave" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Jonas%20Degrave%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Federico-Felici"><span class="c-article-authors-search__title u-h3 js-search-name">Federico Felici</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Federico%20Felici%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Federico%20Felici" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Federico%20Felici%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Jonas-Buchli"><span class="c-article-authors-search__title u-h3 js-search-name">Jonas Buchli</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Jonas%20Buchli%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Jonas%20Buchli" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Jonas%20Buchli%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Michael-Neunert"><span class="c-article-authors-search__title u-h3 js-search-name">Michael Neunert</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Michael%20Neunert%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Michael%20Neunert" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Michael%20Neunert%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Brendan-Tracey"><span class="c-article-authors-search__title u-h3 js-search-name">Brendan Tracey</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Brendan%20Tracey%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Brendan%20Tracey" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Brendan%20Tracey%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Francesco-Carpanese"><span class="c-article-authors-search__title u-h3 js-search-name">Francesco Carpanese</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Francesco%20Carpanese%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Francesco%20Carpanese" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Francesco%20Carpanese%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Timo-Ewalds"><span class="c-article-authors-search__title u-h3 js-search-name">Timo Ewalds</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Timo%20Ewalds%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Timo%20Ewalds" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Timo%20Ewalds%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Roland-Hafner"><span class="c-article-authors-search__title u-h3 js-search-name">Roland Hafner</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Roland%20Hafner%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Roland%20Hafner" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Roland%20Hafner%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Abbas-Abdolmaleki"><span class="c-article-authors-search__title u-h3 js-search-name">Abbas Abdolmaleki</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Abbas%20Abdolmaleki%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Abbas%20Abdolmaleki" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Abbas%20Abdolmaleki%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Diego-de_las_Casas"><span class="c-article-authors-search__title u-h3 js-search-name">Diego de las Casas</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Diego%20de%20las%20Casas%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Diego%20de%20las%20Casas" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Diego%20de%20las%20Casas%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Craig-Donner"><span class="c-article-authors-search__title u-h3 js-search-name">Craig Donner</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Craig%20Donner%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Craig%20Donner" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Craig%20Donner%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Leslie-Fritz"><span class="c-article-authors-search__title u-h3 js-search-name">Leslie Fritz</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Leslie%20Fritz%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Leslie%20Fritz" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Leslie%20Fritz%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Cristian-Galperti"><span class="c-article-authors-search__title u-h3 js-search-name">Cristian Galperti</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Cristian%20Galperti%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Cristian%20Galperti" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Cristian%20Galperti%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Andrea-Huber"><span class="c-article-authors-search__title u-h3 js-search-name">Andrea Huber</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Andrea%20Huber%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Andrea%20Huber" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Andrea%20Huber%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-James-Keeling"><span class="c-article-authors-search__title u-h3 js-search-name">James Keeling</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22James%20Keeling%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=James%20Keeling" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22James%20Keeling%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Maria-Tsimpoukelli"><span class="c-article-authors-search__title u-h3 js-search-name">Maria Tsimpoukelli</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Maria%20Tsimpoukelli%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Maria%20Tsimpoukelli" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Maria%20Tsimpoukelli%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Jackie-Kay"><span class="c-article-authors-search__title u-h3 js-search-name">Jackie Kay</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Jackie%20Kay%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Jackie%20Kay" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Jackie%20Kay%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Antoine-Merle"><span class="c-article-authors-search__title u-h3 js-search-name">Antoine Merle</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Antoine%20Merle%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Antoine%20Merle" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Antoine%20Merle%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Jean_Marc-Moret"><span class="c-article-authors-search__title u-h3 js-search-name">Jean-Marc Moret</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Jean-Marc%20Moret%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Jean-Marc%20Moret" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Jean-Marc%20Moret%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Seb-Noury"><span class="c-article-authors-search__title u-h3 js-search-name">Seb Noury</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Seb%20Noury%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Seb%20Noury" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Seb%20Noury%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Federico-Pesamosca"><span class="c-article-authors-search__title u-h3 js-search-name">Federico Pesamosca</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Federico%20Pesamosca%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Federico%20Pesamosca" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Federico%20Pesamosca%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-David-Pfau"><span class="c-article-authors-search__title u-h3 js-search-name">David Pfau</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22David%20Pfau%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=David%20Pfau" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22David%20Pfau%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Olivier-Sauter"><span class="c-article-authors-search__title u-h3 js-search-name">Olivier Sauter</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Olivier%20Sauter%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Olivier%20Sauter" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Olivier%20Sauter%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Cristian-Sommariva"><span class="c-article-authors-search__title u-h3 js-search-name">Cristian Sommariva</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Cristian%20Sommariva%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Cristian%20Sommariva" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Cristian%20Sommariva%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Stefano-Coda"><span class="c-article-authors-search__title u-h3 js-search-name">Stefano Coda</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Stefano%20Coda%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Stefano%20Coda" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Stefano%20Coda%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Basil-Duval"><span class="c-article-authors-search__title u-h3 js-search-name">Basil Duval</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Basil%20Duval%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Basil%20Duval" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Basil%20Duval%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Ambrogio-Fasoli"><span class="c-article-authors-search__title u-h3 js-search-name">Ambrogio Fasoli</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Ambrogio%20Fasoli%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Ambrogio%20Fasoli" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Ambrogio%20Fasoli%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Pushmeet-Kohli"><span class="c-article-authors-search__title u-h3 js-search-name">Pushmeet Kohli</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Pushmeet%20Kohli%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Pushmeet%20Kohli" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Pushmeet%20Kohli%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Koray-Kavukcuoglu"><span class="c-article-authors-search__title u-h3 js-search-name">Koray Kavukcuoglu</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Koray%20Kavukcuoglu%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Koray%20Kavukcuoglu" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Koray%20Kavukcuoglu%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Demis-Hassabis"><span class="c-article-authors-search__title u-h3 js-search-name">Demis Hassabis</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Demis%20Hassabis%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Demis%20Hassabis" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Demis%20Hassabis%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li><li id="auth-Martin-Riedmiller"><span class="c-article-authors-search__title u-h3 js-search-name">Martin Riedmiller</span><div class="c-article-authors-search__list"><div class="c-article-authors-search__item c-article-authors-search__list-item--left"><a href="/search?author=%22Martin%20Riedmiller%22" class="c-article-button" data-track="click" data-track-action="author link - publication" data-track-label="link">View author publications</a></div><div class="c-article-authors-search__item c-article-authors-search__list-item--right"><p class="search-in-title-js c-article-authors-search__text">You can also search for this author in
                        <span class="c-article-identifiers"><a class="c-article-identifiers__item" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=search&amp;term=Martin%20Riedmiller" data-track="click" data-track-action="author link - pubmed" data-track-label="link">PubMed</a><span class="u-hide"> </span><a class="c-article-identifiers__item" href="http://scholar.google.co.uk/scholar?as_q=&amp;num=10&amp;btnG=Search+Scholar&amp;as_epq=&amp;as_oq=&amp;as_eq=&amp;as_occt=any&amp;as_sauthors=%22Martin%20Riedmiller%22&amp;as_publication=&amp;as_ylo=&amp;as_yhi=&amp;as_allsubj=all&amp;hl=en" data-track="click" data-track-action="author link - scholar" data-track-label="link">Google Scholar</a></span></p></div></div></li></ol></div><h3 class="c-article__sub-heading" id="contributions">Contributions</h3><p>B.T., F.C., F.F., J.B., J.D., M.N., M.R., R.H. and T.E. contributed equally. D.P., F.F., J.B., J.D., M.R. and R.H. conceived the project. A.H., B.T., F.F., J.B., J.D., L.F., M.N. and M.R. led the project. A.M., B.T., C.D., C.S., F.C., F.F., F.P., J.B., J.-M.M., M.N. and O.S. developed the physics simulations. B.T., C.D., D.C., F.F., J.D., J. Kay, M.N., M.T. and T.E. integrated the physics simulations with the learning framework. A.A., B.T., J.D., J. Keeling, R.H. and T.E. developed the learning framework and performed learning experiments. C.G., D.C., F.F., J.B., J.D., M.N., S.N. and T.E. developed the real-time neural network interface. C.G., F.C., F.F., J.D. and S.C. integrated the real-time neural network with the control system and ran tokamak experiments. C.D., D.C., F.C., F.F., J.B., J. Keeling, M.N. and T.E. developed data-curation tools. B.T., C.G., F.C., F.F., J.B., J. Keeling, M.N., R.H. and T.E. developed and ran the data analysis. A.F., B.D., D.H., S.C., K.K. and P.K. consulted for the project. B.T., F.C., F.F., J.B., J.D., M.N., M.R., R.H. and T.E. wrote the manuscript.</p><h3 class="c-article__sub-heading" id="corresponding-author">Corresponding authors</h3><p id="corresponding-author-list">Correspondence to
                <a id="corresp-c1" href="mailto:federico.felici@epfl.ch">Federico Felici</a>, <a id="corresp-c2" href="mailto:buchli@deepmind.com">Jonas Buchli</a> or <a id="corresp-c3" href="mailto:btracey@deepmind.com">Brendan Tracey</a>.</p></div></div></section><section data-title="Ethics declarations"><div class="c-article-section" id="ethics-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="ethics">Ethics declarations</h2><div class="c-article-section__content" id="ethics-content">
              
                <h3 class="c-article__sub-heading" id="FPar2">Competing interests</h3>
                <p>B.T., F.C., F.F., J.B., J.D., M.N., R.H. and T.E. have filed a provisional patent application about the contents of this manuscript. The remaining authors declare no competing interests.</p>
              
            </div></div></section><section data-title="Peer review"><div class="c-article-section" id="peer-review-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="peer-review">Peer review</h2><div class="c-article-section__content" id="peer-review-content">
              
              
                <h3 class="c-article__sub-heading" id="FPar1">Peer review information</h3>
                <p><i>Nature</i> thanks Takuma Wakatsuki and the other, anonymous, reviewers for their contribution to the peer review of this work.</p>
              
            </div></div></section><section data-title="Additional information"><div class="c-article-section" id="additional-information-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="additional-information">Additional information</h2><div class="c-article-section__content" id="additional-information-content"><p><b>Publisher’s note</b> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></div></div></section><section data-title="Extended data figures and tables"><div class="c-article-section" id="Sec22-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="Sec22">Extended data figures and tables</h2><div class="c-article-section__content" id="Sec22-content"><div data-test="supplementary-info"><div id="figshareContainer" class="c-article-figshare-container" data-test="figshare-container"></div><div class="c-article-supplementary__item js-c-reading-companion-figures-item" data-test="supp-item" id="Fig5"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="/articles/s41586-021-04301-9/figures/5" data-supp-info-image="//media.springernature.com/lw685/springer-static/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig5_ESM.jpg">Extended Data Fig. 1 Pictures and illustration of the TCV.</a></h3><div class="c-article-supplementary__description" data-component="thumbnail-container"><p><b>a, b </b>Photographs showing the part of the TCV inside the bioshield. <b>c</b> CAD drawing of the vessel and coils of the TCV. <b>d</b> View inside the TCV (Alain Herzog/EPFL), showing the limiter tiling, baffles and central column.</p></div></div><div class="c-article-supplementary__item js-c-reading-companion-figures-item" data-test="supp-item" id="Fig6"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="/articles/s41586-021-04301-9/figures/6" data-supp-info-image="//media.springernature.com/lw685/springer-static/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig6_ESM.jpg">Extended Data Fig. 2 A larger overview of the shots in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig3">3</a>.</a></h3><div class="c-article-supplementary__description" data-component="thumbnail-container"><p>We plotted the reconstructed values for the normalized pressure <i>β</i><sub>p</sub> and safety factor <i>q</i><sub>A</sub>, along with the range of domain randomization these variables saw during training (in green), which can be found in Extended Data Table <a data-track="click" data-track-label="link" data-track-action="table anchor" href="/articles/s41586-021-04301-9#Tab2">2</a>. We also plot the growth rate, <i>γ</i>, and the plasma current, <i>I</i><sub>p</sub>, along with the associated target value. Where relevant, we plot the elongation <i>κ</i>, the neutral beam heating, the triangularity <i>δ</i> and the vertical position of the bottom X-point <i>Z</i><sub>X</sub> and its target.</p><p>
                          <a data-track="click" data-track-label="link" data-track-action="supplementary material anchor" href="/articles/s41586-021-04301-9#MOESM6">Source data</a>
                        </p></div></div><div class="c-article-supplementary__item js-c-reading-companion-figures-item" data-test="supp-item" id="Fig7"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="/articles/s41586-021-04301-9/figures/7" data-supp-info-image="//media.springernature.com/lw685/springer-static/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig7_ESM.jpg">Extended Data Fig. 3 Control variability.</a></h3><div class="c-article-supplementary__description" data-component="thumbnail-container"><p>To illustrate the variability of the performance that our deterministic controller achieves on the environment, we have plotted the trajectories of one policy that was used twice on the plant: in shot 70599 (in blue) and shot 70600 (in orange). The dotted line shows where the cross sections of the vessel are illustrated. The trajectories are shown from the handover at 0.0872 s until 0.65 s after the breakdown, after which, on shot 70600, the neutral beam heating was turned on and the two shots diverge. The green line shows the RMSE distance between the LCFS in the two experiments, providing a direct measure of the shape similarity between the two shots. This illustrates the repeatability of experiments both in shape parameters such as elongation <i>κ</i> and triangularity <i>δ</i> and in the error achieved with respect to the targets in plasma current <i>I</i><sub>p</sub> and the shape of the last closed-flux surface.</p><p>
                          <a data-track="click" data-track-label="link" data-track-action="supplementary material anchor" href="/articles/s41586-021-04301-9#MOESM7">Source data</a>
                        </p></div></div><div class="c-article-supplementary__item js-c-reading-companion-figures-item" data-test="supp-item" id="Fig8"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="/articles/s41586-021-04301-9/figures/8" data-supp-info-image="//media.springernature.com/lw685/springer-static/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig8_ESM.jpg">Extended Data Fig. 4 Further observations.</a></h3><div class="c-article-supplementary__description" data-component="thumbnail-container"><p><b>a</b>, When asked to stabilize the plasma without further specifications, the agent creates a round shape. The agent is in control from <i>t</i> = 0.45 and changes the shape while trying to attain <i>R</i><sub>a</sub> and <i>Z</i><sub>a</sub> targets. This discovered behaviour is indeed a good solution, as this round plasma is intrinsically stable with a growth rate <i>γ</i> &lt; 0. <b>b</b>, When not given a reward to have similar current on both ohmic coils, the algorithm tended to use the E coils to obtain the same effect as the OH001 coil. This is indeed possible, as can be seen by the coil positions in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig1">1g</a>, but causes electromagnetic forces on the machine structures. Therefore, in later shots, a reward was added to keep the current in both ohmic coils close together. <b>c</b>, Voltage requests by the policy to avoid the E3 coil from sticking when crossing 0 A. As can be seen in, for example, Extended Data Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig8">4b</a>, the currents can get stuck on 0 A for low voltage requests, a consequence of how these requests are handled by the power system. As this behaviour was hard to model, we introduced a reward to keep the coil currents away from 0 A. The control policy produces a high voltage request to move through this region quickly. <b>d</b>, An illustration of the difference in cross sections between two different shots, in which the only difference is that the policy on the right was trained with a further reward for avoiding X-points in vacuum.</p><p>
                          <a data-track="click" data-track-label="link" data-track-action="supplementary material anchor" href="/articles/s41586-021-04301-9#MOESM8">Source data</a>
                        </p></div></div><div class="c-article-supplementary__item js-c-reading-companion-figures-item" data-test="supp-item" id="Fig9"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="/articles/s41586-021-04301-9/figures/9" data-supp-info-image="//media.springernature.com/lw685/springer-static/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_Fig9_ESM.jpg">Extended Data Fig. 5 Training progress.</a></h3><div class="c-article-supplementary__description" data-component="thumbnail-container"><p>Episodic reward for the deterministic policy smoothed across 20 episodes with parameter variations enabled, in which 100 means that all objectives are perfectly met.  <b>a</b> comparison of the learning curve for the capability benchmark (as shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="/articles/s41586-021-04301-9#Fig2">2</a>) using our asymmetric actor-critic versus a symmetric actor-critic, in which the critic is using the same real-time-capable feedforward network as the actor. In blue is the performance with the default critic of 718,337 parameters. In orange, we show the symmetric version, in which the critic has the same feedforward structure and size (266,497 parameters) as the policy (266,280 parameters). When we keep the feedforward structure of the symmetric critic and scale up the critic, we find that widening its width to 512 units (in green, 926,209 parameters) or even 1,024 units (in red, 3,425,281 parameters) does not bridge the performance gap with the smaller recurrent critic. <b>b</b> comparison between using various amounts of actors for stabilizing a mildly elongated plasma. Although the policies in this paper were trained with 5,000 actors, this comparison shows that, at least for simpler cases, the same level of performance can be achieved with much lower computational resources.</p><p>
                          <a data-track="click" data-track-label="link" data-track-action="supplementary material anchor" href="/articles/s41586-021-04301-9#MOESM9">Source data</a>
                        </p></div></div><div class="c-article-supplementary__item" data-test="supp-item"><div class="c-article-table" data-test="inline-table" data-container-section="table" id="table-1"><figure><figcaption class="c-article-table__figcaption"><b id="Tab1" data-test="table-caption">Extended Data Table 1 Performance metrics of experiments</b></figcaption><div class="u-text-right u-hide-print"><a class="c-article__pill-button" data-test="table-link" data-track="click" data-track-action="view table" data-track-label="button" rel="nofollow" href="/articles/s41586-021-04301-9/tables/1" aria-label="Full size table 1"><span>Full size table</span><svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-chevron-right"></use></svg></a></div></figure></div></div><div class="c-article-supplementary__item" data-test="supp-item"><div class="c-article-table" data-test="inline-table" data-container-section="table" id="table-2"><figure><figcaption class="c-article-table__figcaption"><b id="Tab2" data-test="table-caption">Extended Data Table 2 Simulation parameters for actuator, sensor and current diffusion models</b></figcaption><div class="u-text-right u-hide-print"><a class="c-article__pill-button" data-test="table-link" data-track="click" data-track-action="view table" data-track-label="button" rel="nofollow" href="/articles/s41586-021-04301-9/tables/2" aria-label="Full size table 2"><span>Full size table</span><svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-chevron-right"></use></svg></a></div></figure></div></div><div class="c-article-supplementary__item" data-test="supp-item"><div class="c-article-table" data-test="inline-table" data-container-section="table" id="table-3"><figure><figcaption class="c-article-table__figcaption"><b id="Tab3" data-test="table-caption">Extended Data Table 3 Rewards used in the experiments</b></figcaption><div class="u-text-right u-hide-print"><a class="c-article__pill-button" data-test="table-link" data-track="click" data-track-action="view table" data-track-label="button" rel="nofollow" href="/articles/s41586-021-04301-9/tables/3" aria-label="Full size table 3"><span>Full size table</span><svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-chevron-right"></use></svg></a></div></figure></div></div><div class="c-article-supplementary__item" data-test="supp-item"><div class="c-article-table" data-test="inline-table" data-container-section="table" id="table-4"><figure><figcaption class="c-article-table__figcaption"><b id="Tab4" data-test="table-caption">Extended Data Table 4 Reward components</b></figcaption><div class="u-text-right u-hide-print"><a class="c-article__pill-button" data-test="table-link" data-track="click" data-track-action="view table" data-track-label="button" rel="nofollow" href="/articles/s41586-021-04301-9/tables/4" aria-label="Full size table 4"><span>Full size table</span><svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-chevron-right"></use></svg></a></div></figure></div></div><div class="c-article-supplementary__item" data-test="supp-item"><div class="c-article-table" data-test="inline-table" data-container-section="table" id="table-5"><figure><figcaption class="c-article-table__figcaption"><b id="Tab5" data-test="table-caption">Extended Data Table 5 Reward elements</b></figcaption><div class="u-text-right u-hide-print"><a class="c-article__pill-button" data-test="table-link" data-track="click" data-track-action="view table" data-track-label="button" rel="nofollow" href="/articles/s41586-021-04301-9/tables/5" aria-label="Full size table 5"><span>Full size table</span><svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-chevron-right"></use></svg></a></div></figure></div></div></div></div></div></section><section data-title="Supplementary information"><div class="c-article-section" id="Sec23-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="Sec23">Supplementary information</h2><div class="c-article-section__content" id="Sec23-content"><div data-test="supplementary-info">
                  
                  
                <div class="c-article-supplementary__item" data-test="supp-item" id="MOESM1"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_MOESM1_ESM.pdf" data-supp-info-image="">Supplementary Information</a></h3><div class="c-article-supplementary__description" data-component="thumbnail-container"><p>This file contains an overview of the files located in the accompanying zipped Supplementary Data folder.</p></div></div><div class="c-article-supplementary__item" data-test="supp-item" id="MOESM2"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_MOESM2_ESM.zip" data-supp-info-image="">Supplementary Data</a></h3></div></div></div></div></section><section data-title="Source data"><div class="c-article-section" id="Sec24-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="Sec24">Source data</h2><div class="c-article-section__content" id="Sec24-content"><div data-test="supplementary-info">
                  
                  
                  
                  
                  
                  
                  
                <div class="c-article-supplementary__item" data-test="supp-item" id="MOESM3"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_MOESM3_ESM.txt" data-supp-info-image="">Source Data Fig. 2</a></h3></div><div class="c-article-supplementary__item" data-test="supp-item" id="MOESM4"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_MOESM4_ESM.txt" data-supp-info-image="">Source Data Fig. 3</a></h3></div><div class="c-article-supplementary__item" data-test="supp-item" id="MOESM5"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_MOESM5_ESM.txt" data-supp-info-image="">Source Data Fig. 4</a></h3></div><div class="c-article-supplementary__item" data-test="supp-item" id="MOESM6"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_MOESM6_ESM.txt" data-supp-info-image="">Source Data Extended Data Fig. 2</a></h3></div><div class="c-article-supplementary__item" data-test="supp-item" id="MOESM7"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_MOESM7_ESM.txt" data-supp-info-image="">Source Data Extended Data Fig. 3</a></h3></div><div class="c-article-supplementary__item" data-test="supp-item" id="MOESM8"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_MOESM8_ESM.txt" data-supp-info-image="">Source Data Extended Data Fig. 4</a></h3></div><div class="c-article-supplementary__item" data-test="supp-item" id="MOESM9"><h3 class="c-article-supplementary__title u-h3"><a class="print-link" data-track="click" data-track-action="view supplementary info" data-track-label="link" data-test="supp-info-link" href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-021-04301-9/MediaObjects/41586_2021_4301_MOESM9_ESM.txt" data-supp-info-image="">Source Data Extended Data Fig. 5</a></h3></div></div></div></div></section><section data-title="Rights and permissions"><div class="c-article-section" id="rightslink-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="rightslink">Rights and permissions</h2><div class="c-article-section__content" id="rightslink-content">
                <p><b>Open Access</b>  This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <a href="http://creativecommons.org/licenses/by/4.0/" rel="license">http://creativecommons.org/licenses/by/4.0/</a>.</p>
              <p class="c-article-rights"><a data-track="click" data-track-action="view rights and permissions" data-track-label="link" href="https://s100.copyright.com/AppDispatchServlet?title=Magnetic%20control%20of%20tokamak%20plasmas%20through%20deep%20reinforcement%20learning&amp;author=Jonas%20Degrave%20et%20al&amp;contentID=10.1038%2Fs41586-021-04301-9&amp;copyright=The%20Author%28s%29&amp;publication=0028-0836&amp;publicationDate=2022-02-16&amp;publisherName=SpringerNature&amp;orderBeanReset=true&amp;oa=CC%20BY">Reprints and Permissions</a></p></div></div></section><section aria-labelledby="article-info" data-title="About this article"><div class="c-article-section" id="article-info-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="article-info">About this article</h2><div class="c-article-section__content" id="article-info-content"><div class="c-bibliographic-information"><div class="u-hide-print c-bibliographic-information__column c-bibliographic-information__column--border"><a data-crossmark="10.1038/s41586-021-04301-9" target="_blank" rel="noopener" href="https://crossmark.crossref.org/dialog/?doi=10.1038/s41586-021-04301-9" data-track="click" data-track-action="Click Crossmark" data-track-label="link" data-test="crossmark"><img width="57" height="81" alt="Verify currency and authenticity via CrossMark" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjgxIiB3aWR0aD0iNTciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJtMTcuMzUgMzUuNDUgMjEuMy0xNC4ydi0xNy4wM2gtMjEuMyIgZmlsbD0iIzk4OTg5OCIvPjxwYXRoIGQ9Im0zOC42NSAzNS40NS0yMS4zLTE0LjJ2LTE3LjAzaDIxLjMiIGZpbGw9IiM3NDc0NzQiLz48cGF0aCBkPSJtMjggLjVjLTEyLjk4IDAtMjMuNSAxMC41Mi0yMy41IDIzLjVzMTAuNTIgMjMuNSAyMy41IDIzLjUgMjMuNS0xMC41MiAyMy41LTIzLjVjMC02LjIzLTIuNDgtMTIuMjEtNi44OC0xNi42Mi00LjQxLTQuNC0xMC4zOS02Ljg4LTE2LjYyLTYuODh6bTAgNDEuMjVjLTkuOCAwLTE3Ljc1LTcuOTUtMTcuNzUtMTcuNzVzNy45NS0xNy43NSAxNy43NS0xNy43NSAxNy43NSA3Ljk1IDE3Ljc1IDE3Ljc1YzAgNC43MS0xLjg3IDkuMjItNS4yIDEyLjU1cy03Ljg0IDUuMi0xMi41NSA1LjJ6IiBmaWxsPSIjNTM1MzUzIi8+PHBhdGggZD0ibTQxIDM2Yy01LjgxIDYuMjMtMTUuMjMgNy40NS0yMi40MyAyLjktNy4yMS00LjU1LTEwLjE2LTEzLjU3LTcuMDMtMjEuNWwtNC45Mi0zLjExYy00Ljk1IDEwLjctMS4xOSAyMy40MiA4Ljc4IDI5LjcxIDkuOTcgNi4zIDIzLjA3IDQuMjIgMzAuNi00Ljg2eiIgZmlsbD0iIzljOWM5YyIvPjxwYXRoIGQ9Im0uMiA1OC40NWMwLS43NS4xMS0xLjQyLjMzLTIuMDFzLjUyLTEuMDkuOTEtMS41Yy4zOC0uNDEuODMtLjczIDEuMzQtLjk0LjUxLS4yMiAxLjA2LS4zMiAxLjY1LS4zMi41NiAwIDEuMDYuMTEgMS41MS4zNS40NC4yMy44MS41IDEuMS44MWwtLjkxIDEuMDFjLS4yNC0uMjQtLjQ5LS40Mi0uNzUtLjU2LS4yNy0uMTMtLjU4LS4yLS45My0uMi0uMzkgMC0uNzMuMDgtMS4wNS4yMy0uMzEuMTYtLjU4LjM3LS44MS42Ni0uMjMuMjgtLjQxLjYzLS41MyAxLjA0LS4xMy40MS0uMTkuODgtLjE5IDEuMzkgMCAxLjA0LjIzIDEuODYuNjggMi40Ni40NS41OSAxLjA2Ljg4IDEuODQuODguNDEgMCAuNzctLjA3IDEuMDctLjIzcy41OS0uMzkuODUtLjY4bC45MSAxYy0uMzguNDMtLjguNzYtMS4yOC45OS0uNDcuMjItMSAuMzQtMS41OC4zNC0uNTkgMC0xLjEzLS4xLTEuNjQtLjMxLS41LS4yLS45NC0uNTEtMS4zMS0uOTEtLjM4LS40LS42Ny0uOS0uODgtMS40OC0uMjItLjU5LS4zMy0xLjI2LS4zMy0yLjAyem04LjQtNS4zM2gxLjYxdjIuNTRsLS4wNSAxLjMzYy4yOS0uMjcuNjEtLjUxLjk2LS43MnMuNzYtLjMxIDEuMjQtLjMxYy43MyAwIDEuMjcuMjMgMS42MS43MS4zMy40Ny41IDEuMTQuNSAyLjAydjQuMzFoLTEuNjF2LTQuMWMwLS41Ny0uMDgtLjk3LS4yNS0xLjIxLS4xNy0uMjMtLjQ1LS4zNS0uODMtLjM1LS4zIDAtLjU2LjA4LS43OS4yMi0uMjMuMTUtLjQ5LjM2LS43OC42NHY0LjhoLTEuNjF6bTcuMzcgNi40NWMwLS41Ni4wOS0xLjA2LjI2LTEuNTEuMTgtLjQ1LjQyLS44My43MS0xLjE0LjI5LS4zLjYzLS41NCAxLjAxLS43MS4zOS0uMTcuNzgtLjI1IDEuMTgtLjI1LjQ3IDAgLjg4LjA4IDEuMjMuMjQuMzYuMTYuNjUuMzguODkuNjdzLjQyLjYzLjU0IDEuMDNjLjEyLjQxLjE4Ljg0LjE4IDEuMzIgMCAuMzItLjAyLjU3LS4wNy43NmgtNC4zNmMuMDcuNjIuMjkgMS4xLjY1IDEuNDQuMzYuMzMuODIuNSAxLjM4LjUuMjkgMCAuNTctLjA0LjgzLS4xM3MuNTEtLjIxLjc2LS4zN2wuNTUgMS4wMWMtLjMzLjIxLS42OS4zOS0xLjA5LjUzLS40MS4xNC0uODMuMjEtMS4yNi4yMS0uNDggMC0uOTItLjA4LTEuMzQtLjI1LS40MS0uMTYtLjc2LS40LTEuMDctLjctLjMxLS4zMS0uNTUtLjY5LS43Mi0xLjEzLS4xOC0uNDQtLjI2LS45NS0uMjYtMS41MnptNC42LS42MmMwLS41NS0uMTEtLjk4LS4zNC0xLjI4LS4yMy0uMzEtLjU4LS40Ny0xLjA2LS40Ny0uNDEgMC0uNzcuMTUtMS4wNy40NS0uMzEuMjktLjUuNzMtLjU4IDEuM3ptMi41LjYyYzAtLjU3LjA5LTEuMDguMjgtMS41My4xOC0uNDQuNDMtLjgyLjc1LTEuMTNzLjY5LS41NCAxLjEtLjcxYy40Mi0uMTYuODUtLjI0IDEuMzEtLjI0LjQ1IDAgLjg0LjA4IDEuMTcuMjNzLjYxLjM0Ljg1LjU3bC0uNzcgMS4wMmMtLjE5LS4xNi0uMzgtLjI4LS41Ni0uMzctLjE5LS4wOS0uMzktLjE0LS42MS0uMTQtLjU2IDAtMS4wMS4yMS0xLjM1LjYzLS4zNS40MS0uNTIuOTctLjUyIDEuNjcgMCAuNjkuMTcgMS4yNC41MSAxLjY2LjM0LjQxLjc4LjYyIDEuMzIuNjIuMjggMCAuNTQtLjA2Ljc4LS4xNy4yNC0uMTIuNDUtLjI2LjY0LS40MmwuNjcgMS4wM2MtLjMzLjI5LS42OS41MS0xLjA4LjY1LS4zOS4xNS0uNzguMjMtMS4xOC4yMy0uNDYgMC0uOS0uMDgtMS4zMS0uMjQtLjQtLjE2LS43NS0uMzktMS4wNS0uN3MtLjUzLS42OS0uNy0xLjEzYy0uMTctLjQ1LS4yNS0uOTYtLjI1LTEuNTN6bTYuOTEtNi40NWgxLjU4djYuMTdoLjA1bDIuNTQtMy4xNmgxLjc3bC0yLjM1IDIuOCAyLjU5IDQuMDdoLTEuNzVsLTEuNzctMi45OC0xLjA4IDEuMjN2MS43NWgtMS41OHptMTMuNjkgMS4yN2MtLjI1LS4xMS0uNS0uMTctLjc1LS4xNy0uNTggMC0uODcuMzktLjg3IDEuMTZ2Ljc1aDEuMzR2MS4yN2gtMS4zNHY1LjZoLTEuNjF2LTUuNmgtLjkydi0xLjJsLjkyLS4wN3YtLjcyYzAtLjM1LjA0LS42OC4xMy0uOTguMDgtLjMxLjIxLS41Ny40LS43OXMuNDItLjM5LjcxLS41MWMuMjgtLjEyLjYzLS4xOCAxLjA0LS4xOC4yNCAwIC40OC4wMi42OS4wNy4yMi4wNS40MS4xLjU3LjE3em0uNDggNS4xOGMwLS41Ny4wOS0xLjA4LjI3LTEuNTMuMTctLjQ0LjQxLS44Mi43Mi0xLjEzLjMtLjMxLjY1LS41NCAxLjA0LS43MS4zOS0uMTYuOC0uMjQgMS4yMy0uMjRzLjg0LjA4IDEuMjQuMjRjLjQuMTcuNzQuNCAxLjA0Ljcxcy41NC42OS43MiAxLjEzYy4xOS40NS4yOC45Ni4yOCAxLjUzcy0uMDkgMS4wOC0uMjggMS41M2MtLjE4LjQ0LS40Mi44Mi0uNzIgMS4xM3MtLjY0LjU0LTEuMDQuNy0uODEuMjQtMS4yNC4yNC0uODQtLjA4LTEuMjMtLjI0LS43NC0uMzktMS4wNC0uN2MtLjMxLS4zMS0uNTUtLjY5LS43Mi0xLjEzLS4xOC0uNDUtLjI3LS45Ni0uMjctMS41M3ptMS42NSAwYzAgLjY5LjE0IDEuMjQuNDMgMS42Ni4yOC40MS42OC42MiAxLjE4LjYyLjUxIDAgLjktLjIxIDEuMTktLjYyLjI5LS40Mi40NC0uOTcuNDQtMS42NiAwLS43LS4xNS0xLjI2LS40NC0xLjY3LS4yOS0uNDItLjY4LS42My0xLjE5LS42My0uNSAwLS45LjIxLTEuMTguNjMtLjI5LjQxLS40My45Ny0uNDMgMS42N3ptNi40OC0zLjQ0aDEuMzNsLjEyIDEuMjFoLjA1Yy4yNC0uNDQuNTQtLjc5Ljg4LTEuMDIuMzUtLjI0LjctLjM2IDEuMDctLjM2LjMyIDAgLjU5LjA1Ljc4LjE0bC0uMjggMS40LS4zMy0uMDljLS4xMS0uMDEtLjIzLS4wMi0uMzgtLjAyLS4yNyAwLS41Ni4xLS44Ni4zMXMtLjU1LjU4LS43NyAxLjF2NC4yaC0xLjYxem0tNDcuODcgMTVoMS42MXY0LjFjMCAuNTcuMDguOTcuMjUgMS4yLjE3LjI0LjQ0LjM1LjgxLjM1LjMgMCAuNTctLjA3LjgtLjIyLjIyLS4xNS40Ny0uMzkuNzMtLjczdi00LjdoMS42MXY2Ljg3aC0xLjMybC0uMTItMS4wMWgtLjA0Yy0uMy4zNi0uNjMuNjQtLjk4Ljg2LS4zNS4yMS0uNzYuMzItMS4yNC4zMi0uNzMgMC0xLjI3LS4yNC0xLjYxLS43MS0uMzMtLjQ3LS41LTEuMTQtLjUtMi4wMnptOS40NiA3LjQzdjIuMTZoLTEuNjF2LTkuNTloMS4zM2wuMTIuNzJoLjA1Yy4yOS0uMjQuNjEtLjQ1Ljk3LS42My4zNS0uMTcuNzItLjI2IDEuMS0uMjYuNDMgMCAuODEuMDggMS4xNS4yNC4zMy4xNy42MS40Ljg0LjcxLjI0LjMxLjQxLjY4LjUzIDEuMTEuMTMuNDIuMTkuOTEuMTkgMS40NCAwIC41OS0uMDkgMS4xMS0uMjUgMS41Ny0uMTYuNDctLjM4Ljg1LS42NSAxLjE2LS4yNy4zMi0uNTguNTYtLjk0LjczLS4zNS4xNi0uNzIuMjUtMS4xLjI1LS4zIDAtLjYtLjA3LS45LS4ycy0uNTktLjMxLS44Ny0uNTZ6bTAtMi4zYy4yNi4yMi41LjM3LjczLjQ1LjI0LjA5LjQ2LjEzLjY2LjEzLjQ2IDAgLjg0LS4yIDEuMTUtLjYuMzEtLjM5LjQ2LS45OC40Ni0xLjc3IDAtLjY5LS4xMi0xLjIyLS4zNS0xLjYxLS4yMy0uMzgtLjYxLS41Ny0xLjEzLS41Ny0uNDkgMC0uOTkuMjYtMS41Mi43N3ptNS44Ny0xLjY5YzAtLjU2LjA4LTEuMDYuMjUtMS41MS4xNi0uNDUuMzctLjgzLjY1LTEuMTQuMjctLjMuNTgtLjU0LjkzLS43MXMuNzEtLjI1IDEuMDgtLjI1Yy4zOSAwIC43My4wNyAxIC4yLjI3LjE0LjU0LjMyLjgxLjU1bC0uMDYtMS4xdi0yLjQ5aDEuNjF2OS44OGgtMS4zM2wtLjExLS43NGgtLjA2Yy0uMjUuMjUtLjU0LjQ2LS44OC42NC0uMzMuMTgtLjY5LjI3LTEuMDYuMjctLjg3IDAtMS41Ni0uMzItMi4wNy0uOTVzLS43Ni0xLjUxLS43Ni0yLjY1em0xLjY3LS4wMWMwIC43NC4xMyAxLjMxLjQgMS43LjI2LjM4LjY1LjU4IDEuMTUuNTguNTEgMCAuOTktLjI2IDEuNDQtLjc3di0zLjIxYy0uMjQtLjIxLS40OC0uMzYtLjctLjQ1LS4yMy0uMDgtLjQ2LS4xMi0uNy0uMTItLjQ1IDAtLjgyLjE5LTEuMTMuNTktLjMxLjM5LS40Ni45NS0uNDYgMS42OHptNi4zNSAxLjU5YzAtLjczLjMyLTEuMy45Ny0xLjcxLjY0LS40IDEuNjctLjY4IDMuMDgtLjg0IDAtLjE3LS4wMi0uMzQtLjA3LS41MS0uMDUtLjE2LS4xMi0uMy0uMjItLjQzcy0uMjItLjIyLS4zOC0uM2MtLjE1LS4wNi0uMzQtLjEtLjU4LS4xLS4zNCAwLS42OC4wNy0xIC4ycy0uNjMuMjktLjkzLjQ3bC0uNTktMS4wOGMuMzktLjI0LjgxLS40NSAxLjI4LS42My40Ny0uMTcuOTktLjI2IDEuNTQtLjI2Ljg2IDAgMS41MS4yNSAxLjkzLjc2cy42MyAxLjI1LjYzIDIuMjF2NC4wN2gtMS4zMmwtLjEyLS43NmgtLjA1Yy0uMy4yNy0uNjMuNDgtLjk4LjY2cy0uNzMuMjctMS4xNC4yN2MtLjYxIDAtMS4xLS4xOS0xLjQ4LS41Ni0uMzgtLjM2LS41Ny0uODUtLjU3LTEuNDZ6bTEuNTctLjEyYzAgLjMuMDkuNTMuMjcuNjcuMTkuMTQuNDIuMjEuNzEuMjEuMjggMCAuNTQtLjA3Ljc3LS4ycy40OC0uMzEuNzMtLjU2di0xLjU0Yy0uNDcuMDYtLjg2LjEzLTEuMTguMjMtLjMxLjA5LS41Ny4xOS0uNzYuMzFzLS4zMy4yNS0uNDEuNGMtLjA5LjE1LS4xMy4zMS0uMTMuNDh6bTYuMjktMy42M2gtLjk4di0xLjJsMS4wNi0uMDcuMi0xLjg4aDEuMzR2MS44OGgxLjc1djEuMjdoLTEuNzV2My4yOGMwIC44LjMyIDEuMi45NyAxLjIuMTIgMCAuMjQtLjAxLjM3LS4wNC4xMi0uMDMuMjQtLjA3LjM0LS4xMWwuMjggMS4xOWMtLjE5LjA2LS40LjEyLS42NC4xNy0uMjMuMDUtLjQ5LjA4LS43Ni4wOC0uNCAwLS43NC0uMDYtMS4wMi0uMTgtLjI3LS4xMy0uNDktLjMtLjY3LS41Mi0uMTctLjIxLS4zLS40OC0uMzctLjc4LS4wOC0uMy0uMTItLjY0LS4xMi0xLjAxem00LjM2IDIuMTdjMC0uNTYuMDktMS4wNi4yNy0xLjUxcy40MS0uODMuNzEtMS4xNGMuMjktLjMuNjMtLjU0IDEuMDEtLjcxLjM5LS4xNy43OC0uMjUgMS4xOC0uMjUuNDcgMCAuODguMDggMS4yMy4yNC4zNi4xNi42NS4zOC44OS42N3MuNDIuNjMuNTQgMS4wM2MuMTIuNDEuMTguODQuMTggMS4zMiAwIC4zMi0uMDIuNTctLjA3Ljc2aC00LjM3Yy4wOC42Mi4yOSAxLjEuNjUgMS40NC4zNi4zMy44Mi41IDEuMzguNS4zIDAgLjU4LS4wNC44NC0uMTMuMjUtLjA5LjUxLS4yMS43Ni0uMzdsLjU0IDEuMDFjLS4zMi4yMS0uNjkuMzktMS4wOS41M3MtLjgyLjIxLTEuMjYuMjFjLS40NyAwLS45Mi0uMDgtMS4zMy0uMjUtLjQxLS4xNi0uNzctLjQtMS4wOC0uNy0uMy0uMzEtLjU0LS42OS0uNzItMS4xMy0uMTctLjQ0LS4yNi0uOTUtLjI2LTEuNTJ6bTQuNjEtLjYyYzAtLjU1LS4xMS0uOTgtLjM0LTEuMjgtLjIzLS4zMS0uNTgtLjQ3LTEuMDYtLjQ3LS40MSAwLS43Ny4xNS0xLjA4LjQ1LS4zMS4yOS0uNS43My0uNTcgMS4zem0zLjAxIDIuMjNjLjMxLjI0LjYxLjQzLjkyLjU3LjMuMTMuNjMuMi45OC4yLjM4IDAgLjY1LS4wOC44My0uMjNzLjI3LS4zNS4yNy0uNmMwLS4xNC0uMDUtLjI2LS4xMy0uMzctLjA4LS4xLS4yLS4yLS4zNC0uMjgtLjE0LS4wOS0uMjktLjE2LS40Ny0uMjNsLS41My0uMjJjLS4yMy0uMDktLjQ2LS4xOC0uNjktLjMtLjIzLS4xMS0uNDQtLjI0LS42Mi0uNHMtLjMzLS4zNS0uNDUtLjU1Yy0uMTItLjIxLS4xOC0uNDYtLjE4LS43NSAwLS42MS4yMy0xLjEuNjgtMS40OS40NC0uMzggMS4wNi0uNTcgMS44My0uNTcuNDggMCAuOTEuMDggMS4yOS4yNXMuNzEuMzYuOTkuNTdsLS43NC45OGMtLjI0LS4xNy0uNDktLjMyLS43My0uNDItLjI1LS4xMS0uNTEtLjE2LS43OC0uMTYtLjM1IDAtLjYuMDctLjc2LjIxLS4xNy4xNS0uMjUuMzMtLjI1LjU0IDAgLjE0LjA0LjI2LjEyLjM2cy4xOC4xOC4zMS4yNmMuMTQuMDcuMjkuMTQuNDYuMjFsLjU0LjE5Yy4yMy4wOS40Ny4xOC43LjI5cy40NC4yNC42NC40Yy4xOS4xNi4zNC4zNS40Ni41OC4xMS4yMy4xNy41LjE3LjgyIDAgLjMtLjA2LjU4LS4xNy44My0uMTIuMjYtLjI5LjQ4LS41MS42OC0uMjMuMTktLjUxLjM0LS44NC40NS0uMzQuMTEtLjcyLjE3LTEuMTUuMTctLjQ4IDAtLjk1LS4wOS0xLjQxLS4yNy0uNDYtLjE5LS44Ni0uNDEtMS4yLS42OHoiIGZpbGw9IiM1MzUzNTMiLz48L2c+PC9zdmc+"></a></div><div class="c-bibliographic-information__column"><h3 class="c-article__sub-heading" id="citeas">Cite this article</h3><p class="c-bibliographic-information__citation">Degrave, J., Felici, F., Buchli, J. <i>et al.</i> Magnetic control of tokamak plasmas through deep reinforcement learning.
                    <i>Nature</i> <b>602, </b>414–419 (2022). https://doi.org/10.1038/s41586-021-04301-9</p><p class="c-bibliographic-information__download-citation u-hide-print"><a data-test="citation-link" data-track="click" data-track-action="download article citation" data-track-label="link" data-track-external="" href="https://citation-needed.springer.com/v2/references/10.1038/s41586-021-04301-9?format=refman&amp;flavour=citation">Download citation<svg width="16" height="16" focusable="false" role="img" aria-hidden="true" class="u-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-download"></use></svg></a></p><ul class="c-bibliographic-information__list" data-test="publication-history"><li class="c-bibliographic-information__list-item"><p>Received<span class="u-hide">: </span><span class="c-bibliographic-information__value"><time datetime="2021-07-14">14 July 2021</time></span></p></li><li class="c-bibliographic-information__list-item"><p>Accepted<span class="u-hide">: </span><span class="c-bibliographic-information__value"><time datetime="2021-12-01">01 December 2021</time></span></p></li><li class="c-bibliographic-information__list-item"><p>Published<span class="u-hide">: </span><span class="c-bibliographic-information__value"><time datetime="2022-02-16">16 February 2022</time></span></p></li><li class="c-bibliographic-information__list-item"><p>Issue Date<span class="u-hide">: </span><span class="c-bibliographic-information__value"><time datetime="2022-02-17">17 February 2022</time></span></p></li><li class="c-bibliographic-information__list-item c-bibliographic-information__list-item--doi"><p><abbr title="Digital Object Identifier">DOI</abbr><span class="u-hide">: </span><span class="c-bibliographic-information__value">https://doi.org/10.1038/s41586-021-04301-9</span></p></li></ul><div data-component="share-box"><div class="c-article-share-box u-display-none" hidden=""><h3 class="c-article__sub-heading">Share this article</h3><p class="c-article-share-box__description">Anyone you share the following link with will be able to read this content:</p><button class="js-get-share-url c-article-share-box__button" id="get-share-url" data-track="click" data-track-label="button" data-track-external="" data-track-action="get shareable link">Get shareable link</button><div class="js-no-share-url-container u-display-none" hidden=""><p class="js-c-article-share-box__no-sharelink-info c-article-share-box__no-sharelink-info">Sorry, a shareable link is not currently available for this article.</p></div><div class="js-share-url-container u-display-none" hidden=""><p class="js-share-url c-article-share-box__only-read-input" id="share-url" data-track="click" data-track-label="button" data-track-action="select share url"></p><button class="js-copy-share-url c-article-share-box__button--link-like" id="copy-share-url" data-track="click" data-track-label="button" data-track-action="copy share url" data-track-external="">Copy to clipboard</button></div><p class="js-c-article-share-box__additional-info c-article-share-box__additional-info">
                            Provided by the Springer Nature SharedIt content-sharing initiative
                        </p></div></div><div data-component="article-info-list"></div></div></div></div></div></section>

            

            
                <section data-title="Comments"><div class="c-article-section" id="article-comments-section"><h2 class="c-article-section__title js-section-title js-c-reading-companion-sections-item" id="article-comments">Comments</h2><div class="c-article-section__content" id="article-comments-content"><p>By submitting a comment you agree to abide by our <a href="/info/tandc.html">Terms</a> and <a href="/info/community-guidelines.html">Community Guidelines</a>. If you find something abusive or that does not comply with our terms or guidelines please flag it as inappropriate.</p></div></div></section>
                <div id="inject-comments">
                    <div class="placeholder" data-replace="true"
                         data-disqus-placeholder="/platform/disqus?doi=10.1038/s41586-021-04301-9 #article-comments-container">
                </div>
            </div>
            

            <span data-recommended="jobs"></span>
</div>
</article>
</main>

<aside class="c-article-extras u-hide-print" aria-label="Article navigation" data-component-reading-companion data-container-type="reading-companion" data-track-component="reading companion">
    
        
            
    
    <div class="c-pdf-download u-clear-both">
        <a href="/articles/s41586-021-04301-9.pdf" class="c-pdf-download__link" data-article-pdf="true" data-readcube-pdf-url="true" data-test="download-pdf" data-draft-ignore="true" data-track="click" data-track-action="download pdf" data-track-label="link" data-track-external>
            <span>Download PDF</span>
            <svg aria-hidden="true" focusable="false" width="16" height="16" class="u-icon"><use xlink:href="#global-icon-download"/></svg>
        </a>
    </div>
    

        
    

    

    
        
    

    
    
        <div class="c-article-associated-content__container">
            <section>
                <h2 class="c-article-associated-content__title u-mb-24">Associated Content</h2>
                
                
                    <div class="u-full-height u-mb-24">
                        
    <article class="u-full-height c-card c-card--flush" itemscope itemtype="http://schema.org/ScholarlyArticle">
        <div class="c-card__layout u-full-height">
            <div class="c-card__body">
                <h3 class="c-card__title" itemprop="name headline">
                    <a href="/articles/s42254-022-00434-6"
                       class="c-card__link u-link-inherit"
                       itemprop="url"
                       data-track="click"
                       data-track-action="view article"
                       
                       data-track-label="link">Machine learning helps control tokamak plasmas</a>
                </h3>
                
<ul data-test="author-list" class="c-author-list c-author-list--compact u-mb-4 u-mt-auto">
    <li itemprop="creator" itemscope="" itemtype="http://schema.org/Person"><span itemprop="name">Iulia Georgescu</span></li>
</ul>

                
    <div class="c-card__section c-meta"><span class="c-meta__item" data-test="article.type">
            <span class="c-meta__type">Research Highlight</span>
        </span>
            <time class="c-meta__item" datetime="2022-02-18" itemprop="datePublished">18 Feb 2022</time>
        
        
    </div>

            </div>
        </div>
    </article>


                    </div>
                
            </section>
        </div>
    


    <div class="c-reading-companion">
        <div class="c-reading-companion__sticky" data-component="reading-companion-sticky" data-test="reading-companion-sticky">
            <div class="c-reading-companion__panel c-reading-companion__sections c-reading-companion__panel--active" id="tabpanel-sections">
                <div class="u-mt-16" data-component-mpu>
                    <div class="c-ad c-ad--300x250">
                        <div class="c-ad__inner">
                            <p class="c-ad__label">Advertisement</p>
                            
    <div id="div-gpt-ad-right-2"
         class="div-gpt-ad advert medium-rectangle js-ad text-center hide-print grade-c-hide"
         data-ad-type="right"
         data-pa11y-ignore
         data-gpt
         data-gpt-unitpath="/285/nature.com/article"
         data-gpt-sizes="300x250"
         data-gpt-targeting="type=article;pos=right;artid=s41586-021-04301-9;doi=10.1038/s41586-021-04301-9;techmeta=119,120,123,129,139,144;subjmeta=1136,117,1960,4077,4091,4093,639,705,766;kwrd=Computer+science,Magnetically+confined+plasmas,Nuclear+fusion+and+fission">
        <noscript>
            <a href="//pubads.g.doubleclick.net/gampad/jump?iu=/285/nature.com/article&amp;sz=300x250&amp;c=1697191084&amp;t=pos%3Dright%26type%3Darticle%26artid%3Ds41586-021-04301-9%26doi%3D10.1038/s41586-021-04301-9%26techmeta%3D119,120,123,129,139,144%26subjmeta%3D1136,117,1960,4077,4091,4093,639,705,766%26kwrd%3DComputer+science,Magnetically+confined+plasmas,Nuclear+fusion+and+fission">
                <img data-test="gpt-advert-fallback-img"
                     src="//pubads.g.doubleclick.net/gampad/ad?iu=/285/nature.com/article&amp;sz=300x250&amp;c=1697191084&amp;t=pos%3Dright%26type%3Darticle%26artid%3Ds41586-021-04301-9%26doi%3D10.1038/s41586-021-04301-9%26techmeta%3D119,120,123,129,139,144%26subjmeta%3D1136,117,1960,4077,4091,4093,639,705,766%26kwrd%3DComputer+science,Magnetically+confined+plasmas,Nuclear+fusion+and+fission"
                     alt="Advertisement"
                     width="300"
                     height="250"></a>
        </noscript>
    </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="c-reading-companion__panel c-reading-companion__figures c-reading-companion__panel--full-width" id="tabpanel-figures"></div>
            <div class="c-reading-companion__panel c-reading-companion__references c-reading-companion__panel--full-width" id="tabpanel-references"></div>
        </div>
    </div>
</aside>
</div>


    
        <nav class="u-hide-print c-header-expander" aria-labelledby="Explore-content" data-test="Explore-content" id="explore" data-track-component="nature-150-split-header">
            <div class="c-header-expander__container">
                <h2 id="Explore-content" class="c-header-expander__heading u-js-hide">Explore content</h2>
                <ul class="c-header-expander__list">
                    
                        
                            <li class="c-header-expander__item">
                                <a class="c-header-expander__link"
                                   href="/nature/research-articles"
                                   data-track="click"
                                   data-track-action="research articles"
                                   data-track-label="link"
                                   data-test="explore-nav-item">
                                    Research articles
                                </a>
                            </li>
                        
                            <li class="c-header-expander__item">
                                <a class="c-header-expander__link"
                                   href="/news"
                                   data-track="click"
                                   data-track-action="news"
                                   data-track-label="link"
                                   data-test="explore-nav-item">
                                    News
                                </a>
                            </li>
                        
                            <li class="c-header-expander__item">
                                <a class="c-header-expander__link"
                                   href="/opinion"
                                   data-track="click"
                                   data-track-action="opinion"
                                   data-track-label="link"
                                   data-test="explore-nav-item">
                                    Opinion
                                </a>
                            </li>
                        
                            <li class="c-header-expander__item">
                                <a class="c-header-expander__link"
                                   href="/research-analysis"
                                   data-track="click"
                                   data-track-action="research analysis"
                                   data-track-label="link"
                                   data-test="explore-nav-item">
                                    Research Analysis
                                </a>
                            </li>
                        
                            <li class="c-header-expander__item">
                                <a class="c-header-expander__link"
                                   href="/careers"
                                   data-track="click"
                                   data-track-action="careers"
                                   data-track-label="link"
                                   data-test="explore-nav-item">
                                    Careers
                                </a>
                            </li>
                        
                            <li class="c-header-expander__item">
                                <a class="c-header-expander__link"
                                   href="/books-culture"
                                   data-track="click"
                                   data-track-action="books &amp; culture"
                                   data-track-label="link"
                                   data-test="explore-nav-item">
                                    Books &amp; Culture
                                </a>
                            </li>
                        
                            <li class="c-header-expander__item">
                                <a class="c-header-expander__link"
                                   href="/nature/podcasts"
                                   data-track="click"
                                   data-track-action="podcasts"
                                   data-track-label="link"
                                   data-test="explore-nav-item">
                                    Podcasts
                                </a>
                            </li>
                        
                            <li class="c-header-expander__item">
                                <a class="c-header-expander__link"
                                   href="/nature/videos"
                                   data-track="click"
                                   data-track-action="videos"
                                   data-track-label="link"
                                   data-test="explore-nav-item">
                                    Videos
                                </a>
                            </li>
                        
                            <li class="c-header-expander__item">
                                <a class="c-header-expander__link"
                                   href="/nature/current-issue"
                                   data-track="click"
                                   data-track-action="current issue"
                                   data-track-label="link"
                                   data-test="explore-nav-item">
                                    Current issue
                                </a>
                            </li>
                        
                            <li class="c-header-expander__item">
                                <a class="c-header-expander__link"
                                   href="/nature/browse-issues"
                                   data-track="click"
                                   data-track-action="browse issues"
                                   data-track-label="link"
                                   data-test="explore-nav-item">
                                    Browse issues
                                </a>
                            </li>
                        
                            <li class="c-header-expander__item">
                                <a class="c-header-expander__link"
                                   href="/nature/collections"
                                   data-track="click"
                                   data-track-action="collections"
                                   data-track-label="link"
                                   data-test="explore-nav-item">
                                    Collections
                                </a>
                            </li>
                        
                            <li class="c-header-expander__item">
                                <a class="c-header-expander__link"
                                   href="/nature/browse-subjects"
                                   data-track="click"
                                   data-track-action="subjects"
                                   data-track-label="link"
                                   data-test="explore-nav-item">
                                    Subjects
                                </a>
                            </li>
                        
                    
                    
                        <li class="c-header-expander__item c-header-expander__item--keyline c-header-expander__item--keyline-first-item-only">
                            <a class="c-header-expander__link"
                               href="https://www.facebook.com/Nature"
                               data-track="click"
                               data-track-action="facebook"
                               data-track-label="link">Follow us on Facebook
                            </a>
                        </li>
                    
                    
                        <li class="c-header-expander__item c-header-expander__item--keyline c-header-expander__item--keyline-first-item-only">
                            <a class="c-header-expander__link"
                               href="https://twitter.com/nature"
                               data-track="click"
                               data-track-action="twitter"
                               data-track-label="link">Follow us on Twitter
                            </a>
                        </li>
                    
                    
                    
                        <li class="c-header-expander__item c-header-expander__item--keyline c-header-expander__item--keyline-first-item-only u-hide-at-lg">
                            <a class="c-header-expander__link"
                               href="https://www.nature.com/my-account/alerts/subscribe-journal?list-id&#x3D;1"
                               rel="nofollow"
                               data-track="click"
                               data-track-action="Sign up for alerts"
                               data-track-external
                               data-track-label="link (mobile dropdown)">Sign up for alerts<svg role="img" aria-hidden="true" focusable="false" height="18" viewBox="0 0 18 18" width="18" xmlns="http://www.w3.org/2000/svg"><path d="m4 10h2.5c.27614237 0 .5.2238576.5.5s-.22385763.5-.5.5h-3.08578644l-1.12132034 1.1213203c-.18753638.1875364-.29289322.4418903-.29289322.7071068v.1715729h14v-.1715729c0-.2652165-.1053568-.5195704-.2928932-.7071068l-1.7071068-1.7071067v-3.4142136c0-2.76142375-2.2385763-5-5-5-2.76142375 0-5 2.23857625-5 5zm3 4c0 1.1045695.8954305 2 2 2s2-.8954305 2-2zm-5 0c-.55228475 0-1-.4477153-1-1v-.1715729c0-.530433.21071368-1.0391408.58578644-1.4142135l1.41421356-1.4142136v-3c0-3.3137085 2.6862915-6 6-6s6 2.6862915 6 6v3l1.4142136 1.4142136c.3750727.3750727.5857864.8837805.5857864 1.4142135v.1715729c0 .5522847-.4477153 1-1 1h-4c0 1.6568542-1.3431458 3-3 3-1.65685425 0-3-1.3431458-3-3z" fill="#fff"/></svg>
                            </a>
                        </li>
                    
                    
                        <li class="c-header-expander__item c-header-expander__item--keyline c-header-expander__item--keyline-first-item-only u-hide-at-lg">
                            <a class="c-header-expander__link"
                               href="http://feeds.nature.com/nature/rss/current"
                               data-track="click"
                               data-track-action="rss feed"
                               data-track-label="link">
                                <span>RSS feed</span>
                            </a>
                        </li>
                    
                </ul>
            </div>
        </nav>
    

    
        <nav class="u-hide-print c-header-expander" aria-labelledby="About-the-journal" id="about-the-journal" data-track-component="nature-150-split-header">
            <div class="c-header-expander__container">
                <h2 id="About-the-journal" class="c-header-expander__heading u-js-hide">About the journal</h2>
                <ul class="c-header-expander__list">
                    
                        <li class="c-header-expander__item">
                            <a class="c-header-expander__link"
                               href="/nature/journal-staff"
                               data-track="click"
                               data-track-action="journal staff"
                               data-track-label="link">
                                Journal Staff
                            </a>
                        </li>
                    
                        <li class="c-header-expander__item">
                            <a class="c-header-expander__link"
                               href="/nature/editors"
                               data-track="click"
                               data-track-action="about the editors"
                               data-track-label="link">
                                About the Editors
                            </a>
                        </li>
                    
                        <li class="c-header-expander__item">
                            <a class="c-header-expander__link"
                               href="/nature/journal-information"
                               data-track="click"
                               data-track-action="journal information"
                               data-track-label="link">
                                Journal Information
                            </a>
                        </li>
                    
                        <li class="c-header-expander__item">
                            <a class="c-header-expander__link"
                               href="/nature/our-publishing-models"
                               data-track="click"
                               data-track-action="our publishing models"
                               data-track-label="link">
                                Our publishing models
                            </a>
                        </li>
                    
                        <li class="c-header-expander__item">
                            <a class="c-header-expander__link"
                               href="/nature/editorial-values-statement"
                               data-track="click"
                               data-track-action="editorial values statement"
                               data-track-label="link">
                                Editorial Values Statement
                            </a>
                        </li>
                    
                        <li class="c-header-expander__item">
                            <a class="c-header-expander__link"
                               href="/nature/journal-impact"
                               data-track="click"
                               data-track-action="journal impact"
                               data-track-label="link">
                                Journal Impact
                            </a>
                        </li>
                    
                        <li class="c-header-expander__item">
                            <a class="c-header-expander__link"
                               href="/nature/awards"
                               data-track="click"
                               data-track-action="awards"
                               data-track-label="link">
                                Awards
                            </a>
                        </li>
                    
                        <li class="c-header-expander__item">
                            <a class="c-header-expander__link"
                               href="/nature/contact"
                               data-track="click"
                               data-track-action="contact"
                               data-track-label="link">
                                Contact
                            </a>
                        </li>
                    
                        <li class="c-header-expander__item">
                            <a class="c-header-expander__link"
                               href="/nature/editorial-policies"
                               data-track="click"
                               data-track-action="editorial policies"
                               data-track-label="link">
                                Editorial policies
                            </a>
                        </li>
                    
                        <li class="c-header-expander__item">
                            <a class="c-header-expander__link"
                               href="/nature/history-of-nature"
                               data-track="click"
                               data-track-action="history of nature"
                               data-track-label="link">
                                History of Nature
                            </a>
                        </li>
                    
                        <li class="c-header-expander__item">
                            <a class="c-header-expander__link"
                               href="/nature/send-a-news-tip"
                               data-track="click"
                               data-track-action="send a news tip"
                               data-track-label="link">
                                Send a news tip
                            </a>
                        </li>
                    
                </ul>
            </div>
        </nav>
    

    
        <nav class="u-hide-print c-header-expander" aria-labelledby="Publish-with-us-label" id="publish-with-us" data-track-component="nature-150-split-header">
            <div class="c-header-expander__container">
                <h2 id="Publish-with-us-label" class="c-header-expander__heading u-js-hide">Publish with us</h2>
                <ul class="c-header-expander__list">
                    
                        <li class="c-header-expander__item">
                            <a class="c-header-expander__link"
                               href="/nature/for-authors"
                               data-track="click"
                               data-track-action="for authors"
                               data-track-label="link">
                                For Authors
                            </a>
                        </li>
                    
                        <li class="c-header-expander__item">
                            <a class="c-header-expander__link"
                               href="/nature/for-referees"
                               data-track="click"
                               data-track-action="for referees"
                               data-track-label="link">
                                For Referees
                            </a>
                        </li>
                    
                    
                        <li class="c-header-expander__item c-header-expander__item--keyline">
                            <a class="c-header-expander__link"
                               href="https://mts-nature.nature.com/"
                               data-track="click"
                               data-track-action="Submit manuscript"
                               data-track-label="link"
                               data-track-external>Submit manuscript<svg role="img" aria-hidden="true" focusable="false" height="18" viewBox="0 0 18 18" width="18" xmlns="http://www.w3.org/2000/svg"><path d="m15 0c1.1045695 0 2 .8954305 2 2v5.5c0 .27614237-.2238576.5-.5.5s-.5-.22385763-.5-.5v-5.5c0-.51283584-.3860402-.93550716-.8833789-.99327227l-.1166211-.00672773h-9v3c0 1.1045695-.8954305 2-2 2h-3v10c0 .5128358.38604019.9355072.88337887.9932723l.11662113.0067277h7.5c.27614237 0 .5.2238576.5.5s-.22385763.5-.5.5h-7.5c-1.1045695 0-2-.8954305-2-2v-10.17157288c0-.53043297.21071368-1.0391408.58578644-1.41421356l3.82842712-3.82842712c.37507276-.37507276.88378059-.58578644 1.41421356-.58578644zm-.5442863 8.18867991 3.3545404 3.35454039c.2508994.2508994.2538696.6596433.0035959.909917-.2429543.2429542-.6561449.2462671-.9065387-.0089489l-2.2609825-2.3045251.0010427 7.2231989c0 .3569916-.2898381.6371378-.6473715.6371378-.3470771 0-.6473715-.2852563-.6473715-.6371378l-.0010428-7.2231995-2.2611222 2.3046654c-.2531661.2580415-.6562868.2592444-.9065605.0089707-.24295423-.2429542-.24865597-.6576651.0036132-.9099343l3.3546673-3.35466731c.2509089-.25090888.6612706-.25227691.9135302-.00001728zm-.9557137-3.18867991c.2761424 0 .5.22385763.5.5s-.2238576.5-.5.5h-6c-.27614237 0-.5-.22385763-.5-.5s.22385763-.5.5-.5zm-8.5-3.587-3.587 3.587h2.587c.55228475 0 1-.44771525 1-1zm8.5 1.587c.2761424 0 .5.22385763.5.5s-.2238576.5-.5.5h-6c-.27614237 0-.5-.22385763-.5-.5s.22385763-.5.5-.5z" fill="#fff"/></svg>
                            </a>
                        </li>
                    
                </ul>
            </div>
        </nav>
    


<div id="search-menu" class="c-header-expander c-header-expander--tray u-hide-print" data-track-component="nature-150-split-header">
    <div class="c-header-expander__container">
        <h2 class="u-visually-hidden">Search</h2>
        <div data-test="inline-search">
            <div class="c-search c-search--max-width u-mb-16">
                <form action="/search"
                      method="get"
                      role="search"
                      autocomplete="off"
                      data-dynamic-track-label
                      data-track="submit" data-track-action="search" data-track-label="form">
                    <label class="c-header-expander__heading u-mb-8" for="keywords">Search articles by subject, keyword or author</label>
                    <div class="c-search__field">
                        <div class="c-search__input-container c-search__input-container--md">
                            <input type="text"
                               required
                               class="c-search__input"
                               id="keywords"
                               name="q"
                               value=""
                               data-test="search-keywords">
                        </div>

                        <div class="c-search__select-container">
                            <label for="results-from" class="u-visually-hidden">Show results from</label>
                            <select id="results-from" name="journal" class="c-search__select">
                                
                                    
                                        <option value="" selected>All journals</option>
                                        <option value="nature">This journal</option>
                                    
                                
                            </select>
                        </div>
                        <div class="c-search__button-container">
                            <button type="submit" class="u-button u-button--primary u-button--full-width" data-test="search-submit">Search</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <div class="c-header-expander__keyline u-mb-16">
            <p class="u-ma-0">
                <a href="/search/advanced"
                   data-track="click" data-track-action="advanced search" data-track-label="link">
                    Advanced search
                </a>
            </p>
        </div>
        <h3 class="c-header-expander__heading">Quick links</h3>
        <ul class="u-list-reset">
            <li class="u-display-inline-block u-mr-24 u-mb-16"><a href="/subjects" data-track="click" data-track-action="explore articles by subject" data-track-label="link">Explore articles by subject</a></li>
            <li class="u-display-inline-block u-mr-24 u-mb-16"><a href="/naturecareers" data-track="click" data-track-action="find a job" data-track-label="link">Find a job</a></li>
            <li class="u-display-inline-block u-mr-24 u-mb-16"><a href="/authors/index.html" data-track="click" data-track-action="guide to authors" data-track-label="link">Guide to authors</a></li>
            <li class="u-display-inline-block u-mr-24 u-mb-16"><a href="/authors/editorial_policies/" data-track="click" data-track-action="editorial policies" data-track-label="link">Editorial policies</a></li>
        </ul>
    </div>
</div>

<footer class="composite-layer" itemscope itemtype="http://schema.org/Periodical">
    <meta itemprop="publisher" content="Springer Nature">
    
    <div class="u-mt-16 u-mb-16">
    <div class="u-container">
        <div class="u-display-flex u-flex-wrap u-justify-content-space-between">
            

            <p class="c-meta u-ma-0 u-flex-shrink">
                <span class="c-meta__item">
                    Nature (<i>Nature</i>)
                </span>
                
    
    <span class="c-meta__item">
        <abbr title="International Standard Serial Number">ISSN</abbr> <span itemprop="onlineIssn">1476-4687</span> (online)
    </span>
    


                
    
    <span class="c-meta__item">
        <abbr title="International Standard Serial Number">ISSN</abbr> <span itemprop="printIssn">0028-0836</span> (print)
    </span>
    

            </p>
        </div>
    </div>
</div>


    <div>
        <div class="c-footer">
            <div class="u-container">
                <div class="u-hide-print" data-track-component="footer">
    <h2 class="u-visually-hidden">nature.com sitemap</h2>
    <div class="c-footer__header">
        <div class="c-footer__logo">
            <img alt="Nature portfolio" src="/static/images/logos/nature-portfolio-white.svg" loading="lazy" width="200" height="31">
        </div>
        <ul class="c-menu c-menu--inherit u-mr-32">
            <li class="c-menu__item"><a class="c-menu__link" href="https://www.nature.com/npg_/company_info/index.html" data-track="click" data-track-action="about us" data-track-label="link">About us</a></li>
            <li class="c-menu__item"><a class="c-menu__link" href="https://www.nature.com/npg_/press_room/press_releases.html" data-track="click" data-track-action="press releases" data-track-label="link">Press releases</a></li>
            <li class="c-menu__item"><a class="c-menu__link" href="https://press.nature.com/" data-track="click" data-track-action="press office" data-track-label="link">Press office</a></li>
            <li class="c-menu__item"><a class="c-menu__link" href="https://support.nature.com/support/home" data-track="click" data-track-action="contact us" data-track-label="link">Contact us</a></li>
        </ul>
        <ul class="c-menu c-menu--inherit">
            <li class="c-menu__item">
                <a class="c-menu__link" href="https://www.facebook.com/nature/" aria-label="Facebook" data-track="click" data-track-action="facebook" data-track-label="link">
                    <svg class="u-icon" role="img" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 20 20"><path d="M2.5 20C1.1 20 0 18.9 0 17.5v-15C0 1.1 1.1 0 2.5 0h15C18.9 0 20 1.1 20 2.5v15c0 1.4-1.1 2.5-2.5 2.5h-3.7v-7.7h2.6l.4-3h-3v-2c0-.9.2-1.5 1.5-1.5h1.6V3.1c-.3 0-1.2-.1-2.3-.1-2.3 0-3.9 1.4-3.9 4v2.2H8.1v3h2.6V20H2.5z"/></svg>
                </a>
            </li>
            <li class="c-menu__item">
                <a class="c-menu__link" href="https://twitter.com/NaturePortfolio?lang=en" aria-label="Twitter" data-track="click" data-track-action="twitter" data-track-label="link">
                    <svg class="u-icon" role="img" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><path d="M17.6 4.1c.8-.5 1.5-1.4 1.8-2.4-.8.5-1.7.9-2.6 1-.7-.8-1.8-1.4-3-1.4-2.3 0-4.1 1.9-4.1 4.3 0 .3 0 .7.1 1-3.4 0-6.4-1.8-8.4-4.4C1 2.9.8 3.6.8 4.4c0 1.5.7 2.8 1.8 3.6C2 8 1.4 7.8.8 7.5v.1c0 2.1 1.4 3.8 3.3 4.2-.3.1-.7.2-1.1.2-.3 0-.5 0-.8-.1.5 1.7 2 3 3.8 3-1.3 1.1-3.1 1.8-5 1.8-.3 0-.7 0-1-.1 1.8 1.2 4 1.9 6.3 1.9C13.8 18.6 18 12 18 6.3v-.6c.8-.6 1.5-1.4 2-2.2-.7.3-1.5.5-2.4.6z"/></svg>
                </a>
            </li>
            <li class="c-menu__item">
                <a class="c-menu__link" href="https://www.youtube.com/channel/UCvCLdSgYdSTpWcOgEJgi-ng" aria-label="YouTube" data-track="click" data-track-action="youtube" data-track-label="link">
                    <svg class="u-icon" role="img" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><path d="M7.9 12.6V6.9l5.4 2.8c0 .1-5.4 2.9-5.4 2.9zM19.8 6s-.2-1.4-.8-2c-.8-.8-1.6-.8-2-.9-2.8-.2-7-.2-7-.2s-4.2 0-7 .2c-.4 0-1.2 0-2 .9-.6.6-.8 2-.8 2S0 7.6 0 9.2v1.5c0 1.7.2 3.3.2 3.3s.2 1.4.8 2c.8.8 1.8.8 2.2.9 1.6.1 6.8.2 6.8.2s4.2 0 7-.2c.4 0 1.2-.1 2-.9.6-.6.8-2 .8-2s.2-1.6.2-3.3V9.2c0-1.6-.2-3.2-.2-3.2z"/></svg>
                </a>
            </li>
        </ul>
    </div>

    <div class="c-footer__grid">
        <div class="c-footer__group">
            <h3 class="c-footer__heading">Discover content</h3>
            <ul class="c-footer__list">
                <li class="c-footer__item"><a href="https://www.nature.com/siteindex" data-track="click" data-track-action="journals a-z" data-track-label="link">Journals A-Z</a></li>
                <li class="c-footer__item"><a href="https://www.nature.com/subjects/" data-track="click" data-track-action="article by subject" data-track-label="link">Articles by subject</a></li>
                <li class="c-footer__item"><a href="https://nano.nature.com/" data-track="click" data-track-action="nano" data-track-label="link">Nano</a></li>
                <li class="c-footer__item"><a href="https://www.nature.com/protocolexchange/" data-track="click" data-track-action="protocol exchange" data-track-label="link">Protocol Exchange</a></li>
                <li class="c-footer__item"><a href="https://www.natureindex.com/" data-track="click" data-track-action="nature index" data-track-label="link">Nature Index</a></li>
            </ul>
        </div>

        <div class="c-footer__group">
            <h3 class="c-footer__heading">Publishing policies</h3>
            <ul class="c-footer__list">
                <li class="c-footer__item"><a href="https://www.nature.com/authors/editorial_policies/" data-track="click" data-track-action="Nature portfolio policies" data-track-label="link">Nature portfolio policies</a></li>
                <li class="c-footer__item"><a href="https://www.nature.com/nature-research/open-access" data-track="click" data-track-action="open access" data-track-label="link">Open access</a></li>
            </ul>
        </div>

        <div class="c-footer__group">
            <h3 class="c-footer__heading">Author &amp; Researcher services</h3>
            <ul class="c-footer__list">
                <li class="c-footer__item"><a href="https://www.nature.com/reprints/" data-track="click" data-track-action="reprints and permissions" data-track-label="link">Reprints &amp; permissions</a></li>
                <li class="c-footer__item"><a href="https://www.springernature.com/gp/authors/research-data" data-track="click" data-track-action="data research service" data-track-label="link">Research data</a></li>
                <li class="c-footer__item"><a href="https://authorservices.springernature.com/go/nr" data-track="click" data-track-action="language editing" data-track-label="link">Language editing</a></li>
                <li class="c-footer__item"><a href="https://authorservices.springernature.com/scientific-editing/" data-track="click" data-track-action="scientific editing" data-track-label="link">Scientific editing</a></li>
                <li class="c-footer__item"><a href="https://masterclasses.nature.com/" data-track="click" data-track-action="nature masterclasses" data-track-label="link">Nature Masterclasses</a></li>
                <li class="c-footer__item"><a href="https://partnerships.nature.com/product/researcher-training/" data-track="click" data-track-action="nature research academies" data-track-label="link">Nature Research Academies</a></li>
            </ul>
        </div>

        <div class="c-footer__group">
            <h3 class="c-footer__heading">Libraries &amp; institutions</h3>
            <ul class="c-footer__list">
                <li class="c-footer__item"><a href="https://www.springernature.com/gp/librarians/tools-services" data-track="click" data-track-action="librarian service and tools" data-track-label="link">Librarian service &amp; tools</a></li>
                <li class="c-footer__item"><a href="https://www.springernature.com/gp/librarians/manage-your-account/librarianportal" data-track="click" data-track-action="librarian portal" data-track-label="link">Librarian portal</a></li>
                <li class="c-footer__item"><a href="https://www.nature.com/openresearch/about-open-access/information-for-institutions/" data-track="click" data-track-action="open research" data-track-label="link">Open research</a></li>
                <li class="c-footer__item"><a href="https://www.springernature.com/gp/librarians/recommend-to-your-library" data-track="click" data-track-action="Recommend to library" data-track-label="link">Recommend to library</a></li>
            </ul>
        </div>

        <div class="c-footer__group">
            <h3 class="c-footer__heading">Advertising &amp; partnerships</h3>
            <ul class="c-footer__list">
                <li class="c-footer__item"><a href="https://partnerships.nature.com/product/digital-advertising/" data-track="click" data-track-action="advertising" data-track-label="link">Advertising</a></li>
                <li class="c-footer__item"><a href="https://partnerships.nature.com/" data-track="click" data-track-action="partnerships and services" data-track-label="link">Partnerships &amp; Services</a></li>
                <li class="c-footer__item"><a href="https://partnerships.nature.com/media-kits/" data-track="click" data-track-action="media kits" data-track-label="link">Media kits</a></li>
                <li class="c-footer__item"><a href="https://partnerships.nature.com/product/branded-content-native-advertising/" data-track-action="branded content" data-track-label="link">Branded content</a></li>
            </ul>
        </div>

        <div class="c-footer__group">
            <h3 class="c-footer__heading">Career development</h3>
            <ul class="c-footer__list">
                <li class="c-footer__item"><a href="https://www.nature.com/naturecareers" data-track="click" data-track-action="nature careers" data-track-label="link">Nature Careers</a></li>
                <li class="c-footer__item"><a href="https://conferences.nature.com" data-track="click" data-track-action="nature conferences" data-track-label="link">Nature<span class="u-visually-hidden"> </span> Conferences</a></li>
                <li class="c-footer__item"><a href="https://www.nature.com/natureevents/" data-track="click" data-track-action="nature events" data-track-label="link">Nature<span class="u-visually-hidden"> </span> events</a></li>
            </ul>
        </div>

        <div class="c-footer__group">
            <h3 class="c-footer__heading">Regional websites</h3>
            <ul class="c-footer__list">
                <li class="c-footer__item"><a href="https://www.nature.com/natafrica" data-track="click" data-track-action="nature africa" data-track-label="link">Nature Africa</a></li>
                <li class="c-footer__item"><a href="http://www.naturechina.com" data-track="click" data-track-action="nature china" data-track-label="link">Nature China</a></li>
                <li class="c-footer__item"><a href="https://www.nature.com/nindia" data-track="click" data-track-action="nature india" data-track-label="link">Nature India</a></li>
                <li class="c-footer__item"><a href="https://www.nature.com/natitaly" data-track="click" data-track-action="nature Italy" data-track-label="link">Nature Italy</a></li>
                <li class="c-footer__item"><a href="https://www.natureasia.com/ja-jp/" data-track="click" data-track-action="nature japan" data-track-label="link">Nature Japan</a></li>
                <li class="c-footer__item"><a href="https://www.natureasia.com/ko-kr/" data-track="click" data-track-action="nature korea" data-track-label="link">Nature Korea</a></li>
                <li class="c-footer__item"><a href="https://www.nature.com/nmiddleeast/" data-track="click" data-track-action="nature middle east" data-track-label="link">Nature Middle East</a></li>
            </ul>
        </div>

        <div class="c-footer__group">
            <h3 class="c-footer__heading">Legal &amp; Privacy</h3>
            <ul class="c-footer__list">
                <li class="c-footer__item"><a href="https://www.nature.com/info/privacy" data-track="click" data-track-action="privacy policy" data-track-label="link">Privacy Policy</a></li>
                <li class="c-footer__item"><a href="https://www.nature.com/info/cookies" data-track="click" data-track-action="use of cookies" data-track-label="link">Use of cookies</a></li>
                <li class="c-footer__item"><a class="optanon-toggle-display" href="javascript:;" data-cc-action="preferences" data-track="click" data-track-action="manage cookies" data-track-label="link">Manage cookies/Do not sell my data</a></li>
                <li class="c-footer__item"><a href="https://www.nature.com/info/legal-notice" data-track="click" data-track-action="legal notice" data-track-label="link">Legal notice</a></li>
                <li class="c-footer__item"><a href="https://www.nature.com/info/accessibility-statement" data-track="click" data-track-action="accessibility statement" data-track-label="link">Accessibility statement</a></li>
                <li class="c-footer__item"><a href="https://www.nature.com/info/terms-and-conditions" data-track="click" data-track-action="terms and conditions" data-track-label="link">Terms &amp; Conditions</a></li>
                <li class="c-footer__item"><a href="https://www.springernature.com/ccpa" data-track="click" data-track-action="california privacy statement" data-track-label="link">California Privacy Statement</a></li>
            </ul>
        </div>
    </div>
</div>


            </div>
        </div>
    </div>

    <div class="c-corporate-footer">
    <div class="u-container">
        <img src="/static/images/logos/sn-logo-white.svg" alt="Springer Nature" loading="lazy" width="140" height="14"/>
        <p class="c-corporate-footer__legal" data-test="copyright">&copy; 2022 Springer Nature Limited</p>
    </div>
</div>

    
    <svg class="u-hide hide">
        <symbol id="global-icon-chevron-right" viewBox="0 0 16 16">
            <path d="M7.782 7L5.3 4.518c-.393-.392-.4-1.022-.02-1.403a1.001 1.001 0 011.417 0l4.176 4.177a1.001 1.001 0 010 1.416l-4.176 4.177a.991.991 0 01-1.4.016 1 1 0 01.003-1.42L7.782 9l1.013-.998z" fill-rule="evenodd"/>
        </symbol>
        <symbol id="global-icon-download" viewBox="0 0 16 16">
            <path d="M2 14c0-.556.449-1 1.002-1h9.996a.999.999 0 110 2H3.002A1.006 1.006 0 012 14zM9 2v6.8l2.482-2.482c.392-.392 1.022-.4 1.403-.02a1.001 1.001 0 010 1.417l-4.177 4.177a1.001 1.001 0 01-1.416 0L3.115 7.715a.991.991 0 01-.016-1.4 1 1 0 011.42.003L7 8.8V2c0-.55.444-.996 1-.996.552 0 1 .445 1 .996z" fill-rule="evenodd"/>
        </symbol>
        <symbol id="global-icon-email" viewBox="0 0 18 18">
            <path d="M1.995 2h14.01A2 2 0 0118 4.006v9.988A2 2 0 0116.005 16H1.995A2 2 0 010 13.994V4.006A2 2 0 011.995 2zM1 13.994A1 1 0 001.995 15h14.01A1 1 0 0017 13.994V4.006A1 1 0 0016.005 3H1.995A1 1 0 001 4.006zM9 11L2 7V5.557l7 4 7-4V7z" fill-rule="evenodd"/>
        </symbol>
        <symbol id="global-icon-institution" viewBox="0 0 18 18">
            <path d="M14 8a1 1 0 011 1v6h1.5a.5.5 0 01.5.5v.5h.5a.5.5 0 01.5.5V18H0v-1.5a.5.5 0 01.5-.5H1v-.5a.5.5 0 01.5-.5H3V9a1 1 0 112 0v6h8V9a1 1 0 011-1zM6 8l2 1v4l-2 1zm6 0v6l-2-1V9zM9.573.401l7.036 4.925A.92.92 0 0116.081 7H1.92a.92.92 0 01-.528-1.674L8.427.401a1 1 0 011.146 0zM9 2.441L5.345 5h7.31z" fill-rule="evenodd"/>
        </symbol>
        <symbol id="global-icon-search" viewBox="0 0 22 22">
            <path fill-rule="evenodd" d="M21.697 20.261a1.028 1.028 0 01.01 1.448 1.034 1.034 0 01-1.448-.01l-4.267-4.267A9.812 9.811 0 010 9.812a9.812 9.811 0 1117.43 6.182zM9.812 18.222A8.41 8.41 0 109.81 1.403a8.41 8.41 0 000 16.82z"/>
        </symbol>
        <symbol id="icon-info" viewBox="0 0 18 18">
            <path d="m9 0c4.9705627 0 9 4.02943725 9 9 0 4.9705627-4.0294373 9-9 9-4.97056275 0-9-4.0294373-9-9 0-4.97056275 4.02943725-9 9-9zm0 7h-1.5l-.11662113.00672773c-.49733868.05776511-.88337887.48043643-.88337887.99327227 0 .47338693.32893365.86994729.77070917.97358929l.1126697.01968298.11662113.00672773h.5v3h-.5l-.11662113.0067277c-.42082504.0488782-.76196299.3590206-.85696816.7639815l-.01968298.1126697-.00672773.1166211.00672773.1166211c.04887817.4208251.35902055.761963.76398144.8569682l.1126697.019683.11662113.0067277h3l.1166211-.0067277c.4973387-.0577651.8833789-.4804365.8833789-.9932723 0-.4733869-.3289337-.8699473-.7707092-.9735893l-.1126697-.019683-.1166211-.0067277h-.5v-4l-.00672773-.11662113c-.04887817-.42082504-.35902055-.76196299-.76398144-.85696816l-.1126697-.01968298zm0-3.25c-.69035594 0-1.25.55964406-1.25 1.25s.55964406 1.25 1.25 1.25 1.25-.55964406 1.25-1.25-.55964406-1.25-1.25-1.25z" fill-rule="evenodd"/>
        </symbol>
        <symbol id="icon-success" viewBox="0 0 18 18">
            <path d="M9 0a9 9 0 110 18A9 9 0 019 0zm3.486 4.982l-4.718 5.506L5.14 8.465a.991.991 0 00-1.423.133 1.06 1.06 0 00.13 1.463l3.407 2.733a1 1 0 001.387-.133l5.385-6.334a1.06 1.06 0 00-.116-1.464.991.991 0 00-1.424.119z" fill-rule="evenodd"/>
        </symbol>
        <symbol id="icon-chevron-down" viewBox="0 0 16 16">
            <path d="m5.58578644 3-3.29289322-3.29289322c-.39052429-.39052429-.39052429-1.02368927 0-1.41421356s1.02368927-.39052429 1.41421356 0l4 4c.39052429.39052429.39052429 1.02368927 0 1.41421356l-4 4c-.39052429.39052429-1.02368927.39052429-1.41421356 0s-.39052429-1.02368927 0-1.41421356z" fill-rule="evenodd" transform="matrix(0 1 -1 0 11 1)"/>
        </symbol>
        <symbol id="icon-warning" viewBox="0 0 18 18">
            <path d="m9 11.75c.69035594 0 1.25.5596441 1.25 1.25s-.55964406 1.25-1.25 1.25-1.25-.5596441-1.25-1.25.55964406-1.25 1.25-1.25zm.41320045-7.75c.55228475 0 1.00000005.44771525 1.00000005 1l-.0034543.08304548-.3333333 4c-.043191.51829212-.47645714.91695452-.99654578.91695452h-.15973424c-.52008864 0-.95335475-.3986624-.99654576-.91695452l-.33333333-4c-.04586475-.55037702.36312325-1.03372649.91350028-1.07959124l.04148683-.00259031zm-.41320045 14c-4.97056275 0-9-4.0294373-9-9 0-4.97056275 4.02943725-9 9-9 4.9705627 0 9 4.02943725 9 9 0 4.9705627-4.0294373 9-9 9z" fill-rule="evenodd"/>
        </symbol>
        <symbol id="icon-plus" viewBox="0 0 16 16">
            <path d="m2.00087166 7h4.99912834v-4.99912834c0-.55276616.44386482-1.00087166 1-1.00087166.55228475 0 1 .44463086 1 1.00087166v4.99912834h4.9991283c.5527662 0 1.0008717.44386482 1.0008717 1 0 .55228475-.4446309 1-1.0008717 1h-4.9991283v4.9991283c0 .5527662-.44386482 1.0008717-1 1.0008717-.55228475 0-1-.4446309-1-1.0008717v-4.9991283h-4.99912834c-.55276616 0-1.00087166-.44386482-1.00087166-1 0-.55228475.44463086-1 1.00087166-1z" fill-rule="evenodd"/>
        </symbol>
        <symbol id="icon-minus" viewBox="0 0 16 16">
            <path d="m2.00087166 7h11.99825664c.5527662 0 1.0008717.44386482 1.0008717 1 0 .55228475-.4446309 1-1.0008717 1h-11.99825664c-.55276616 0-1.00087166-.44386482-1.00087166-1 0-.55228475.44463086-1 1.00087166-1z" fill-rule="evenodd"/>
        </symbol>
        <symbol id="icon-error" viewBox="0 0 18 18">
            <path d="m9 0c4.9705627 0 9 4.02943725 9 9 0 4.9705627-4.0294373 9-9 9-4.97056275 0-9-4.0294373-9-9 0-4.97056275 4.02943725-9 9-9zm2.8630343 4.71100931-2.8630343 2.86303426-2.86303426-2.86303426c-.39658757-.39658757-1.03281091-.39438847-1.4265779-.00062147-.39651227.39651226-.39348876 1.03246767.00062147 1.4265779l2.86303426 2.86303426-2.86303426 2.8630343c-.39658757.3965875-.39438847 1.0328109-.00062147 1.4265779.39651226.3965122 1.03246767.3934887 1.4265779-.0006215l2.86303426-2.8630343 2.8630343 2.8630343c.3965875.3965876 1.0328109.3943885 1.4265779.0006215.3965122-.3965123.3934887-1.0324677-.0006215-1.4265779l-2.8630343-2.8630343 2.8630343-2.86303426c.3965876-.39658757.3943885-1.03281091.0006215-1.4265779-.3965123-.39651227-1.0324677-.39348876-1.4265779.00062147z" fill="currentColor" fill-rule="evenodd"/>
        </symbol>
    </svg>

</footer>




    
        

<div class="c-site-messages message hide u-hide-print c-site-messages--nature-briefing c-site-messages--nature-briefing-email-variant c-site-messages--nature-briefing-redesign-2020 sans-serif"
data-component-id="nature-briefing-banner"
data-component-expirydays="30"
data-component-trigger-scroll-percentage="15"
data-track="in-view"
data-track-action="in-view"
data-track-category="nature briefing"
data-track-label="redesign banner visible">

    
    <div class="c-site-messages__banner-large">

        
<div class="c-site-messages__close-container">
    <button class="c-site-messages__close"
        data-track="click"
        data-track-category="nature briefing"
        data-track-label="redesign banner dismiss">
        <svg width="25px" height="25px" focusable="false" aria-hidden="true" viewBox="0 0 25 25" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <title>Close banner</title>
            <defs></defs>
            <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <rect opacity="0" x="0" y="0" width="25" height="25"></rect>
                <path d="M6.29679575,16.2772478 C5.90020818,16.6738354 5.90240728,17.3100587 6.29617427,17.7038257 C6.69268654,18.100338 7.32864195,18.0973145 7.72275218,17.7032043 L12,13.4259564 L16.2772478,17.7032043 C16.6738354,18.0997918 17.3100587,18.0975927 17.7038257,17.7038257 C18.100338,17.3073135 18.0973145,16.671358 17.7032043,16.2772478 L13.4259564,12 L17.7032043,7.72275218 C18.0997918,7.32616461 18.0975927,6.68994127 17.7038257,6.29617427 C17.3073135,5.89966201 16.671358,5.90268552 16.2772478,6.29679575 L12,10.5740436 L7.72275218,6.29679575 C7.32616461,5.90020818 6.68994127,5.90240728 6.29617427,6.29617427 C5.89966201,6.69268654 5.90268552,7.32864195 6.29679575,7.72275218 L10.5740436,12 L6.29679575,16.2772478 Z" fill="#ffffff"></path>
            </g>
        </svg>
        <span class="visually-hidden">Close</span>
    </button>
</div>


        <div class="c-site-messages__form-container">

            <div class="grid grid-12 last">
                <div class="grid grid-4">
                    <img alt="Nature Briefing" src="/static/images/logos/nature-briefing-logo-n150-white.svg" width="250" height="40">
                    <p class="c-site-messages--nature-briefing__strapline extra-tight-line-height">Sign up for the <em>Nature Briefing</em> newsletter — what matters in science, free to your inbox daily.</p>
                </div>
                <div class="grid grid-8 last">
                    <form action="/briefing/signup/formfeedback" method="post" data-location="banner" data-track="submit" data-track-action="transmit-form">
                        <input id="briefing-banner-signup-form-input-track-originReferralPoint" type="hidden" name="track_originReferralPoint" value="DirectEmailBannerRedesign2020">
                        <input id="briefing-banner-signup-form-input-track-formType" type="hidden" name="track_formType" value="DirectEmailBanner">
                        <label class="nature-briefing-banner__email-label" for="banner-EmailAddressInput">Email address</label>

                        <div class="nature-briefing-banner__email-wrapper">
                            <input class="nature-briefing-banner__email-input box-sizing text14" type="email" id="banner-EmailAddressInput" name="email" value="" placeholder="e.g. jo.smith@university.ac.uk" required data-test-element="briefing-emailbanner-email-input">
                            <button type="submit" class="nature-briefing-banner__submit-button box-sizing text14" data-test-element="briefing-emailbanner-signup-button">Sign up</button>
                        </div>

                        <div class="nature-briefing-banner__checkbox-wrapper grid grid-12 last">
                            <input class="nature-briefing-banner__checkbox-checkbox" id="gdpr-briefing-banner-checkbox" type="checkbox" name="gdpr" value="1" data-test-element="briefing-emailbanner-gdpr-checkbox" required>
                            <label class="nature-briefing-banner__checkbox-label box-sizing text13 sans-serif block tighten-line-height" for="gdpr-briefing-banner-checkbox">I agree my information will be processed in accordance with the <em>Nature</em> and Springer Nature Limited <a href="https://www.nature.com/info/privacy">Privacy Policy</a>.</label>
                        </div>
                    </form>
                </div>
            </div>

        </div>

    </div>

    
    <div class="c-site-messages__banner-small">

        
<div class="c-site-messages__close-container">
    <button class="c-site-messages__close"
        data-track="click"
        data-track-category="nature briefing"
        data-track-label="redesign banner dismiss">
        <svg width="25px" height="25px" focusable="false" aria-hidden="true" viewBox="0 0 25 25" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <title>Close banner</title>
            <defs></defs>
            <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <rect opacity="0" x="0" y="0" width="25" height="25"></rect>
                <path d="M6.29679575,16.2772478 C5.90020818,16.6738354 5.90240728,17.3100587 6.29617427,17.7038257 C6.69268654,18.100338 7.32864195,18.0973145 7.72275218,17.7032043 L12,13.4259564 L16.2772478,17.7032043 C16.6738354,18.0997918 17.3100587,18.0975927 17.7038257,17.7038257 C18.100338,17.3073135 18.0973145,16.671358 17.7032043,16.2772478 L13.4259564,12 L17.7032043,7.72275218 C18.0997918,7.32616461 18.0975927,6.68994127 17.7038257,6.29617427 C17.3073135,5.89966201 16.671358,5.90268552 16.2772478,6.29679575 L12,10.5740436 L7.72275218,6.29679575 C7.32616461,5.90020818 6.68994127,5.90240728 6.29617427,6.29617427 C5.89966201,6.69268654 5.90268552,7.32864195 6.29679575,7.72275218 L10.5740436,12 L6.29679575,16.2772478 Z" fill="#ffffff"></path>
            </g>
        </svg>
        <span class="visually-hidden">Close</span>
    </button>
</div>


        <div class="c-site-messages__content text14">
            <span class="c-site-messages--nature-briefing__strapline strong">Get the most important science stories of the day, free in your inbox.</span>
            <a class="nature-briefing__link text14 sans-serif"
                data-track="click"
                data-track-category="nature briefing"
                data-track-label="redesign banner CTA to site"
                data-test-element="briefing-banner-link"
                target="_blank"
                rel="noreferrer noopener"
                href="/briefing/signup/?origin=Nature&amp;originReferralPoint=EmailBanner">Sign up for Nature Briefing
            </a>
        </div>

    </div>

</div>
    



    

    <noscript>
        <img hidden src="https://verify.nature.com/verify/nature.png" width="0" height="0" style="display: none" alt="">
    </noscript>

    



<script src="//content.readcube.com/ping?doi=10.1038/s41586-021-04301-9&amp;format=js&amp;last_modified=2022-02-16" async></script>
<img src="/platform/track/article/s41586-021-04301-9" width="1" height="1" alt="" class="u-visually-hidden">
</body>
</html>
